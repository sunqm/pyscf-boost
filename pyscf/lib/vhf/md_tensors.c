#include <stdlib.h>
#include <math.h>
#include "simd.h"
#include "vhf.h"

void eval_boys(double *Rt, int l, double a, double fac, double *rpq);

#define LSUM_MAX        (LMAX*4)
#define RTIDX_MAX       12

static int Rt_idx[] = {
// l = 1
0,0,0,
// l = 2
0,0,0,0,0,0,0,0,0,
// l = 3
0,0,1,0,0,0,0,1,3,0,0,0,0,0,0,0,1,3,6,
// l = 4
0,0,1,2,0,0,0,0,0,1,2,4,5,7,0,0,0,0,0,0,
0,0,0,0,0,1,2,4,5,7,10,11,13,16,
// l = 5
0,0,1,2,3,0,0,0,0,0,0,1,2,3,5,6,7,9,10,12,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,5,
6,7,9,10,12,15,16,17,19,20,22,25,26,28,31,
// l = 6
0,0,1,2,3,4,0,0,0,0,0,0,0,1,2,3,4,6,7,8,
9,11,12,13,15,16,18,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,2,3,4,6,7,8,9,11,12,13,
15,16,18,21,22,23,24,26,27,28,30,31,33,36,37,38,40,41,43,46,
47,49,52,
// l = 7
0,0,1,2,3,4,5,0,0,0,0,0,0,0,0,1,2,3,4,5,
7,8,9,10,11,13,14,15,16,18,19,20,22,23,25,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,2,3,4,5,7,8,9,10,11,13,14,15,16,18,19,
20,22,23,25,28,29,30,31,32,34,35,36,37,39,40,41,43,44,46,49,
50,51,52,54,55,56,58,59,61,64,65,66,68,69,71,74,75,77,80,
// l = 8
0,0,1,2,3,4,5,6,0,0,0,0,0,0,0,0,0,1,2,3,
4,5,6,8,9,10,11,12,13,15,16,17,18,19,21,22,23,24,26,27,
28,30,31,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,1,2,3,4,5,6,8,9,10,11,12,13,15,16,17,18,19,21,22,
23,24,26,27,28,30,31,33,36,37,38,39,40,41,43,44,45,46,47,49,
50,51,52,54,55,56,58,59,61,64,65,66,67,68,70,71,72,73,75,76,
77,79,80,82,85,86,87,88,90,91,92,94,95,97,100,101,102,104,105,107,
110,111,113,116,
// l = 9
0,0,1,2,3,4,5,6,7,0,0,0,0,0,0,0,0,0,0,1,
2,3,4,5,6,7,9,10,11,12,13,14,15,17,18,19,20,21,22,24,
25,26,27,28,30,31,32,33,35,36,37,39,40,42,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
1,2,3,4,5,6,7,9,10,11,12,13,14,15,17,18,19,20,21,22,
24,25,26,27,28,30,31,32,33,35,36,37,39,40,42,45,46,47,48,49,
50,51,53,54,55,56,57,58,60,61,62,63,64,66,67,68,69,71,72,73,
75,76,78,81,82,83,84,85,86,88,89,90,91,92,94,95,96,97,99,100,
101,103,104,106,109,110,111,112,113,115,116,117,118,120,121,122,124,125,127,130,
131,132,133,135,136,137,139,140,142,145,146,147,149,150,152,155,156,158,161,
// l = 10
0,0,1,2,3,4,5,6,7,8,0,0,0,0,0,0,0,0,0,0,
0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,19,20,21,
22,23,24,25,27,28,29,30,31,32,34,35,36,37,38,40,41,42,43,45,
46,47,49,50,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,19,20,21,
22,23,24,25,27,28,29,30,31,32,34,35,36,37,38,40,41,42,43,45,
46,47,49,50,52,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,
72,73,74,75,76,77,79,80,81,82,83,85,86,87,88,90,91,92,94,95,
97,100,101,102,103,104,105,106,108,109,110,111,112,113,115,116,117,118,119,121,
122,123,124,126,127,128,130,131,133,136,137,138,139,140,141,143,144,145,146,147,
149,150,151,152,154,155,156,158,159,161,164,165,166,167,168,170,171,172,173,175,
176,177,179,180,182,185,186,187,188,190,191,192,194,195,197,200,201,202,204,205,
207,210,211,213,216,
// l = 11
0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,0,0,
0,0,0,1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,18,
19,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,38,39,40,41,
42,43,45,46,47,48,49,51,52,53,54,56,57,58,60,61,63,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,17,
18,19,21,22,23,24,25,26,27,28,30,31,32,33,34,35,36,38,39,40,
41,42,43,45,46,47,48,49,51,52,53,54,56,57,58,60,61,63,66,67,
68,69,70,71,72,73,74,76,77,78,79,80,81,82,83,85,86,87,88,89,
90,91,93,94,95,96,97,98,100,101,102,103,104,106,107,108,109,111,112,113,
115,116,118,121,122,123,124,125,126,127,128,130,131,132,133,134,135,136,138,139,
140,141,142,143,145,146,147,148,149,151,152,153,154,156,157,158,160,161,163,166,
167,168,169,170,171,172,174,175,176,177,178,179,181,182,183,184,185,187,188,189,
190,192,193,194,196,197,199,202,203,204,205,206,207,209,210,211,212,213,215,216,
217,218,220,221,222,224,225,227,230,231,232,233,234,236,237,238,239,241,242,243,
245,246,248,251,252,253,254,256,257,258,260,261,263,266,267,268,270,271,273,276,
277,279,282,
// l = 12
0,0,1,2,3,4,5,6,7,8,9,10,0,0,0,0,0,0,0,0,
0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,12,13,14,15,16,
17,18,19,20,21,23,24,25,26,27,28,29,30,31,33,34,35,36,37,38,
39,40,42,43,44,45,46,47,48,50,51,52,53,54,55,57,58,59,60,61,
63,64,65,66,68,69,70,72,73,75,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,12,
13,14,15,16,17,18,19,20,21,23,24,25,26,27,28,29,30,31,33,34,
35,36,37,38,39,40,42,43,44,45,46,47,48,50,51,52,53,54,55,57,
58,59,60,61,63,64,65,66,68,69,70,72,73,75,78,79,80,81,82,83,
84,85,86,87,89,90,91,92,93,94,95,96,97,99,100,101,102,103,104,105,
106,108,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,129,
130,131,132,134,135,136,138,139,141,144,145,146,147,148,149,150,151,152,154,155,
156,157,158,159,160,161,163,164,165,166,167,168,169,171,172,173,174,175,176,178,
179,180,181,182,184,185,186,187,189,190,191,193,194,196,199,200,201,202,203,204,
205,206,208,209,210,211,212,213,214,216,217,218,219,220,221,223,224,225,226,227,
229,230,231,232,234,235,236,238,239,241,244,245,246,247,248,249,250,252,253,254,
255,256,257,259,260,261,262,263,265,266,267,268,270,271,272,274,275,277,280,281,
282,283,284,285,287,288,289,290,291,293,294,295,296,298,299,300,302,303,305,308,
309,310,311,312,314,315,316,317,319,320,321,323,324,326,329,330,331,332,334,335,
336,338,339,341,344,345,346,348,349,351,354,355,357,360,
};

// l*(l+1)*(l+2)*(l+3)//24 - l
static int Rt_idx_offsets[] = {
0,0,3,12,31,65,120,203,322,486,705,990,1353,1807
};

static void iter_Rt_1(double *out, double *Rt, double rx, double ry, double rz)
{
        out[1] = rz * Rt[0];
        out[2] = ry * Rt[0];
        out[3] = rx * Rt[0];
}

static void iter_Rt_2(double *out, double *Rt, double rx, double ry, double rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = ry * Rt[0];
        out[4] = ry * Rt[1];
        out[5] = ry * Rt[2] + Rt[0];
        out[6] = rx * Rt[0];
        out[7] = rx * Rt[1];
        out[8] = rx * Rt[2];
        out[9] = rx * Rt[3] + Rt[0];
}

static void iter_Rt_3(double *out, double *Rt, double rx, double ry, double rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = ry * Rt[0];
        out[5] = ry * Rt[1];
        out[6] = ry * Rt[2];
        out[7] = ry * Rt[3] + Rt[0];
        out[8] = ry * Rt[4] + Rt[1];
        out[9] = ry * Rt[5] + 2 * Rt[3];
        out[10] = rx * Rt[0];
        out[11] = rx * Rt[1];
        out[12] = rx * Rt[2];
        out[13] = rx * Rt[3];
        out[14] = rx * Rt[4];
        out[15] = rx * Rt[5];
        out[16] = rx * Rt[6] + Rt[0];
        out[17] = rx * Rt[7] + Rt[1];
        out[18] = rx * Rt[8] + Rt[3];
        out[19] = rx * Rt[9] + 2 * Rt[6];
}

static void iter_Rt_4(double *out, double *Rt, double rx, double ry, double rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = rz * Rt[3] + 3 * Rt[2];
        out[5] = ry * Rt[0];
        out[6] = ry * Rt[1];
        out[7] = ry * Rt[2];
        out[8] = ry * Rt[3];
        out[9] = ry * Rt[4] + Rt[0];
        out[10] = ry * Rt[5] + Rt[1];
        out[11] = ry * Rt[6] + Rt[2];
        out[12] = ry * Rt[7] + 2 * Rt[4];
        out[13] = ry * Rt[8] + 2 * Rt[5];
        out[14] = ry * Rt[9] + 3 * Rt[7];
        out[15] = rx * Rt[0];
        out[16] = rx * Rt[1];
        out[17] = rx * Rt[2];
        out[18] = rx * Rt[3];
        out[19] = rx * Rt[4];
        out[20] = rx * Rt[5];
        out[21] = rx * Rt[6];
        out[22] = rx * Rt[7];
        out[23] = rx * Rt[8];
        out[24] = rx * Rt[9];
        out[25] = rx * Rt[10] + Rt[0];
        out[26] = rx * Rt[11] + Rt[1];
        out[27] = rx * Rt[12] + Rt[2];
        out[28] = rx * Rt[13] + Rt[4];
        out[29] = rx * Rt[14] + Rt[5];
        out[30] = rx * Rt[15] + Rt[7];
        out[31] = rx * Rt[16] + 2 * Rt[10];
        out[32] = rx * Rt[17] + 2 * Rt[11];
        out[33] = rx * Rt[18] + 2 * Rt[13];
        out[34] = rx * Rt[19] + 3 * Rt[16];
}

static void iter_Rt_5(double *out, double *Rt, double rx, double ry, double rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = rz * Rt[3] + 3 * Rt[2];
        out[5] = rz * Rt[4] + 4 * Rt[3];
        out[6] = ry * Rt[0];
        out[7] = ry * Rt[1];
        out[8] = ry * Rt[2];
        out[9] = ry * Rt[3];
        out[10] = ry * Rt[4];
        out[11] = ry * Rt[5] + Rt[0];
        out[12] = ry * Rt[6] + Rt[1];
        out[13] = ry * Rt[7] + Rt[2];
        out[14] = ry * Rt[8] + Rt[3];
        out[15] = ry * Rt[9] + 2 * Rt[5];
        out[16] = ry * Rt[10] + 2 * Rt[6];
        out[17] = ry * Rt[11] + 2 * Rt[7];
        out[18] = ry * Rt[12] + 3 * Rt[9];
        out[19] = ry * Rt[13] + 3 * Rt[10];
        out[20] = ry * Rt[14] + 4 * Rt[12];
        out[21] = rx * Rt[0];
        out[22] = rx * Rt[1];
        out[23] = rx * Rt[2];
        out[24] = rx * Rt[3];
        out[25] = rx * Rt[4];
        out[26] = rx * Rt[5];
        out[27] = rx * Rt[6];
        out[28] = rx * Rt[7];
        out[29] = rx * Rt[8];
        out[30] = rx * Rt[9];
        out[31] = rx * Rt[10];
        out[32] = rx * Rt[11];
        out[33] = rx * Rt[12];
        out[34] = rx * Rt[13];
        out[35] = rx * Rt[14];
        out[36] = rx * Rt[15] + Rt[0];
        out[37] = rx * Rt[16] + Rt[1];
        out[38] = rx * Rt[17] + Rt[2];
        out[39] = rx * Rt[18] + Rt[3];
        out[40] = rx * Rt[19] + Rt[5];
        out[41] = rx * Rt[20] + Rt[6];
        out[42] = rx * Rt[21] + Rt[7];
        out[43] = rx * Rt[22] + Rt[9];
        out[44] = rx * Rt[23] + Rt[10];
        out[45] = rx * Rt[24] + Rt[12];
        out[46] = rx * Rt[25] + 2 * Rt[15];
        out[47] = rx * Rt[26] + 2 * Rt[16];
        out[48] = rx * Rt[27] + 2 * Rt[17];
        out[49] = rx * Rt[28] + 2 * Rt[19];
        out[50] = rx * Rt[29] + 2 * Rt[20];
        out[51] = rx * Rt[30] + 2 * Rt[22];
        out[52] = rx * Rt[31] + 3 * Rt[25];
        out[53] = rx * Rt[32] + 3 * Rt[26];
        out[54] = rx * Rt[33] + 3 * Rt[28];
        out[55] = rx * Rt[34] + 4 * Rt[31];
}

static void iter_Rt_6(double *out, double *Rt, double rx, double ry, double rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = rz * Rt[3] + 3 * Rt[2];
        out[5] = rz * Rt[4] + 4 * Rt[3];
        out[6] = rz * Rt[5] + 5 * Rt[4];
        out[7] = ry * Rt[0];
        out[8] = ry * Rt[1];
        out[9] = ry * Rt[2];
        out[10] = ry * Rt[3];
        out[11] = ry * Rt[4];
        out[12] = ry * Rt[5];
        out[13] = ry * Rt[6] + Rt[0];
        out[14] = ry * Rt[7] + Rt[1];
        out[15] = ry * Rt[8] + Rt[2];
        out[16] = ry * Rt[9] + Rt[3];
        out[17] = ry * Rt[10] + Rt[4];
        out[18] = ry * Rt[11] + 2 * Rt[6];
        out[19] = ry * Rt[12] + 2 * Rt[7];
        out[20] = ry * Rt[13] + 2 * Rt[8];
        out[21] = ry * Rt[14] + 2 * Rt[9];
        out[22] = ry * Rt[15] + 3 * Rt[11];
        out[23] = ry * Rt[16] + 3 * Rt[12];
        out[24] = ry * Rt[17] + 3 * Rt[13];
        out[25] = ry * Rt[18] + 4 * Rt[15];
        out[26] = ry * Rt[19] + 4 * Rt[16];
        out[27] = ry * Rt[20] + 5 * Rt[18];
        out[28] = rx * Rt[0];
        out[29] = rx * Rt[1];
        out[30] = rx * Rt[2];
        out[31] = rx * Rt[3];
        out[32] = rx * Rt[4];
        out[33] = rx * Rt[5];
        out[34] = rx * Rt[6];
        out[35] = rx * Rt[7];
        out[36] = rx * Rt[8];
        out[37] = rx * Rt[9];
        out[38] = rx * Rt[10];
        out[39] = rx * Rt[11];
        out[40] = rx * Rt[12];
        out[41] = rx * Rt[13];
        out[42] = rx * Rt[14];
        out[43] = rx * Rt[15];
        out[44] = rx * Rt[16];
        out[45] = rx * Rt[17];
        out[46] = rx * Rt[18];
        out[47] = rx * Rt[19];
        out[48] = rx * Rt[20];
        out[49] = rx * Rt[21] + Rt[0];
        out[50] = rx * Rt[22] + Rt[1];
        out[51] = rx * Rt[23] + Rt[2];
        out[52] = rx * Rt[24] + Rt[3];
        out[53] = rx * Rt[25] + Rt[4];
        out[54] = rx * Rt[26] + Rt[6];
        out[55] = rx * Rt[27] + Rt[7];
        out[56] = rx * Rt[28] + Rt[8];
        out[57] = rx * Rt[29] + Rt[9];
        out[58] = rx * Rt[30] + Rt[11];
        out[59] = rx * Rt[31] + Rt[12];
        out[60] = rx * Rt[32] + Rt[13];
        out[61] = rx * Rt[33] + Rt[15];
        out[62] = rx * Rt[34] + Rt[16];
        out[63] = rx * Rt[35] + Rt[18];
        out[64] = rx * Rt[36] + 2 * Rt[21];
        out[65] = rx * Rt[37] + 2 * Rt[22];
        out[66] = rx * Rt[38] + 2 * Rt[23];
        out[67] = rx * Rt[39] + 2 * Rt[24];
        out[68] = rx * Rt[40] + 2 * Rt[26];
        out[69] = rx * Rt[41] + 2 * Rt[27];
        out[70] = rx * Rt[42] + 2 * Rt[28];
        out[71] = rx * Rt[43] + 2 * Rt[30];
        out[72] = rx * Rt[44] + 2 * Rt[31];
        out[73] = rx * Rt[45] + 2 * Rt[33];
        out[74] = rx * Rt[46] + 3 * Rt[36];
        out[75] = rx * Rt[47] + 3 * Rt[37];
        out[76] = rx * Rt[48] + 3 * Rt[38];
        out[77] = rx * Rt[49] + 3 * Rt[40];
        out[78] = rx * Rt[50] + 3 * Rt[41];
        out[79] = rx * Rt[51] + 3 * Rt[43];
        out[80] = rx * Rt[52] + 4 * Rt[46];
        out[81] = rx * Rt[53] + 4 * Rt[47];
        out[82] = rx * Rt[54] + 4 * Rt[49];
        out[83] = rx * Rt[55] + 5 * Rt[52];
}

static void iter_Rt_n(double *out, double *Rt, double rx, double ry, double rz, int l)
{
        out++;
        int *p1 = Rt_idx + Rt_idx_offsets[l];
        int t, u, v, i, k;
        k = 0;
        i = 0;
#pragma GCC ivdep
        for (v = 0; v < l; v++) {
                out[k] = rz * Rt[i] + v * Rt[p1[k]];
                k++; i++;
        }
        i = 0;
        for (u = 0; u < l; u++) {
#pragma GCC ivdep
        for (v = 0; v < l-u; v++) {
                out[k] = ry * Rt[i] + u * Rt[p1[k]];
                k++; i++;
        } }
        i = 0;
        for (t = 0; t < l; t++) {
                // corresponding to the nested loops
                // for (u = 0; u < l-t; u++) for (v = 0; v < l-t-u; v++)
                int uv;
#pragma GCC ivdep
                for (uv = 0; uv < (l-t) * (l-t+1) / 2; uv++) {
                        out[k] = rx * Rt[i] + t * Rt[p1[k]];
                        k++; i++;
                }
        }
}

#define ADDR(l, t, u, v) \
        (lll - ((l)-(t)+1)*((l)-(t)+2)*((l)-(t)+3)/6 + \
         ((l)-(t)+1)*((l)-(t)+2)/2 - ((l)-(t)-(u)+1)*((l)-(t)-(u)+2)/2 + (v))
#define ADDR1(l, t, u, v) \
        (lll1 - ((l)-(t)+1)*((l)-(t)+2)*((l)-(t)+3)/6 + \
         ((l)-(t)+1)*((l)-(t)+2)/2 - ((l)-(t)-(u)+1)*((l)-(t)-(u)+2)/2 + (v))

static void iter_Rt_iter(double *out, double *Rt, double rx, double ry, double rz, int l)
{
        int l1 = l - 1;
        int lll1 = (l1+1)*(l1+2)*(l1+3)/6;
        out++;
        int t, u, v, i, k;
        k = 0;
        i = 0;
        out[k] = rz * Rt[i]; // v = 0
        k++; i++;
        for (v = 1; v < l; v++) {
                out[k] = rz * Rt[i] + v * Rt[ADDR1(l1,0,0,v-1)];
                k++; i++;
        }
        i = 0;
        for (v = 0; v < l; v++) { // u = 0
                out[k] = ry * Rt[i];
                k++; i++;
        }
        for (u = 1; u < l; u++) {
        for (v = 0; v < l-u; v++) {
                out[k] = ry * Rt[i] + u * Rt[ADDR1(l1,0,u-1,v)];
                k++; i++;
        } }
        i = 0;
        for (u = 0; u < l; u++) { // t = 0;
        for (v = 0; v < l-u; v++) {
                out[k] = rx * Rt[i];
                k++; i++;
        } }
        for (t = 1; t < l; t++) {
                for (u = 0; u < l-t; u++) {
                for (v = 0; v < l-t-u; v++) {
                        out[k] = rx * Rt[i] + t * Rt[ADDR1(l1,t-1,u,v)];
                        k++; i++;
                } }
        }
}

int get_R_tensor(double *Rt, int l, double a, double fac, double *rpq, double *buf)
{
        if (l > LSUM_MAX) {
                return -1;
        }
        if (l == 0) {
                eval_boys(Rt, l, a, fac, rpq);
                return 0;
        }

        double boys[LSUM_MAX+1];
        eval_boys(boys, l, a, fac, rpq);
        double rx = rpq[0];
        double ry = rpq[1];
        double rz = rpq[2];
        if (l == 1) {
                Rt[0] = boys[0];
                iter_Rt_1(Rt, boys+1, rx, ry, rz);
                return 0;
        }

        double *tmp;
        if (l % 2 == 0) {
                tmp = buf;
                buf = Rt;
                Rt = tmp;
        }
        buf[0] = boys[l];

        for (int n = 1; n <= l; n++) {
                Rt[0] = boys[l-n];
                switch (n) {
                case 1: iter_Rt_1(Rt, buf, rx, ry, rz); break;
                case 2: iter_Rt_2(Rt, buf, rx, ry, rz); break;
                case 3: iter_Rt_3(Rt, buf, rx, ry, rz); break;
                case 4: iter_Rt_4(Rt, buf, rx, ry, rz); break;
                case 5: iter_Rt_5(Rt, buf, rx, ry, rz); break;
                case 6: iter_Rt_6(Rt, buf, rx, ry, rz); break;
                default:
                        if (n <= RTIDX_MAX) {
                                iter_Rt_n(Rt, buf, rx, ry, rz, n);
                        } else {
                                iter_Rt_iter(Rt, buf, rx, ry, rz, n);
                        }
                }
                // swap input and output
                tmp = buf;
                buf = Rt;
                Rt = tmp;
        }
        return 0;
}

static void Rt2_0_0(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 0, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
}
static void Rt2_0_1(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 1, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[3];
}
static void Rt2_0_2(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 2, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[3];
        Rt2[4] = Rt[4];
        Rt2[5] = Rt[5];
        Rt2[6] = Rt[6];
        Rt2[7] = Rt[7];
        Rt2[8] = Rt[8];
        Rt2[9] = Rt[9];
}
static void Rt2_0_3(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 3, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[3];
        Rt2[4] = Rt[4];
        Rt2[5] = Rt[5];
        Rt2[6] = Rt[6];
        Rt2[7] = Rt[7];
        Rt2[8] = Rt[8];
        Rt2[9] = Rt[9];
        Rt2[10] = Rt[10];
        Rt2[11] = Rt[11];
        Rt2[12] = Rt[12];
        Rt2[13] = Rt[13];
        Rt2[14] = Rt[14];
        Rt2[15] = Rt[15];
        Rt2[16] = Rt[16];
        Rt2[17] = Rt[17];
        Rt2[18] = Rt[18];
        Rt2[19] = Rt[19];
}
static void Rt2_1_0(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 1, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = -Rt[1];
        Rt2[2] = -Rt[2];
        Rt2[3] = -Rt[3];
}
static void Rt2_1_1(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 2, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[3];
        Rt2[3] = Rt[6];
        Rt2[4] = -Rt[1];
        Rt2[5] = -Rt[2];
        Rt2[6] = -Rt[4];
        Rt2[7] = -Rt[7];
        Rt2[8] = -Rt[3];
        Rt2[9] = -Rt[4];
        Rt2[10] = -Rt[5];
        Rt2[11] = -Rt[8];
        Rt2[12] = -Rt[6];
        Rt2[13] = -Rt[7];
        Rt2[14] = -Rt[8];
        Rt2[15] = -Rt[9];
}
static void Rt2_1_2(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 3, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[4];
        Rt2[4] = Rt[5];
        Rt2[5] = Rt[7];
        Rt2[6] = Rt[10];
        Rt2[7] = Rt[11];
        Rt2[8] = Rt[13];
        Rt2[9] = Rt[16];
        Rt2[10] = -Rt[1];
        Rt2[11] = -Rt[2];
        Rt2[12] = -Rt[3];
        Rt2[13] = -Rt[5];
        Rt2[14] = -Rt[6];
        Rt2[15] = -Rt[8];
        Rt2[16] = -Rt[11];
        Rt2[17] = -Rt[12];
        Rt2[18] = -Rt[14];
        Rt2[19] = -Rt[17];
        Rt2[20] = -Rt[4];
        Rt2[21] = -Rt[5];
        Rt2[22] = -Rt[6];
        Rt2[23] = -Rt[7];
        Rt2[24] = -Rt[8];
        Rt2[25] = -Rt[9];
        Rt2[26] = -Rt[13];
        Rt2[27] = -Rt[14];
        Rt2[28] = -Rt[15];
        Rt2[29] = -Rt[18];
        Rt2[30] = -Rt[10];
        Rt2[31] = -Rt[11];
        Rt2[32] = -Rt[12];
        Rt2[33] = -Rt[13];
        Rt2[34] = -Rt[14];
        Rt2[35] = -Rt[15];
        Rt2[36] = -Rt[16];
        Rt2[37] = -Rt[17];
        Rt2[38] = -Rt[18];
        Rt2[39] = -Rt[19];
}
static void Rt2_1_3(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 4, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[3];
        Rt2[4] = Rt[5];
        Rt2[5] = Rt[6];
        Rt2[6] = Rt[7];
        Rt2[7] = Rt[9];
        Rt2[8] = Rt[10];
        Rt2[9] = Rt[12];
        Rt2[10] = Rt[15];
        Rt2[11] = Rt[16];
        Rt2[12] = Rt[17];
        Rt2[13] = Rt[19];
        Rt2[14] = Rt[20];
        Rt2[15] = Rt[22];
        Rt2[16] = Rt[25];
        Rt2[17] = Rt[26];
        Rt2[18] = Rt[28];
        Rt2[19] = Rt[31];
        Rt2[20] = -Rt[1];
        Rt2[21] = -Rt[2];
        Rt2[22] = -Rt[3];
        Rt2[23] = -Rt[4];
        Rt2[24] = -Rt[6];
        Rt2[25] = -Rt[7];
        Rt2[26] = -Rt[8];
        Rt2[27] = -Rt[10];
        Rt2[28] = -Rt[11];
        Rt2[29] = -Rt[13];
        Rt2[30] = -Rt[16];
        Rt2[31] = -Rt[17];
        Rt2[32] = -Rt[18];
        Rt2[33] = -Rt[20];
        Rt2[34] = -Rt[21];
        Rt2[35] = -Rt[23];
        Rt2[36] = -Rt[26];
        Rt2[37] = -Rt[27];
        Rt2[38] = -Rt[29];
        Rt2[39] = -Rt[32];
        Rt2[40] = -Rt[5];
        Rt2[41] = -Rt[6];
        Rt2[42] = -Rt[7];
        Rt2[43] = -Rt[8];
        Rt2[44] = -Rt[9];
        Rt2[45] = -Rt[10];
        Rt2[46] = -Rt[11];
        Rt2[47] = -Rt[12];
        Rt2[48] = -Rt[13];
        Rt2[49] = -Rt[14];
        Rt2[50] = -Rt[19];
        Rt2[51] = -Rt[20];
        Rt2[52] = -Rt[21];
        Rt2[53] = -Rt[22];
        Rt2[54] = -Rt[23];
        Rt2[55] = -Rt[24];
        Rt2[56] = -Rt[28];
        Rt2[57] = -Rt[29];
        Rt2[58] = -Rt[30];
        Rt2[59] = -Rt[33];
        Rt2[60] = -Rt[15];
        Rt2[61] = -Rt[16];
        Rt2[62] = -Rt[17];
        Rt2[63] = -Rt[18];
        Rt2[64] = -Rt[19];
        Rt2[65] = -Rt[20];
        Rt2[66] = -Rt[21];
        Rt2[67] = -Rt[22];
        Rt2[68] = -Rt[23];
        Rt2[69] = -Rt[24];
        Rt2[70] = -Rt[25];
        Rt2[71] = -Rt[26];
        Rt2[72] = -Rt[27];
        Rt2[73] = -Rt[28];
        Rt2[74] = -Rt[29];
        Rt2[75] = -Rt[30];
        Rt2[76] = -Rt[31];
        Rt2[77] = -Rt[32];
        Rt2[78] = -Rt[33];
        Rt2[79] = -Rt[34];
}
static void Rt2_2_0(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 2, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = -Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = -Rt[3];
        Rt2[4] = Rt[4];
        Rt2[5] = Rt[5];
        Rt2[6] = -Rt[6];
        Rt2[7] = Rt[7];
        Rt2[8] = Rt[8];
        Rt2[9] = Rt[9];
}
static void Rt2_2_1(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 3, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[4];
        Rt2[3] = Rt[10];
        Rt2[4] = -Rt[1];
        Rt2[5] = -Rt[2];
        Rt2[6] = -Rt[5];
        Rt2[7] = -Rt[11];
        Rt2[8] = Rt[2];
        Rt2[9] = Rt[3];
        Rt2[10] = Rt[6];
        Rt2[11] = Rt[12];
        Rt2[12] = -Rt[4];
        Rt2[13] = -Rt[5];
        Rt2[14] = -Rt[7];
        Rt2[15] = -Rt[13];
        Rt2[16] = Rt[5];
        Rt2[17] = Rt[6];
        Rt2[18] = Rt[8];
        Rt2[19] = Rt[14];
        Rt2[20] = Rt[7];
        Rt2[21] = Rt[8];
        Rt2[22] = Rt[9];
        Rt2[23] = Rt[15];
        Rt2[24] = -Rt[10];
        Rt2[25] = -Rt[11];
        Rt2[26] = -Rt[13];
        Rt2[27] = -Rt[16];
        Rt2[28] = Rt[11];
        Rt2[29] = Rt[12];
        Rt2[30] = Rt[14];
        Rt2[31] = Rt[17];
        Rt2[32] = Rt[13];
        Rt2[33] = Rt[14];
        Rt2[34] = Rt[15];
        Rt2[35] = Rt[18];
        Rt2[36] = Rt[16];
        Rt2[37] = Rt[17];
        Rt2[38] = Rt[18];
        Rt2[39] = Rt[19];
}
static void Rt2_2_2(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 4, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[5];
        Rt2[4] = Rt[6];
        Rt2[5] = Rt[9];
        Rt2[6] = Rt[15];
        Rt2[7] = Rt[16];
        Rt2[8] = Rt[19];
        Rt2[9] = Rt[25];
        Rt2[10] = -Rt[1];
        Rt2[11] = -Rt[2];
        Rt2[12] = -Rt[3];
        Rt2[13] = -Rt[6];
        Rt2[14] = -Rt[7];
        Rt2[15] = -Rt[10];
        Rt2[16] = -Rt[16];
        Rt2[17] = -Rt[17];
        Rt2[18] = -Rt[20];
        Rt2[19] = -Rt[26];
        Rt2[20] = Rt[2];
        Rt2[21] = Rt[3];
        Rt2[22] = Rt[4];
        Rt2[23] = Rt[7];
        Rt2[24] = Rt[8];
        Rt2[25] = Rt[11];
        Rt2[26] = Rt[17];
        Rt2[27] = Rt[18];
        Rt2[28] = Rt[21];
        Rt2[29] = Rt[27];
        Rt2[30] = -Rt[5];
        Rt2[31] = -Rt[6];
        Rt2[32] = -Rt[7];
        Rt2[33] = -Rt[9];
        Rt2[34] = -Rt[10];
        Rt2[35] = -Rt[12];
        Rt2[36] = -Rt[19];
        Rt2[37] = -Rt[20];
        Rt2[38] = -Rt[22];
        Rt2[39] = -Rt[28];
        Rt2[40] = Rt[6];
        Rt2[41] = Rt[7];
        Rt2[42] = Rt[8];
        Rt2[43] = Rt[10];
        Rt2[44] = Rt[11];
        Rt2[45] = Rt[13];
        Rt2[46] = Rt[20];
        Rt2[47] = Rt[21];
        Rt2[48] = Rt[23];
        Rt2[49] = Rt[29];
        Rt2[50] = Rt[9];
        Rt2[51] = Rt[10];
        Rt2[52] = Rt[11];
        Rt2[53] = Rt[12];
        Rt2[54] = Rt[13];
        Rt2[55] = Rt[14];
        Rt2[56] = Rt[22];
        Rt2[57] = Rt[23];
        Rt2[58] = Rt[24];
        Rt2[59] = Rt[30];
        Rt2[60] = -Rt[15];
        Rt2[61] = -Rt[16];
        Rt2[62] = -Rt[17];
        Rt2[63] = -Rt[19];
        Rt2[64] = -Rt[20];
        Rt2[65] = -Rt[22];
        Rt2[66] = -Rt[25];
        Rt2[67] = -Rt[26];
        Rt2[68] = -Rt[28];
        Rt2[69] = -Rt[31];
        Rt2[70] = Rt[16];
        Rt2[71] = Rt[17];
        Rt2[72] = Rt[18];
        Rt2[73] = Rt[20];
        Rt2[74] = Rt[21];
        Rt2[75] = Rt[23];
        Rt2[76] = Rt[26];
        Rt2[77] = Rt[27];
        Rt2[78] = Rt[29];
        Rt2[79] = Rt[32];
        Rt2[80] = Rt[19];
        Rt2[81] = Rt[20];
        Rt2[82] = Rt[21];
        Rt2[83] = Rt[22];
        Rt2[84] = Rt[23];
        Rt2[85] = Rt[24];
        Rt2[86] = Rt[28];
        Rt2[87] = Rt[29];
        Rt2[88] = Rt[30];
        Rt2[89] = Rt[33];
        Rt2[90] = Rt[25];
        Rt2[91] = Rt[26];
        Rt2[92] = Rt[27];
        Rt2[93] = Rt[28];
        Rt2[94] = Rt[29];
        Rt2[95] = Rt[30];
        Rt2[96] = Rt[31];
        Rt2[97] = Rt[32];
        Rt2[98] = Rt[33];
        Rt2[99] = Rt[34];
}
static void Rt2_2_3(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 5, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[3];
        Rt2[4] = Rt[6];
        Rt2[5] = Rt[7];
        Rt2[6] = Rt[8];
        Rt2[7] = Rt[11];
        Rt2[8] = Rt[12];
        Rt2[9] = Rt[15];
        Rt2[10] = Rt[21];
        Rt2[11] = Rt[22];
        Rt2[12] = Rt[23];
        Rt2[13] = Rt[26];
        Rt2[14] = Rt[27];
        Rt2[15] = Rt[30];
        Rt2[16] = Rt[36];
        Rt2[17] = Rt[37];
        Rt2[18] = Rt[40];
        Rt2[19] = Rt[46];
        Rt2[20] = -Rt[1];
        Rt2[21] = -Rt[2];
        Rt2[22] = -Rt[3];
        Rt2[23] = -Rt[4];
        Rt2[24] = -Rt[7];
        Rt2[25] = -Rt[8];
        Rt2[26] = -Rt[9];
        Rt2[27] = -Rt[12];
        Rt2[28] = -Rt[13];
        Rt2[29] = -Rt[16];
        Rt2[30] = -Rt[22];
        Rt2[31] = -Rt[23];
        Rt2[32] = -Rt[24];
        Rt2[33] = -Rt[27];
        Rt2[34] = -Rt[28];
        Rt2[35] = -Rt[31];
        Rt2[36] = -Rt[37];
        Rt2[37] = -Rt[38];
        Rt2[38] = -Rt[41];
        Rt2[39] = -Rt[47];
        Rt2[40] = Rt[2];
        Rt2[41] = Rt[3];
        Rt2[42] = Rt[4];
        Rt2[43] = Rt[5];
        Rt2[44] = Rt[8];
        Rt2[45] = Rt[9];
        Rt2[46] = Rt[10];
        Rt2[47] = Rt[13];
        Rt2[48] = Rt[14];
        Rt2[49] = Rt[17];
        Rt2[50] = Rt[23];
        Rt2[51] = Rt[24];
        Rt2[52] = Rt[25];
        Rt2[53] = Rt[28];
        Rt2[54] = Rt[29];
        Rt2[55] = Rt[32];
        Rt2[56] = Rt[38];
        Rt2[57] = Rt[39];
        Rt2[58] = Rt[42];
        Rt2[59] = Rt[48];
        Rt2[60] = -Rt[6];
        Rt2[61] = -Rt[7];
        Rt2[62] = -Rt[8];
        Rt2[63] = -Rt[9];
        Rt2[64] = -Rt[11];
        Rt2[65] = -Rt[12];
        Rt2[66] = -Rt[13];
        Rt2[67] = -Rt[15];
        Rt2[68] = -Rt[16];
        Rt2[69] = -Rt[18];
        Rt2[70] = -Rt[26];
        Rt2[71] = -Rt[27];
        Rt2[72] = -Rt[28];
        Rt2[73] = -Rt[30];
        Rt2[74] = -Rt[31];
        Rt2[75] = -Rt[33];
        Rt2[76] = -Rt[40];
        Rt2[77] = -Rt[41];
        Rt2[78] = -Rt[43];
        Rt2[79] = -Rt[49];
        Rt2[80] = Rt[7];
        Rt2[81] = Rt[8];
        Rt2[82] = Rt[9];
        Rt2[83] = Rt[10];
        Rt2[84] = Rt[12];
        Rt2[85] = Rt[13];
        Rt2[86] = Rt[14];
        Rt2[87] = Rt[16];
        Rt2[88] = Rt[17];
        Rt2[89] = Rt[19];
        Rt2[90] = Rt[27];
        Rt2[91] = Rt[28];
        Rt2[92] = Rt[29];
        Rt2[93] = Rt[31];
        Rt2[94] = Rt[32];
        Rt2[95] = Rt[34];
        Rt2[96] = Rt[41];
        Rt2[97] = Rt[42];
        Rt2[98] = Rt[44];
        Rt2[99] = Rt[50];
        Rt2[100] = Rt[11];
        Rt2[101] = Rt[12];
        Rt2[102] = Rt[13];
        Rt2[103] = Rt[14];
        Rt2[104] = Rt[15];
        Rt2[105] = Rt[16];
        Rt2[106] = Rt[17];
        Rt2[107] = Rt[18];
        Rt2[108] = Rt[19];
        Rt2[109] = Rt[20];
        Rt2[110] = Rt[30];
        Rt2[111] = Rt[31];
        Rt2[112] = Rt[32];
        Rt2[113] = Rt[33];
        Rt2[114] = Rt[34];
        Rt2[115] = Rt[35];
        Rt2[116] = Rt[43];
        Rt2[117] = Rt[44];
        Rt2[118] = Rt[45];
        Rt2[119] = Rt[51];
        Rt2[120] = -Rt[21];
        Rt2[121] = -Rt[22];
        Rt2[122] = -Rt[23];
        Rt2[123] = -Rt[24];
        Rt2[124] = -Rt[26];
        Rt2[125] = -Rt[27];
        Rt2[126] = -Rt[28];
        Rt2[127] = -Rt[30];
        Rt2[128] = -Rt[31];
        Rt2[129] = -Rt[33];
        Rt2[130] = -Rt[36];
        Rt2[131] = -Rt[37];
        Rt2[132] = -Rt[38];
        Rt2[133] = -Rt[40];
        Rt2[134] = -Rt[41];
        Rt2[135] = -Rt[43];
        Rt2[136] = -Rt[46];
        Rt2[137] = -Rt[47];
        Rt2[138] = -Rt[49];
        Rt2[139] = -Rt[52];
        Rt2[140] = Rt[22];
        Rt2[141] = Rt[23];
        Rt2[142] = Rt[24];
        Rt2[143] = Rt[25];
        Rt2[144] = Rt[27];
        Rt2[145] = Rt[28];
        Rt2[146] = Rt[29];
        Rt2[147] = Rt[31];
        Rt2[148] = Rt[32];
        Rt2[149] = Rt[34];
        Rt2[150] = Rt[37];
        Rt2[151] = Rt[38];
        Rt2[152] = Rt[39];
        Rt2[153] = Rt[41];
        Rt2[154] = Rt[42];
        Rt2[155] = Rt[44];
        Rt2[156] = Rt[47];
        Rt2[157] = Rt[48];
        Rt2[158] = Rt[50];
        Rt2[159] = Rt[53];
        Rt2[160] = Rt[26];
        Rt2[161] = Rt[27];
        Rt2[162] = Rt[28];
        Rt2[163] = Rt[29];
        Rt2[164] = Rt[30];
        Rt2[165] = Rt[31];
        Rt2[166] = Rt[32];
        Rt2[167] = Rt[33];
        Rt2[168] = Rt[34];
        Rt2[169] = Rt[35];
        Rt2[170] = Rt[40];
        Rt2[171] = Rt[41];
        Rt2[172] = Rt[42];
        Rt2[173] = Rt[43];
        Rt2[174] = Rt[44];
        Rt2[175] = Rt[45];
        Rt2[176] = Rt[49];
        Rt2[177] = Rt[50];
        Rt2[178] = Rt[51];
        Rt2[179] = Rt[54];
        Rt2[180] = Rt[36];
        Rt2[181] = Rt[37];
        Rt2[182] = Rt[38];
        Rt2[183] = Rt[39];
        Rt2[184] = Rt[40];
        Rt2[185] = Rt[41];
        Rt2[186] = Rt[42];
        Rt2[187] = Rt[43];
        Rt2[188] = Rt[44];
        Rt2[189] = Rt[45];
        Rt2[190] = Rt[46];
        Rt2[191] = Rt[47];
        Rt2[192] = Rt[48];
        Rt2[193] = Rt[49];
        Rt2[194] = Rt[50];
        Rt2[195] = Rt[51];
        Rt2[196] = Rt[52];
        Rt2[197] = Rt[53];
        Rt2[198] = Rt[54];
        Rt2[199] = Rt[55];
}
static void Rt2_3_0(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 3, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = -Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = -Rt[3];
        Rt2[4] = -Rt[4];
        Rt2[5] = Rt[5];
        Rt2[6] = -Rt[6];
        Rt2[7] = Rt[7];
        Rt2[8] = -Rt[8];
        Rt2[9] = -Rt[9];
        Rt2[10] = -Rt[10];
        Rt2[11] = Rt[11];
        Rt2[12] = -Rt[12];
        Rt2[13] = Rt[13];
        Rt2[14] = -Rt[14];
        Rt2[15] = -Rt[15];
        Rt2[16] = Rt[16];
        Rt2[17] = -Rt[17];
        Rt2[18] = -Rt[18];
        Rt2[19] = -Rt[19];
}
static void Rt2_3_1(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 4, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[5];
        Rt2[3] = Rt[15];
        Rt2[4] = -Rt[1];
        Rt2[5] = -Rt[2];
        Rt2[6] = -Rt[6];
        Rt2[7] = -Rt[16];
        Rt2[8] = Rt[2];
        Rt2[9] = Rt[3];
        Rt2[10] = Rt[7];
        Rt2[11] = Rt[17];
        Rt2[12] = -Rt[3];
        Rt2[13] = -Rt[4];
        Rt2[14] = -Rt[8];
        Rt2[15] = -Rt[18];
        Rt2[16] = -Rt[5];
        Rt2[17] = -Rt[6];
        Rt2[18] = -Rt[9];
        Rt2[19] = -Rt[19];
        Rt2[20] = Rt[6];
        Rt2[21] = Rt[7];
        Rt2[22] = Rt[10];
        Rt2[23] = Rt[20];
        Rt2[24] = -Rt[7];
        Rt2[25] = -Rt[8];
        Rt2[26] = -Rt[11];
        Rt2[27] = -Rt[21];
        Rt2[28] = Rt[9];
        Rt2[29] = Rt[10];
        Rt2[30] = Rt[12];
        Rt2[31] = Rt[22];
        Rt2[32] = -Rt[10];
        Rt2[33] = -Rt[11];
        Rt2[34] = -Rt[13];
        Rt2[35] = -Rt[23];
        Rt2[36] = -Rt[12];
        Rt2[37] = -Rt[13];
        Rt2[38] = -Rt[14];
        Rt2[39] = -Rt[24];
        Rt2[40] = -Rt[15];
        Rt2[41] = -Rt[16];
        Rt2[42] = -Rt[19];
        Rt2[43] = -Rt[25];
        Rt2[44] = Rt[16];
        Rt2[45] = Rt[17];
        Rt2[46] = Rt[20];
        Rt2[47] = Rt[26];
        Rt2[48] = -Rt[17];
        Rt2[49] = -Rt[18];
        Rt2[50] = -Rt[21];
        Rt2[51] = -Rt[27];
        Rt2[52] = Rt[19];
        Rt2[53] = Rt[20];
        Rt2[54] = Rt[22];
        Rt2[55] = Rt[28];
        Rt2[56] = -Rt[20];
        Rt2[57] = -Rt[21];
        Rt2[58] = -Rt[23];
        Rt2[59] = -Rt[29];
        Rt2[60] = -Rt[22];
        Rt2[61] = -Rt[23];
        Rt2[62] = -Rt[24];
        Rt2[63] = -Rt[30];
        Rt2[64] = Rt[25];
        Rt2[65] = Rt[26];
        Rt2[66] = Rt[28];
        Rt2[67] = Rt[31];
        Rt2[68] = -Rt[26];
        Rt2[69] = -Rt[27];
        Rt2[70] = -Rt[29];
        Rt2[71] = -Rt[32];
        Rt2[72] = -Rt[28];
        Rt2[73] = -Rt[29];
        Rt2[74] = -Rt[30];
        Rt2[75] = -Rt[33];
        Rt2[76] = -Rt[31];
        Rt2[77] = -Rt[32];
        Rt2[78] = -Rt[33];
        Rt2[79] = -Rt[34];
}
static void Rt2_3_2(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 5, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[6];
        Rt2[4] = Rt[7];
        Rt2[5] = Rt[11];
        Rt2[6] = Rt[21];
        Rt2[7] = Rt[22];
        Rt2[8] = Rt[26];
        Rt2[9] = Rt[36];
        Rt2[10] = -Rt[1];
        Rt2[11] = -Rt[2];
        Rt2[12] = -Rt[3];
        Rt2[13] = -Rt[7];
        Rt2[14] = -Rt[8];
        Rt2[15] = -Rt[12];
        Rt2[16] = -Rt[22];
        Rt2[17] = -Rt[23];
        Rt2[18] = -Rt[27];
        Rt2[19] = -Rt[37];
        Rt2[20] = Rt[2];
        Rt2[21] = Rt[3];
        Rt2[22] = Rt[4];
        Rt2[23] = Rt[8];
        Rt2[24] = Rt[9];
        Rt2[25] = Rt[13];
        Rt2[26] = Rt[23];
        Rt2[27] = Rt[24];
        Rt2[28] = Rt[28];
        Rt2[29] = Rt[38];
        Rt2[30] = -Rt[3];
        Rt2[31] = -Rt[4];
        Rt2[32] = -Rt[5];
        Rt2[33] = -Rt[9];
        Rt2[34] = -Rt[10];
        Rt2[35] = -Rt[14];
        Rt2[36] = -Rt[24];
        Rt2[37] = -Rt[25];
        Rt2[38] = -Rt[29];
        Rt2[39] = -Rt[39];
        Rt2[40] = -Rt[6];
        Rt2[41] = -Rt[7];
        Rt2[42] = -Rt[8];
        Rt2[43] = -Rt[11];
        Rt2[44] = -Rt[12];
        Rt2[45] = -Rt[15];
        Rt2[46] = -Rt[26];
        Rt2[47] = -Rt[27];
        Rt2[48] = -Rt[30];
        Rt2[49] = -Rt[40];
        Rt2[50] = Rt[7];
        Rt2[51] = Rt[8];
        Rt2[52] = Rt[9];
        Rt2[53] = Rt[12];
        Rt2[54] = Rt[13];
        Rt2[55] = Rt[16];
        Rt2[56] = Rt[27];
        Rt2[57] = Rt[28];
        Rt2[58] = Rt[31];
        Rt2[59] = Rt[41];
        Rt2[60] = -Rt[8];
        Rt2[61] = -Rt[9];
        Rt2[62] = -Rt[10];
        Rt2[63] = -Rt[13];
        Rt2[64] = -Rt[14];
        Rt2[65] = -Rt[17];
        Rt2[66] = -Rt[28];
        Rt2[67] = -Rt[29];
        Rt2[68] = -Rt[32];
        Rt2[69] = -Rt[42];
        Rt2[70] = Rt[11];
        Rt2[71] = Rt[12];
        Rt2[72] = Rt[13];
        Rt2[73] = Rt[15];
        Rt2[74] = Rt[16];
        Rt2[75] = Rt[18];
        Rt2[76] = Rt[30];
        Rt2[77] = Rt[31];
        Rt2[78] = Rt[33];
        Rt2[79] = Rt[43];
        Rt2[80] = -Rt[12];
        Rt2[81] = -Rt[13];
        Rt2[82] = -Rt[14];
        Rt2[83] = -Rt[16];
        Rt2[84] = -Rt[17];
        Rt2[85] = -Rt[19];
        Rt2[86] = -Rt[31];
        Rt2[87] = -Rt[32];
        Rt2[88] = -Rt[34];
        Rt2[89] = -Rt[44];
        Rt2[90] = -Rt[15];
        Rt2[91] = -Rt[16];
        Rt2[92] = -Rt[17];
        Rt2[93] = -Rt[18];
        Rt2[94] = -Rt[19];
        Rt2[95] = -Rt[20];
        Rt2[96] = -Rt[33];
        Rt2[97] = -Rt[34];
        Rt2[98] = -Rt[35];
        Rt2[99] = -Rt[45];
        Rt2[100] = -Rt[21];
        Rt2[101] = -Rt[22];
        Rt2[102] = -Rt[23];
        Rt2[103] = -Rt[26];
        Rt2[104] = -Rt[27];
        Rt2[105] = -Rt[30];
        Rt2[106] = -Rt[36];
        Rt2[107] = -Rt[37];
        Rt2[108] = -Rt[40];
        Rt2[109] = -Rt[46];
        Rt2[110] = Rt[22];
        Rt2[111] = Rt[23];
        Rt2[112] = Rt[24];
        Rt2[113] = Rt[27];
        Rt2[114] = Rt[28];
        Rt2[115] = Rt[31];
        Rt2[116] = Rt[37];
        Rt2[117] = Rt[38];
        Rt2[118] = Rt[41];
        Rt2[119] = Rt[47];
        Rt2[120] = -Rt[23];
        Rt2[121] = -Rt[24];
        Rt2[122] = -Rt[25];
        Rt2[123] = -Rt[28];
        Rt2[124] = -Rt[29];
        Rt2[125] = -Rt[32];
        Rt2[126] = -Rt[38];
        Rt2[127] = -Rt[39];
        Rt2[128] = -Rt[42];
        Rt2[129] = -Rt[48];
        Rt2[130] = Rt[26];
        Rt2[131] = Rt[27];
        Rt2[132] = Rt[28];
        Rt2[133] = Rt[30];
        Rt2[134] = Rt[31];
        Rt2[135] = Rt[33];
        Rt2[136] = Rt[40];
        Rt2[137] = Rt[41];
        Rt2[138] = Rt[43];
        Rt2[139] = Rt[49];
        Rt2[140] = -Rt[27];
        Rt2[141] = -Rt[28];
        Rt2[142] = -Rt[29];
        Rt2[143] = -Rt[31];
        Rt2[144] = -Rt[32];
        Rt2[145] = -Rt[34];
        Rt2[146] = -Rt[41];
        Rt2[147] = -Rt[42];
        Rt2[148] = -Rt[44];
        Rt2[149] = -Rt[50];
        Rt2[150] = -Rt[30];
        Rt2[151] = -Rt[31];
        Rt2[152] = -Rt[32];
        Rt2[153] = -Rt[33];
        Rt2[154] = -Rt[34];
        Rt2[155] = -Rt[35];
        Rt2[156] = -Rt[43];
        Rt2[157] = -Rt[44];
        Rt2[158] = -Rt[45];
        Rt2[159] = -Rt[51];
        Rt2[160] = Rt[36];
        Rt2[161] = Rt[37];
        Rt2[162] = Rt[38];
        Rt2[163] = Rt[40];
        Rt2[164] = Rt[41];
        Rt2[165] = Rt[43];
        Rt2[166] = Rt[46];
        Rt2[167] = Rt[47];
        Rt2[168] = Rt[49];
        Rt2[169] = Rt[52];
        Rt2[170] = -Rt[37];
        Rt2[171] = -Rt[38];
        Rt2[172] = -Rt[39];
        Rt2[173] = -Rt[41];
        Rt2[174] = -Rt[42];
        Rt2[175] = -Rt[44];
        Rt2[176] = -Rt[47];
        Rt2[177] = -Rt[48];
        Rt2[178] = -Rt[50];
        Rt2[179] = -Rt[53];
        Rt2[180] = -Rt[40];
        Rt2[181] = -Rt[41];
        Rt2[182] = -Rt[42];
        Rt2[183] = -Rt[43];
        Rt2[184] = -Rt[44];
        Rt2[185] = -Rt[45];
        Rt2[186] = -Rt[49];
        Rt2[187] = -Rt[50];
        Rt2[188] = -Rt[51];
        Rt2[189] = -Rt[54];
        Rt2[190] = -Rt[46];
        Rt2[191] = -Rt[47];
        Rt2[192] = -Rt[48];
        Rt2[193] = -Rt[49];
        Rt2[194] = -Rt[50];
        Rt2[195] = -Rt[51];
        Rt2[196] = -Rt[52];
        Rt2[197] = -Rt[53];
        Rt2[198] = -Rt[54];
        Rt2[199] = -Rt[55];
}
static void Rt2_3_3(double *Rt2, double a, double fac, double *rpq, double *Rt)
{
        get_R_tensor(Rt, 6, a, fac, rpq, Rt2);
        Rt2[0] = Rt[0];
        Rt2[1] = Rt[1];
        Rt2[2] = Rt[2];
        Rt2[3] = Rt[3];
        Rt2[4] = Rt[7];
        Rt2[5] = Rt[8];
        Rt2[6] = Rt[9];
        Rt2[7] = Rt[13];
        Rt2[8] = Rt[14];
        Rt2[9] = Rt[18];
        Rt2[10] = Rt[28];
        Rt2[11] = Rt[29];
        Rt2[12] = Rt[30];
        Rt2[13] = Rt[34];
        Rt2[14] = Rt[35];
        Rt2[15] = Rt[39];
        Rt2[16] = Rt[49];
        Rt2[17] = Rt[50];
        Rt2[18] = Rt[54];
        Rt2[19] = Rt[64];
        Rt2[20] = -Rt[1];
        Rt2[21] = -Rt[2];
        Rt2[22] = -Rt[3];
        Rt2[23] = -Rt[4];
        Rt2[24] = -Rt[8];
        Rt2[25] = -Rt[9];
        Rt2[26] = -Rt[10];
        Rt2[27] = -Rt[14];
        Rt2[28] = -Rt[15];
        Rt2[29] = -Rt[19];
        Rt2[30] = -Rt[29];
        Rt2[31] = -Rt[30];
        Rt2[32] = -Rt[31];
        Rt2[33] = -Rt[35];
        Rt2[34] = -Rt[36];
        Rt2[35] = -Rt[40];
        Rt2[36] = -Rt[50];
        Rt2[37] = -Rt[51];
        Rt2[38] = -Rt[55];
        Rt2[39] = -Rt[65];
        Rt2[40] = Rt[2];
        Rt2[41] = Rt[3];
        Rt2[42] = Rt[4];
        Rt2[43] = Rt[5];
        Rt2[44] = Rt[9];
        Rt2[45] = Rt[10];
        Rt2[46] = Rt[11];
        Rt2[47] = Rt[15];
        Rt2[48] = Rt[16];
        Rt2[49] = Rt[20];
        Rt2[50] = Rt[30];
        Rt2[51] = Rt[31];
        Rt2[52] = Rt[32];
        Rt2[53] = Rt[36];
        Rt2[54] = Rt[37];
        Rt2[55] = Rt[41];
        Rt2[56] = Rt[51];
        Rt2[57] = Rt[52];
        Rt2[58] = Rt[56];
        Rt2[59] = Rt[66];
        Rt2[60] = -Rt[3];
        Rt2[61] = -Rt[4];
        Rt2[62] = -Rt[5];
        Rt2[63] = -Rt[6];
        Rt2[64] = -Rt[10];
        Rt2[65] = -Rt[11];
        Rt2[66] = -Rt[12];
        Rt2[67] = -Rt[16];
        Rt2[68] = -Rt[17];
        Rt2[69] = -Rt[21];
        Rt2[70] = -Rt[31];
        Rt2[71] = -Rt[32];
        Rt2[72] = -Rt[33];
        Rt2[73] = -Rt[37];
        Rt2[74] = -Rt[38];
        Rt2[75] = -Rt[42];
        Rt2[76] = -Rt[52];
        Rt2[77] = -Rt[53];
        Rt2[78] = -Rt[57];
        Rt2[79] = -Rt[67];
        Rt2[80] = -Rt[7];
        Rt2[81] = -Rt[8];
        Rt2[82] = -Rt[9];
        Rt2[83] = -Rt[10];
        Rt2[84] = -Rt[13];
        Rt2[85] = -Rt[14];
        Rt2[86] = -Rt[15];
        Rt2[87] = -Rt[18];
        Rt2[88] = -Rt[19];
        Rt2[89] = -Rt[22];
        Rt2[90] = -Rt[34];
        Rt2[91] = -Rt[35];
        Rt2[92] = -Rt[36];
        Rt2[93] = -Rt[39];
        Rt2[94] = -Rt[40];
        Rt2[95] = -Rt[43];
        Rt2[96] = -Rt[54];
        Rt2[97] = -Rt[55];
        Rt2[98] = -Rt[58];
        Rt2[99] = -Rt[68];
        Rt2[100] = Rt[8];
        Rt2[101] = Rt[9];
        Rt2[102] = Rt[10];
        Rt2[103] = Rt[11];
        Rt2[104] = Rt[14];
        Rt2[105] = Rt[15];
        Rt2[106] = Rt[16];
        Rt2[107] = Rt[19];
        Rt2[108] = Rt[20];
        Rt2[109] = Rt[23];
        Rt2[110] = Rt[35];
        Rt2[111] = Rt[36];
        Rt2[112] = Rt[37];
        Rt2[113] = Rt[40];
        Rt2[114] = Rt[41];
        Rt2[115] = Rt[44];
        Rt2[116] = Rt[55];
        Rt2[117] = Rt[56];
        Rt2[118] = Rt[59];
        Rt2[119] = Rt[69];
        Rt2[120] = -Rt[9];
        Rt2[121] = -Rt[10];
        Rt2[122] = -Rt[11];
        Rt2[123] = -Rt[12];
        Rt2[124] = -Rt[15];
        Rt2[125] = -Rt[16];
        Rt2[126] = -Rt[17];
        Rt2[127] = -Rt[20];
        Rt2[128] = -Rt[21];
        Rt2[129] = -Rt[24];
        Rt2[130] = -Rt[36];
        Rt2[131] = -Rt[37];
        Rt2[132] = -Rt[38];
        Rt2[133] = -Rt[41];
        Rt2[134] = -Rt[42];
        Rt2[135] = -Rt[45];
        Rt2[136] = -Rt[56];
        Rt2[137] = -Rt[57];
        Rt2[138] = -Rt[60];
        Rt2[139] = -Rt[70];
        Rt2[140] = Rt[13];
        Rt2[141] = Rt[14];
        Rt2[142] = Rt[15];
        Rt2[143] = Rt[16];
        Rt2[144] = Rt[18];
        Rt2[145] = Rt[19];
        Rt2[146] = Rt[20];
        Rt2[147] = Rt[22];
        Rt2[148] = Rt[23];
        Rt2[149] = Rt[25];
        Rt2[150] = Rt[39];
        Rt2[151] = Rt[40];
        Rt2[152] = Rt[41];
        Rt2[153] = Rt[43];
        Rt2[154] = Rt[44];
        Rt2[155] = Rt[46];
        Rt2[156] = Rt[58];
        Rt2[157] = Rt[59];
        Rt2[158] = Rt[61];
        Rt2[159] = Rt[71];
        Rt2[160] = -Rt[14];
        Rt2[161] = -Rt[15];
        Rt2[162] = -Rt[16];
        Rt2[163] = -Rt[17];
        Rt2[164] = -Rt[19];
        Rt2[165] = -Rt[20];
        Rt2[166] = -Rt[21];
        Rt2[167] = -Rt[23];
        Rt2[168] = -Rt[24];
        Rt2[169] = -Rt[26];
        Rt2[170] = -Rt[40];
        Rt2[171] = -Rt[41];
        Rt2[172] = -Rt[42];
        Rt2[173] = -Rt[44];
        Rt2[174] = -Rt[45];
        Rt2[175] = -Rt[47];
        Rt2[176] = -Rt[59];
        Rt2[177] = -Rt[60];
        Rt2[178] = -Rt[62];
        Rt2[179] = -Rt[72];
        Rt2[180] = -Rt[18];
        Rt2[181] = -Rt[19];
        Rt2[182] = -Rt[20];
        Rt2[183] = -Rt[21];
        Rt2[184] = -Rt[22];
        Rt2[185] = -Rt[23];
        Rt2[186] = -Rt[24];
        Rt2[187] = -Rt[25];
        Rt2[188] = -Rt[26];
        Rt2[189] = -Rt[27];
        Rt2[190] = -Rt[43];
        Rt2[191] = -Rt[44];
        Rt2[192] = -Rt[45];
        Rt2[193] = -Rt[46];
        Rt2[194] = -Rt[47];
        Rt2[195] = -Rt[48];
        Rt2[196] = -Rt[61];
        Rt2[197] = -Rt[62];
        Rt2[198] = -Rt[63];
        Rt2[199] = -Rt[73];
        Rt2[200] = -Rt[28];
        Rt2[201] = -Rt[29];
        Rt2[202] = -Rt[30];
        Rt2[203] = -Rt[31];
        Rt2[204] = -Rt[34];
        Rt2[205] = -Rt[35];
        Rt2[206] = -Rt[36];
        Rt2[207] = -Rt[39];
        Rt2[208] = -Rt[40];
        Rt2[209] = -Rt[43];
        Rt2[210] = -Rt[49];
        Rt2[211] = -Rt[50];
        Rt2[212] = -Rt[51];
        Rt2[213] = -Rt[54];
        Rt2[214] = -Rt[55];
        Rt2[215] = -Rt[58];
        Rt2[216] = -Rt[64];
        Rt2[217] = -Rt[65];
        Rt2[218] = -Rt[68];
        Rt2[219] = -Rt[74];
        Rt2[220] = Rt[29];
        Rt2[221] = Rt[30];
        Rt2[222] = Rt[31];
        Rt2[223] = Rt[32];
        Rt2[224] = Rt[35];
        Rt2[225] = Rt[36];
        Rt2[226] = Rt[37];
        Rt2[227] = Rt[40];
        Rt2[228] = Rt[41];
        Rt2[229] = Rt[44];
        Rt2[230] = Rt[50];
        Rt2[231] = Rt[51];
        Rt2[232] = Rt[52];
        Rt2[233] = Rt[55];
        Rt2[234] = Rt[56];
        Rt2[235] = Rt[59];
        Rt2[236] = Rt[65];
        Rt2[237] = Rt[66];
        Rt2[238] = Rt[69];
        Rt2[239] = Rt[75];
        Rt2[240] = -Rt[30];
        Rt2[241] = -Rt[31];
        Rt2[242] = -Rt[32];
        Rt2[243] = -Rt[33];
        Rt2[244] = -Rt[36];
        Rt2[245] = -Rt[37];
        Rt2[246] = -Rt[38];
        Rt2[247] = -Rt[41];
        Rt2[248] = -Rt[42];
        Rt2[249] = -Rt[45];
        Rt2[250] = -Rt[51];
        Rt2[251] = -Rt[52];
        Rt2[252] = -Rt[53];
        Rt2[253] = -Rt[56];
        Rt2[254] = -Rt[57];
        Rt2[255] = -Rt[60];
        Rt2[256] = -Rt[66];
        Rt2[257] = -Rt[67];
        Rt2[258] = -Rt[70];
        Rt2[259] = -Rt[76];
        Rt2[260] = Rt[34];
        Rt2[261] = Rt[35];
        Rt2[262] = Rt[36];
        Rt2[263] = Rt[37];
        Rt2[264] = Rt[39];
        Rt2[265] = Rt[40];
        Rt2[266] = Rt[41];
        Rt2[267] = Rt[43];
        Rt2[268] = Rt[44];
        Rt2[269] = Rt[46];
        Rt2[270] = Rt[54];
        Rt2[271] = Rt[55];
        Rt2[272] = Rt[56];
        Rt2[273] = Rt[58];
        Rt2[274] = Rt[59];
        Rt2[275] = Rt[61];
        Rt2[276] = Rt[68];
        Rt2[277] = Rt[69];
        Rt2[278] = Rt[71];
        Rt2[279] = Rt[77];
        Rt2[280] = -Rt[35];
        Rt2[281] = -Rt[36];
        Rt2[282] = -Rt[37];
        Rt2[283] = -Rt[38];
        Rt2[284] = -Rt[40];
        Rt2[285] = -Rt[41];
        Rt2[286] = -Rt[42];
        Rt2[287] = -Rt[44];
        Rt2[288] = -Rt[45];
        Rt2[289] = -Rt[47];
        Rt2[290] = -Rt[55];
        Rt2[291] = -Rt[56];
        Rt2[292] = -Rt[57];
        Rt2[293] = -Rt[59];
        Rt2[294] = -Rt[60];
        Rt2[295] = -Rt[62];
        Rt2[296] = -Rt[69];
        Rt2[297] = -Rt[70];
        Rt2[298] = -Rt[72];
        Rt2[299] = -Rt[78];
        Rt2[300] = -Rt[39];
        Rt2[301] = -Rt[40];
        Rt2[302] = -Rt[41];
        Rt2[303] = -Rt[42];
        Rt2[304] = -Rt[43];
        Rt2[305] = -Rt[44];
        Rt2[306] = -Rt[45];
        Rt2[307] = -Rt[46];
        Rt2[308] = -Rt[47];
        Rt2[309] = -Rt[48];
        Rt2[310] = -Rt[58];
        Rt2[311] = -Rt[59];
        Rt2[312] = -Rt[60];
        Rt2[313] = -Rt[61];
        Rt2[314] = -Rt[62];
        Rt2[315] = -Rt[63];
        Rt2[316] = -Rt[71];
        Rt2[317] = -Rt[72];
        Rt2[318] = -Rt[73];
        Rt2[319] = -Rt[79];
        Rt2[320] = Rt[49];
        Rt2[321] = Rt[50];
        Rt2[322] = Rt[51];
        Rt2[323] = Rt[52];
        Rt2[324] = Rt[54];
        Rt2[325] = Rt[55];
        Rt2[326] = Rt[56];
        Rt2[327] = Rt[58];
        Rt2[328] = Rt[59];
        Rt2[329] = Rt[61];
        Rt2[330] = Rt[64];
        Rt2[331] = Rt[65];
        Rt2[332] = Rt[66];
        Rt2[333] = Rt[68];
        Rt2[334] = Rt[69];
        Rt2[335] = Rt[71];
        Rt2[336] = Rt[74];
        Rt2[337] = Rt[75];
        Rt2[338] = Rt[77];
        Rt2[339] = Rt[80];
        Rt2[340] = -Rt[50];
        Rt2[341] = -Rt[51];
        Rt2[342] = -Rt[52];
        Rt2[343] = -Rt[53];
        Rt2[344] = -Rt[55];
        Rt2[345] = -Rt[56];
        Rt2[346] = -Rt[57];
        Rt2[347] = -Rt[59];
        Rt2[348] = -Rt[60];
        Rt2[349] = -Rt[62];
        Rt2[350] = -Rt[65];
        Rt2[351] = -Rt[66];
        Rt2[352] = -Rt[67];
        Rt2[353] = -Rt[69];
        Rt2[354] = -Rt[70];
        Rt2[355] = -Rt[72];
        Rt2[356] = -Rt[75];
        Rt2[357] = -Rt[76];
        Rt2[358] = -Rt[78];
        Rt2[359] = -Rt[81];
        Rt2[360] = -Rt[54];
        Rt2[361] = -Rt[55];
        Rt2[362] = -Rt[56];
        Rt2[363] = -Rt[57];
        Rt2[364] = -Rt[58];
        Rt2[365] = -Rt[59];
        Rt2[366] = -Rt[60];
        Rt2[367] = -Rt[61];
        Rt2[368] = -Rt[62];
        Rt2[369] = -Rt[63];
        Rt2[370] = -Rt[68];
        Rt2[371] = -Rt[69];
        Rt2[372] = -Rt[70];
        Rt2[373] = -Rt[71];
        Rt2[374] = -Rt[72];
        Rt2[375] = -Rt[73];
        Rt2[376] = -Rt[77];
        Rt2[377] = -Rt[78];
        Rt2[378] = -Rt[79];
        Rt2[379] = -Rt[82];
        Rt2[380] = -Rt[64];
        Rt2[381] = -Rt[65];
        Rt2[382] = -Rt[66];
        Rt2[383] = -Rt[67];
        Rt2[384] = -Rt[68];
        Rt2[385] = -Rt[69];
        Rt2[386] = -Rt[70];
        Rt2[387] = -Rt[71];
        Rt2[388] = -Rt[72];
        Rt2[389] = -Rt[73];
        Rt2[390] = -Rt[74];
        Rt2[391] = -Rt[75];
        Rt2[392] = -Rt[76];
        Rt2[393] = -Rt[77];
        Rt2[394] = -Rt[78];
        Rt2[395] = -Rt[79];
        Rt2[396] = -Rt[80];
        Rt2[397] = -Rt[81];
        Rt2[398] = -Rt[82];
        Rt2[399] = -Rt[83];
}

/*
int get_Rt2(double *Rt2, int l1, int l2, double a, double fac, double *rpq,
            double *buf)
{
        int l = l1 + l2;
        int info = get_R_tensor(buf, l, a, fac, rpq, Rt2);
        int lll = (l+1)*(l+2)*(l+3)/6;
        int nf2 = (l2+1)*(l2+2)*(l2+3)/6;
        int e, f, g, t, u, v;
        int i, j;
        for (i = 0, e = 0; e <= l1; e++) {
        for (f = 0; f <= l1-e; f++) {
        for (g = 0; g <= l1-e-f; g++, i++) {
                if ((e + f + g) % 2 == 0) {
                        for (j = 0, t = 0; t <= l2; t++) {
                        for (u = 0; u <= l2-t; u++) {
                        for (v = 0; v <= l2-t-u; v++, j++) {
                                Rt2[i*nf2+j] = buf[ADDR(l,e+t,u+f,v+g)];
                        } } }
                } else {
                        for (j = 0, t = 0; t <= l2; t++) {
                        for (u = 0; u <= l2-t; u++) {
                        for (v = 0; v <= l2-t-u; v++, j++) {
                                Rt2[i*nf2+j] = -buf[ADDR(l,e+t,u+f,v+g)];
                        } } }
                }
        } } }
        return info;
}
*/

void get_Rt2(double *Rt2, int l1, int l2, double a, double fac, double *rpq,
             double *buf)
{
        switch (l1*LMAX*2+l2) {
        case (0*LMAX*2+0): return Rt2_0_0(Rt2, a, fac, rpq, buf);
        case (0*LMAX*2+1): return Rt2_0_1(Rt2, a, fac, rpq, buf);
        case (0*LMAX*2+2): return Rt2_0_2(Rt2, a, fac, rpq, buf);
        case (0*LMAX*2+3): return Rt2_0_3(Rt2, a, fac, rpq, buf);
        case (1*LMAX*2+0): return Rt2_1_0(Rt2, a, fac, rpq, buf);
        case (1*LMAX*2+1): return Rt2_1_1(Rt2, a, fac, rpq, buf);
        case (1*LMAX*2+2): return Rt2_1_2(Rt2, a, fac, rpq, buf);
        case (1*LMAX*2+3): return Rt2_1_3(Rt2, a, fac, rpq, buf);
        case (2*LMAX*2+0): return Rt2_2_0(Rt2, a, fac, rpq, buf);
        case (2*LMAX*2+1): return Rt2_2_1(Rt2, a, fac, rpq, buf);
        case (2*LMAX*2+2): return Rt2_2_2(Rt2, a, fac, rpq, buf);
        case (2*LMAX*2+3): return Rt2_2_3(Rt2, a, fac, rpq, buf);
        case (3*LMAX*2+0): return Rt2_3_0(Rt2, a, fac, rpq, buf);
        case (3*LMAX*2+1): return Rt2_3_1(Rt2, a, fac, rpq, buf);
        case (3*LMAX*2+2): return Rt2_3_2(Rt2, a, fac, rpq, buf);
        case (3*LMAX*2+3): return Rt2_3_3(Rt2, a, fac, rpq, buf);
        }

        int l = l1 + l2;
        get_R_tensor(Rt2, l, a, fac, rpq, buf);
        if (l1 == 0) {
                return;
        }
        int e, f, g, t, u, v, n;
        if (l2 == 0) {
                for (n = 0, e = 0; e <= l1; e++) {
                for (f = 0; f <= l1-e; f++) {
                for (g = 0; g <= l1-e-f; g++, n++) {
                        if ((e + f + g) % 2 == 1) {
                                Rt2[n] = -Rt2[n];
                        }
                } } }
                return;
        }

        int stride_l = (l+1);
        int stride_ll = stride_l * (l+1);
        double *Rsub;
        for (n = 0, t = 0; t <= l; t++) {
                Rsub = buf + t*stride_ll;
                for (u = 0; u <= l-t; u++) {
#pragma GCC ivdep
                for (v = 0; v <= l-t-u; v++, n++) {
                        Rsub[u*stride_l+v] = Rt2[n];
                } }
        }

        for (n = 0, e = 0; e <= l1; e++) {
        for (f = 0; f <= l1-e; f++) {
        for (g = 0; g <= l1-e-f; g++) {
                if ((e + f + g) % 2 == 0) {
                        for (t = 0; t <= l2; t++) {
                                Rsub = buf + (e+t)*stride_ll + f*stride_l + g;
                                for (u = 0; u <= l2-t; u++) {
#pragma GCC ivdep
                                for (v = 0; v <= l2-t-u; v++, n++) {
                                        Rt2[n] = Rsub[u*stride_l+v];
                                } }
                        }
                } else {
                        for (t = 0; t <= l2; t++) {
                                Rsub = buf + (e+t)*stride_ll + f*stride_l + g;
                                for (u = 0; u <= l2-t; u++) {
#pragma GCC ivdep
                                for (v = 0; v <= l2-t-u; v++, n++) {
                                        Rt2[n] = -Rsub[u*stride_l+v];
                                } }
                        }
                }
        } } }
        return;
}

#define Ex_at(i,j,t)    Ex[(i)*stride1+(j)*stride2+t]
#define Ey_at(i,j,t)    Ey[(i)*stride1+(j)*stride2+t]
#define Ez_at(i,j,t)    Ez[(i)*stride1+(j)*stride2+t]

void get_E_cart_components(double *Ecart, int li, int lj, double ai, double aj,
                           double *Ra, double *Rb)
{
        double aij = ai + aj;
        double xixj = Ra[0] - Rb[0];
        double yiyj = Ra[1] - Rb[1];
        double zizj = Ra[2] - Rb[2];
        double theta_ij = ai * aj / aij;
        double Kab = exp(-theta_ij * (xixj*xixj + yiyj*yiyj + zizj*zizj));
        double Xp = (ai * Ra[0] + aj * Rb[0]) / aij;
        double Yp = (ai * Ra[1] + aj * Rb[1]) / aij;
        double Zp = (ai * Ra[2] + aj * Rb[2]) / aij;
        double Xpa = Xp - Ra[0];
        double Ypa = Yp - Ra[1];
        double Zpa = Zp - Ra[2];
        double Xpb = Xp - Rb[0];
        double Ypb = Yp - Rb[1];
        double Zpb = Zp - Rb[2];
        int lij = li + lj;
        int stride2 = lij+1;
        int stride1 = (lj+1) * stride2;
        int Ex_size = (li+1) * stride1;
        double *Ex = Ecart;
        double *Ey = Ex + Ex_size;
        double *Ez = Ey + Ex_size;
        int i, j, t;
        double fac, fac1;

        Ex_at(0,0,0) = 1.;
        Ey_at(0,0,0) = 1.;
        Ez_at(0,0,0) = Kab;
        for (t = 1; t <= lij; t++) {
                Ex_at(0,0,t) = 0.;
                Ey_at(0,0,t) = 0.;
                Ez_at(0,0,t) = 0.;
        }

        for (j = 1; j <= lj; j++) {
                Ex_at(0,j,0) = Xpb * Ex_at(0,j-1,0) + Ex_at(0,j-1,1);
                Ey_at(0,j,0) = Ypb * Ey_at(0,j-1,0) + Ey_at(0,j-1,1);
                Ez_at(0,j,0) = Zpb * Ez_at(0,j-1,0) + Ez_at(0,j-1,1);
                for (t = 1; t <= lij; t++) {
                        fac = j/(2*aij*t);
                        Ex_at(0,j,t) = fac * Ex_at(0,j-1,t-1);
                        Ey_at(0,j,t) = fac * Ey_at(0,j-1,t-1);
                        Ez_at(0,j,t) = fac * Ez_at(0,j-1,t-1);
                }
        }

        for (i = 1; i <= li; i++) {
                Ex_at(i,0,0) = Xpa * Ex_at(i-1,0,0) + Ex_at(i-1,0,1);
                Ey_at(i,0,0) = Ypa * Ey_at(i-1,0,0) + Ey_at(i-1,0,1);
                Ez_at(i,0,0) = Zpa * Ez_at(i-1,0,0) + Ez_at(i-1,0,1);
                for (t = 1; t <= lij; t++) {
                        fac = i/(2*aij*t);
                        Ex_at(i,0,t) = fac * Ex_at(i-1,0,t-1);
                        Ey_at(i,0,t) = fac * Ey_at(i-1,0,t-1);
                        Ez_at(i,0,t) = fac * Ez_at(i-1,0,t-1);
                }
        }

        for (i = 1; i <= li; i++) {
                for (j = 1; j <= lj; j++) {
                        Ex_at(i,j,0) = Xpb * Ex_at(i,j-1,0) + Ex_at(i,j-1,1);
                        Ey_at(i,j,0) = Ypb * Ey_at(i,j-1,0) + Ey_at(i,j-1,1);
                        Ez_at(i,j,0) = Zpb * Ez_at(i,j-1,0) + Ez_at(i,j-1,1);
                        for (t = 1; t <= lij; t++) {
                                fac = i/(2*aij*t);
                                fac1 = j/(2*aij*t);
                                Ex_at(i,j,t) = fac*Ex_at(i-1,j,t-1) + fac1*Ex_at(i,j-1,t-1);
                                Ey_at(i,j,t) = fac*Ey_at(i-1,j,t-1) + fac1*Ey_at(i,j-1,t-1);
                                Ez_at(i,j,t) = fac*Ez_at(i-1,j,t-1) + fac1*Ez_at(i,j-1,t-1);
                        }
                }
        }
}

// Shape of E tensor is [:li+lj,:li,:lj]
void get_E_tensor(double *Et, int li, int lj, double ai, double aj,
                  double *Ra, double *Rb, double *buf)
{
        get_E_cart_components(buf, li, lj, ai, aj, Ra, Rb);
        int lij = li + lj;
        int stride2 = lij+1;
        int stride1 = (lj+1) * stride2;
        int Ex_size = (li+1) * stride1;
        double *Ex = buf;
        double *Ey = Ex + Ex_size;
        double *Ez = Ey + Ex_size;
        int t, u, v, n;
        int ix, iy, iz;
        int jx, jy, jz;

        n = 0;
        // products subject to t+u+v <= li+lj
        for (t = 0; t <= lij; t++) {
        for (u = 0; u <= lij-t; u++) {
        for (v = 0; v <= lij-t-u; v++) {
                for (ix = li; ix >= 0; ix--) {
                for (iy = li-ix; iy >= 0; iy--) {
                        iz = li - ix - iy;
                        for (jx = lj; jx >= 0; jx--) {
                        for (jy = lj-jx; jy >= 0; jy--) {
                                jz = lj - jx - jy;
                                Et[n] = Ex_at(ix,jx,t) * Ey_at(iy,jy,u) * Ez_at(iz,jz,v);
                                n++;
                        } }
                } }
        } } }
}

#ifdef SIMDD
void eval_boys_simd(__MD *Rt, int l, __MD a, __MD fac, __MD *rpq);

static void iter_Rt_1_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz)
{
        out[1] = rz * Rt[0];
        out[2] = ry * Rt[0];
        out[3] = rx * Rt[0];
}

static void iter_Rt_2_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = ry * Rt[0];
        out[4] = ry * Rt[1];
        out[5] = ry * Rt[2] + Rt[0];
        out[6] = rx * Rt[0];
        out[7] = rx * Rt[1];
        out[8] = rx * Rt[2];
        out[9] = rx * Rt[3] + Rt[0];
}

static void iter_Rt_3_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = ry * Rt[0];
        out[5] = ry * Rt[1];
        out[6] = ry * Rt[2];
        out[7] = ry * Rt[3] + Rt[0];
        out[8] = ry * Rt[4] + Rt[1];
        out[9] = ry * Rt[5] + 2 * Rt[3];
        out[10] = rx * Rt[0];
        out[11] = rx * Rt[1];
        out[12] = rx * Rt[2];
        out[13] = rx * Rt[3];
        out[14] = rx * Rt[4];
        out[15] = rx * Rt[5];
        out[16] = rx * Rt[6] + Rt[0];
        out[17] = rx * Rt[7] + Rt[1];
        out[18] = rx * Rt[8] + Rt[3];
        out[19] = rx * Rt[9] + 2 * Rt[6];
}

static void iter_Rt_4_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = rz * Rt[3] + 3 * Rt[2];
        out[5] = ry * Rt[0];
        out[6] = ry * Rt[1];
        out[7] = ry * Rt[2];
        out[8] = ry * Rt[3];
        out[9] = ry * Rt[4] + Rt[0];
        out[10] = ry * Rt[5] + Rt[1];
        out[11] = ry * Rt[6] + Rt[2];
        out[12] = ry * Rt[7] + 2 * Rt[4];
        out[13] = ry * Rt[8] + 2 * Rt[5];
        out[14] = ry * Rt[9] + 3 * Rt[7];
        out[15] = rx * Rt[0];
        out[16] = rx * Rt[1];
        out[17] = rx * Rt[2];
        out[18] = rx * Rt[3];
        out[19] = rx * Rt[4];
        out[20] = rx * Rt[5];
        out[21] = rx * Rt[6];
        out[22] = rx * Rt[7];
        out[23] = rx * Rt[8];
        out[24] = rx * Rt[9];
        out[25] = rx * Rt[10] + Rt[0];
        out[26] = rx * Rt[11] + Rt[1];
        out[27] = rx * Rt[12] + Rt[2];
        out[28] = rx * Rt[13] + Rt[4];
        out[29] = rx * Rt[14] + Rt[5];
        out[30] = rx * Rt[15] + Rt[7];
        out[31] = rx * Rt[16] + 2 * Rt[10];
        out[32] = rx * Rt[17] + 2 * Rt[11];
        out[33] = rx * Rt[18] + 2 * Rt[13];
        out[34] = rx * Rt[19] + 3 * Rt[16];
}

static void iter_Rt_5_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = rz * Rt[3] + 3 * Rt[2];
        out[5] = rz * Rt[4] + 4 * Rt[3];
        out[6] = ry * Rt[0];
        out[7] = ry * Rt[1];
        out[8] = ry * Rt[2];
        out[9] = ry * Rt[3];
        out[10] = ry * Rt[4];
        out[11] = ry * Rt[5] + Rt[0];
        out[12] = ry * Rt[6] + Rt[1];
        out[13] = ry * Rt[7] + Rt[2];
        out[14] = ry * Rt[8] + Rt[3];
        out[15] = ry * Rt[9] + 2 * Rt[5];
        out[16] = ry * Rt[10] + 2 * Rt[6];
        out[17] = ry * Rt[11] + 2 * Rt[7];
        out[18] = ry * Rt[12] + 3 * Rt[9];
        out[19] = ry * Rt[13] + 3 * Rt[10];
        out[20] = ry * Rt[14] + 4 * Rt[12];
        out[21] = rx * Rt[0];
        out[22] = rx * Rt[1];
        out[23] = rx * Rt[2];
        out[24] = rx * Rt[3];
        out[25] = rx * Rt[4];
        out[26] = rx * Rt[5];
        out[27] = rx * Rt[6];
        out[28] = rx * Rt[7];
        out[29] = rx * Rt[8];
        out[30] = rx * Rt[9];
        out[31] = rx * Rt[10];
        out[32] = rx * Rt[11];
        out[33] = rx * Rt[12];
        out[34] = rx * Rt[13];
        out[35] = rx * Rt[14];
        out[36] = rx * Rt[15] + Rt[0];
        out[37] = rx * Rt[16] + Rt[1];
        out[38] = rx * Rt[17] + Rt[2];
        out[39] = rx * Rt[18] + Rt[3];
        out[40] = rx * Rt[19] + Rt[5];
        out[41] = rx * Rt[20] + Rt[6];
        out[42] = rx * Rt[21] + Rt[7];
        out[43] = rx * Rt[22] + Rt[9];
        out[44] = rx * Rt[23] + Rt[10];
        out[45] = rx * Rt[24] + Rt[12];
        out[46] = rx * Rt[25] + 2 * Rt[15];
        out[47] = rx * Rt[26] + 2 * Rt[16];
        out[48] = rx * Rt[27] + 2 * Rt[17];
        out[49] = rx * Rt[28] + 2 * Rt[19];
        out[50] = rx * Rt[29] + 2 * Rt[20];
        out[51] = rx * Rt[30] + 2 * Rt[22];
        out[52] = rx * Rt[31] + 3 * Rt[25];
        out[53] = rx * Rt[32] + 3 * Rt[26];
        out[54] = rx * Rt[33] + 3 * Rt[28];
        out[55] = rx * Rt[34] + 4 * Rt[31];
}

static void iter_Rt_6_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz)
{
        out[1] = rz * Rt[0];
        out[2] = rz * Rt[1] + Rt[0];
        out[3] = rz * Rt[2] + 2 * Rt[1];
        out[4] = rz * Rt[3] + 3 * Rt[2];
        out[5] = rz * Rt[4] + 4 * Rt[3];
        out[6] = rz * Rt[5] + 5 * Rt[4];
        out[7] = ry * Rt[0];
        out[8] = ry * Rt[1];
        out[9] = ry * Rt[2];
        out[10] = ry * Rt[3];
        out[11] = ry * Rt[4];
        out[12] = ry * Rt[5];
        out[13] = ry * Rt[6] + Rt[0];
        out[14] = ry * Rt[7] + Rt[1];
        out[15] = ry * Rt[8] + Rt[2];
        out[16] = ry * Rt[9] + Rt[3];
        out[17] = ry * Rt[10] + Rt[4];
        out[18] = ry * Rt[11] + 2 * Rt[6];
        out[19] = ry * Rt[12] + 2 * Rt[7];
        out[20] = ry * Rt[13] + 2 * Rt[8];
        out[21] = ry * Rt[14] + 2 * Rt[9];
        out[22] = ry * Rt[15] + 3 * Rt[11];
        out[23] = ry * Rt[16] + 3 * Rt[12];
        out[24] = ry * Rt[17] + 3 * Rt[13];
        out[25] = ry * Rt[18] + 4 * Rt[15];
        out[26] = ry * Rt[19] + 4 * Rt[16];
        out[27] = ry * Rt[20] + 5 * Rt[18];
        out[28] = rx * Rt[0];
        out[29] = rx * Rt[1];
        out[30] = rx * Rt[2];
        out[31] = rx * Rt[3];
        out[32] = rx * Rt[4];
        out[33] = rx * Rt[5];
        out[34] = rx * Rt[6];
        out[35] = rx * Rt[7];
        out[36] = rx * Rt[8];
        out[37] = rx * Rt[9];
        out[38] = rx * Rt[10];
        out[39] = rx * Rt[11];
        out[40] = rx * Rt[12];
        out[41] = rx * Rt[13];
        out[42] = rx * Rt[14];
        out[43] = rx * Rt[15];
        out[44] = rx * Rt[16];
        out[45] = rx * Rt[17];
        out[46] = rx * Rt[18];
        out[47] = rx * Rt[19];
        out[48] = rx * Rt[20];
        out[49] = rx * Rt[21] + Rt[0];
        out[50] = rx * Rt[22] + Rt[1];
        out[51] = rx * Rt[23] + Rt[2];
        out[52] = rx * Rt[24] + Rt[3];
        out[53] = rx * Rt[25] + Rt[4];
        out[54] = rx * Rt[26] + Rt[6];
        out[55] = rx * Rt[27] + Rt[7];
        out[56] = rx * Rt[28] + Rt[8];
        out[57] = rx * Rt[29] + Rt[9];
        out[58] = rx * Rt[30] + Rt[11];
        out[59] = rx * Rt[31] + Rt[12];
        out[60] = rx * Rt[32] + Rt[13];
        out[61] = rx * Rt[33] + Rt[15];
        out[62] = rx * Rt[34] + Rt[16];
        out[63] = rx * Rt[35] + Rt[18];
        out[64] = rx * Rt[36] + 2 * Rt[21];
        out[65] = rx * Rt[37] + 2 * Rt[22];
        out[66] = rx * Rt[38] + 2 * Rt[23];
        out[67] = rx * Rt[39] + 2 * Rt[24];
        out[68] = rx * Rt[40] + 2 * Rt[26];
        out[69] = rx * Rt[41] + 2 * Rt[27];
        out[70] = rx * Rt[42] + 2 * Rt[28];
        out[71] = rx * Rt[43] + 2 * Rt[30];
        out[72] = rx * Rt[44] + 2 * Rt[31];
        out[73] = rx * Rt[45] + 2 * Rt[33];
        out[74] = rx * Rt[46] + 3 * Rt[36];
        out[75] = rx * Rt[47] + 3 * Rt[37];
        out[76] = rx * Rt[48] + 3 * Rt[38];
        out[77] = rx * Rt[49] + 3 * Rt[40];
        out[78] = rx * Rt[50] + 3 * Rt[41];
        out[79] = rx * Rt[51] + 3 * Rt[43];
        out[80] = rx * Rt[52] + 4 * Rt[46];
        out[81] = rx * Rt[53] + 4 * Rt[47];
        out[82] = rx * Rt[54] + 4 * Rt[49];
        out[83] = rx * Rt[55] + 5 * Rt[52];
}

static void iter_Rt_n_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz , int l)
{
        out++;
        int *p1 = Rt_idx + Rt_idx_offsets[l];
        int t, u, v, i, k;
        k = 0;
        i = 0;
#pragma GCC ivdep
        for (v = 0; v < l; v++) {
                out[k] = rz * Rt[i] + v * Rt[p1[k]];
                k++; i++;
        }
        i = 0;
        for (u = 0; u < l; u++) {
#pragma GCC ivdep
        for (v = 0; v < l-u; v++) {
                out[k] = ry * Rt[i] + u * Rt[p1[k]];
                k++; i++;
        } }
        i = 0;
        for (t = 0; t < l; t++) {
                // corresponding to the nested loops
                // for (u = 0; u < l-t; u++) for (v = 0; v < l-t-u; v++)
                int uv;
#pragma GCC ivdep
                for (uv = 0; uv < (l-t) * (l-t+1) / 2; uv++) {
                        out[k] = rx * Rt[i] + t * Rt[p1[k]];
                        k++; i++;
                }
        }
}

#define ADDR(l, t, u, v) \
        (lll - ((l)-(t)+1)*((l)-(t)+2)*((l)-(t)+3)/6 + \
         ((l)-(t)+1)*((l)-(t)+2)/2 - ((l)-(t)-(u)+1)*((l)-(t)-(u)+2)/2 + (v))
#define ADDR1(l, t, u, v) \
        (lll1 - ((l)-(t)+1)*((l)-(t)+2)*((l)-(t)+3)/6 + \
         ((l)-(t)+1)*((l)-(t)+2)/2 - ((l)-(t)-(u)+1)*((l)-(t)-(u)+2)/2 + (v))

static void iter_Rt_iter_simd(__MD *out, __MD *Rt, __MD rx, __MD ry, __MD rz, int l)
{
        int l1 = l - 1;
        int lll1 = (l1+1)*(l1+2)*(l1+3)/6;
        out++;
        int t, u, v, i, k;
        k = 0;
        i = 0;
        out[k] = rz * Rt[i]; // v = 0
        k++; i++;
        for (v = 1; v < l; v++) {
                out[k] = rz * Rt[i] + v * Rt[ADDR1(l1,0,0,v-1)];
                k++; i++;
        }
        i = 0;
        for (v = 0; v < l; v++) { // u = 0
                out[k] = ry * Rt[i];
                k++; i++;
        }
        for (u = 1; u < l; u++) {
        for (v = 0; v < l-u; v++) {
                out[k] = ry * Rt[i] + u * Rt[ADDR1(l1,0,u-1,v)];
                k++; i++;
        } }
        i = 0;
        for (u = 0; u < l; u++) { // t = 0;
        for (v = 0; v < l-u; v++) {
                out[k] = rx * Rt[i];
                k++; i++;
        } }
        for (t = 1; t < l; t++) {
                for (u = 0; u < l-t; u++) {
                for (v = 0; v < l-t-u; v++) {
                        out[k] = rx * Rt[i] + t * Rt[ADDR1(l1,t-1,u,v)];
                        k++; i++;
                } }
        }
}

int get_R_tensor_simd(__MD *Rt, int l, __MD a, __MD fac, __MD *rpq, __MD *buf)
{
        if (l > LSUM_MAX) {
                return -1;
        }
        if (l == 0) {
                eval_boys_simd(Rt, l, a, fac, rpq);
                return 0;
        }

        __MD boys[LSUM_MAX+1];
        eval_boys_simd(boys, l, a, fac, rpq);
        __MD rx = rpq[0];
        __MD ry = rpq[1];
        __MD rz = rpq[2];
        if (l == 1) {
                Rt[0] = boys[0];
                iter_Rt_1_simd(Rt, boys+1, rx, ry, rz);
                return 0;
        }

        __MD *tmp;
        if (l % 2 == 0) {
                tmp = buf;
                buf = Rt;
                Rt = tmp;
        }
        buf[0] = boys[l];

        for (int n = 1; n <= l; n++) {
                Rt[0] = boys[l-n];
                switch (n) {
                case 1: iter_Rt_1_simd(Rt, buf, rx, ry, rz); break;
                case 2: iter_Rt_2_simd(Rt, buf, rx, ry, rz); break;
                case 3: iter_Rt_3_simd(Rt, buf, rx, ry, rz); break;
                case 4: iter_Rt_4_simd(Rt, buf, rx, ry, rz); break;
                case 5: iter_Rt_5_simd(Rt, buf, rx, ry, rz); break;
                case 6: iter_Rt_6_simd(Rt, buf, rx, ry, rz); break;
                default:
                        if (n <= RTIDX_MAX) {
                                iter_Rt_n_simd(Rt, buf, rx, ry, rz, n);
                        } else {
                                iter_Rt_iter_simd(Rt, buf, rx, ry, rz, n);
                        }
                }
                // swap input and output
                tmp = buf;
                buf = Rt;
                Rt = tmp;
        }
        return 0;
}

static void Rt2_0_0_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 0, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*1*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
}
static void Rt2_0_1_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 1, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*4*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+3, idx_Rt2, Rt[3], sizeof(double));
}
static void Rt2_0_2_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 2, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*10*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+3, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+4, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+5, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+6, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+7, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+8, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+9, idx_Rt2, Rt[9], sizeof(double));
}
static void Rt2_0_3_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 3, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*20*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+3, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+4, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+5, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+6, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+7, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+8, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+9, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+10, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+11, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+12, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+13, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+14, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+15, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+16, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+17, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+18, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+19, idx_Rt2, Rt[19], sizeof(double));
}
static void Rt2_1_0_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 1, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*1*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+1*1*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+2*1*SIMDD+0, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+3*1*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
}
static void Rt2_1_1_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 2, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*4*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+2, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+3, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+2, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+3, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+1, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+2, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+3, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+0, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+1, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+2, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+3, idx_Rt2, -Rt[9], sizeof(double));
}
static void Rt2_1_2_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 3, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*10*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+3, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+4, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+5, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+6, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+7, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+8, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+9, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+2, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+3, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+4, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+5, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+6, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+7, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+8, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+9, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+0, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+1, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+2, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+3, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+4, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+5, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+6, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+7, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+8, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+9, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+0, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+1, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+2, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+3, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+4, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+5, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+6, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+7, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+8, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+9, idx_Rt2, -Rt[19], sizeof(double));
}
static void Rt2_1_3_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 4, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*20*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+3, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+4, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+5, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+6, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+7, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+8, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+9, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+10, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+11, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+12, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+13, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+14, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+15, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+16, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+17, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+18, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+19, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+2, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+3, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+4, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+5, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+6, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+7, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+8, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+9, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+10, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+11, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+12, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+13, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+14, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+15, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+16, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+17, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+18, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+19, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+0, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+1, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+2, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+3, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+4, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+5, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+6, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+7, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+8, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+9, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+10, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+11, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+12, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+13, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+14, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+15, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+16, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+17, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+18, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+19, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+0, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+1, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+2, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+3, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+4, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+5, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+6, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+7, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+8, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+9, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+10, idx_Rt2, -Rt[25], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+11, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+12, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+13, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+14, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+15, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+16, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+17, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+18, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+19, idx_Rt2, -Rt[34], sizeof(double));
}
static void Rt2_2_0_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 2, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*1*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+1*1*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+2*1*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+3*1*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+4*1*SIMDD+0, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+5*1*SIMDD+0, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+6*1*SIMDD+0, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+7*1*SIMDD+0, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+8*1*SIMDD+0, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+9*1*SIMDD+0, idx_Rt2, Rt[9], sizeof(double));
}
static void Rt2_2_1_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 3, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*4*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+2, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+3, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+2, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+3, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+1, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+2, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+3, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+0, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+1, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+2, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+3, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+0, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+1, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+2, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+3, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+0, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+1, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+2, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+3, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+0, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+1, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+2, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+3, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+0, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+1, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+2, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+3, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+0, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+1, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+2, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+3, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+0, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+1, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+2, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+3, idx_Rt2, Rt[19], sizeof(double));
}
static void Rt2_2_2_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 4, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*10*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+3, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+4, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+5, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+6, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+7, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+8, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+9, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+2, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+3, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+4, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+5, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+6, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+7, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+8, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+9, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+1, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+2, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+3, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+4, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+5, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+6, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+7, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+8, idx_Rt2, Rt[21], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+9, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+0, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+1, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+2, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+3, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+4, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+5, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+6, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+7, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+8, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+9, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+0, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+1, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+2, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+3, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+4, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+5, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+6, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+7, idx_Rt2, Rt[21], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+8, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+9, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+0, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+1, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+2, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+3, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+4, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+5, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+6, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+7, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+8, idx_Rt2, Rt[24], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+9, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+0, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+1, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+2, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+3, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+4, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+5, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+6, idx_Rt2, -Rt[25], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+7, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+8, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+9, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+0, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+1, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+2, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+3, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+4, idx_Rt2, Rt[21], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+5, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+6, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+7, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+8, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+9, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+0, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+1, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+2, idx_Rt2, Rt[21], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+3, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+4, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+5, idx_Rt2, Rt[24], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+6, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+7, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+8, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+9, idx_Rt2, Rt[33], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+0, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+1, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+2, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+3, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+4, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+5, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+6, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+7, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+8, idx_Rt2, Rt[33], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+9, idx_Rt2, Rt[34], sizeof(double));
}
static void Rt2_2_3_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 5, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*20*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+3, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+4, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+5, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+6, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+7, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+8, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+9, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+10, idx_Rt2, Rt[21], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+11, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+12, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+13, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+14, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+15, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+16, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+17, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+18, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+19, idx_Rt2, Rt[46], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+2, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+3, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+4, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+5, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+6, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+7, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+8, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+9, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+10, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+11, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+12, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+13, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+14, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+15, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+16, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+17, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+18, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+19, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+1, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+2, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+3, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+4, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+5, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+6, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+7, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+8, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+9, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+10, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+11, idx_Rt2, Rt[24], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+12, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+13, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+14, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+15, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+16, idx_Rt2, Rt[38], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+17, idx_Rt2, Rt[39], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+18, idx_Rt2, Rt[42], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+19, idx_Rt2, Rt[48], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+0, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+1, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+2, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+3, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+4, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+5, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+6, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+7, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+8, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+9, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+10, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+11, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+12, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+13, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+14, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+15, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+16, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+17, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+18, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+19, idx_Rt2, -Rt[49], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+0, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+1, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+2, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+3, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+4, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+5, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+6, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+7, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+8, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+9, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+10, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+11, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+12, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+13, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+14, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+15, idx_Rt2, Rt[34], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+16, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+17, idx_Rt2, Rt[42], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+18, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+19, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+0, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+1, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+2, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+3, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+4, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+5, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+6, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+7, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+8, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+9, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+10, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+11, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+12, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+13, idx_Rt2, Rt[33], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+14, idx_Rt2, Rt[34], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+15, idx_Rt2, Rt[35], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+16, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+17, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+18, idx_Rt2, Rt[45], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+19, idx_Rt2, Rt[51], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+0, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+1, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+2, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+3, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+4, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+5, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+6, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+7, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+8, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+9, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+10, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+11, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+12, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+13, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+14, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+15, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+16, idx_Rt2, -Rt[46], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+17, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+18, idx_Rt2, -Rt[49], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+19, idx_Rt2, -Rt[52], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+0, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+1, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+2, idx_Rt2, Rt[24], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+3, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+4, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+5, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+6, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+7, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+8, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+9, idx_Rt2, Rt[34], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+10, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+11, idx_Rt2, Rt[38], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+12, idx_Rt2, Rt[39], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+13, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+14, idx_Rt2, Rt[42], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+15, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+16, idx_Rt2, Rt[47], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+17, idx_Rt2, Rt[48], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+18, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+19, idx_Rt2, Rt[53], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+0, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+1, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+2, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+3, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+4, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+5, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+6, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+7, idx_Rt2, Rt[33], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+8, idx_Rt2, Rt[34], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+9, idx_Rt2, Rt[35], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+10, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+11, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+12, idx_Rt2, Rt[42], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+13, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+14, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+15, idx_Rt2, Rt[45], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+16, idx_Rt2, Rt[49], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+17, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+18, idx_Rt2, Rt[51], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+19, idx_Rt2, Rt[54], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+0, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+1, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+2, idx_Rt2, Rt[38], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+3, idx_Rt2, Rt[39], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+4, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+5, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+6, idx_Rt2, Rt[42], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+7, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+8, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+9, idx_Rt2, Rt[45], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+10, idx_Rt2, Rt[46], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+11, idx_Rt2, Rt[47], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+12, idx_Rt2, Rt[48], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+13, idx_Rt2, Rt[49], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+14, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+15, idx_Rt2, Rt[51], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+16, idx_Rt2, Rt[52], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+17, idx_Rt2, Rt[53], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+18, idx_Rt2, Rt[54], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+19, idx_Rt2, Rt[55], sizeof(double));
}
static void Rt2_3_0_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 3, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*1*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+1*1*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+2*1*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+3*1*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+4*1*SIMDD+0, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+5*1*SIMDD+0, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+6*1*SIMDD+0, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+7*1*SIMDD+0, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+8*1*SIMDD+0, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+9*1*SIMDD+0, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+10*1*SIMDD+0, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+11*1*SIMDD+0, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+12*1*SIMDD+0, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+13*1*SIMDD+0, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+14*1*SIMDD+0, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+15*1*SIMDD+0, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+16*1*SIMDD+0, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+17*1*SIMDD+0, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+18*1*SIMDD+0, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+19*1*SIMDD+0, idx_Rt2, -Rt[19], sizeof(double));
}
static void Rt2_3_1_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 4, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*4*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+2, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+0*4*SIMDD+3, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+2, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+1*4*SIMDD+3, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+1, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+2, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+2*4*SIMDD+3, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+1, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+2, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+3*4*SIMDD+3, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+0, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+1, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+2, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+4*4*SIMDD+3, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+0, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+1, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+2, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+5*4*SIMDD+3, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+0, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+1, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+2, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+6*4*SIMDD+3, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+0, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+1, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+2, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+7*4*SIMDD+3, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+0, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+1, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+2, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+8*4*SIMDD+3, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+0, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+1, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+2, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+9*4*SIMDD+3, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+10*4*SIMDD+0, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+10*4*SIMDD+1, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+10*4*SIMDD+2, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+10*4*SIMDD+3, idx_Rt2, -Rt[25], sizeof(double));
        MM_SCATTER(Rt2+11*4*SIMDD+0, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+11*4*SIMDD+1, idx_Rt2, Rt[17], sizeof(double));
        MM_SCATTER(Rt2+11*4*SIMDD+2, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+11*4*SIMDD+3, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+12*4*SIMDD+0, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+12*4*SIMDD+1, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+12*4*SIMDD+2, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+12*4*SIMDD+3, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+13*4*SIMDD+0, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+13*4*SIMDD+1, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+13*4*SIMDD+2, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+13*4*SIMDD+3, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+14*4*SIMDD+0, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+14*4*SIMDD+1, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+14*4*SIMDD+2, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+14*4*SIMDD+3, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+15*4*SIMDD+0, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+15*4*SIMDD+1, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+15*4*SIMDD+2, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+15*4*SIMDD+3, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+16*4*SIMDD+0, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+16*4*SIMDD+1, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+16*4*SIMDD+2, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+16*4*SIMDD+3, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+17*4*SIMDD+0, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+17*4*SIMDD+1, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+17*4*SIMDD+2, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+17*4*SIMDD+3, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+18*4*SIMDD+0, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+18*4*SIMDD+1, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+18*4*SIMDD+2, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+18*4*SIMDD+3, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+19*4*SIMDD+0, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+19*4*SIMDD+1, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+19*4*SIMDD+2, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+19*4*SIMDD+3, idx_Rt2, -Rt[34], sizeof(double));
}
static void Rt2_3_2_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 5, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*10*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+3, idx_Rt2, Rt[6], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+4, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+5, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+6, idx_Rt2, Rt[21], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+7, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+8, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+0*10*SIMDD+9, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+2, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+3, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+4, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+5, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+6, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+7, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+8, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+1*10*SIMDD+9, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+1, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+2, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+3, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+4, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+5, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+6, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+7, idx_Rt2, Rt[24], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+8, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+2*10*SIMDD+9, idx_Rt2, Rt[38], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+1, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+2, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+3, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+4, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+5, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+6, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+7, idx_Rt2, -Rt[25], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+8, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+3*10*SIMDD+9, idx_Rt2, -Rt[39], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+0, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+1, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+2, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+3, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+4, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+5, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+6, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+7, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+8, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+4*10*SIMDD+9, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+0, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+1, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+2, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+3, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+4, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+5, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+6, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+7, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+8, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+5*10*SIMDD+9, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+0, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+1, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+2, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+3, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+4, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+5, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+6, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+7, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+8, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+6*10*SIMDD+9, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+0, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+1, idx_Rt2, Rt[12], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+2, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+3, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+4, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+5, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+6, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+7, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+8, idx_Rt2, Rt[33], sizeof(double));
        MM_SCATTER(Rt2+7*10*SIMDD+9, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+0, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+1, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+2, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+3, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+4, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+5, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+6, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+7, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+8, idx_Rt2, -Rt[34], sizeof(double));
        MM_SCATTER(Rt2+8*10*SIMDD+9, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+0, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+1, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+2, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+3, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+4, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+5, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+6, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+7, idx_Rt2, -Rt[34], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+8, idx_Rt2, -Rt[35], sizeof(double));
        MM_SCATTER(Rt2+9*10*SIMDD+9, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+0, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+1, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+2, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+3, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+4, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+5, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+6, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+7, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+8, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+10*10*SIMDD+9, idx_Rt2, -Rt[46], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+0, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+1, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+2, idx_Rt2, Rt[24], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+3, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+4, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+5, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+6, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+7, idx_Rt2, Rt[38], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+8, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+11*10*SIMDD+9, idx_Rt2, Rt[47], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+0, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+1, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+2, idx_Rt2, -Rt[25], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+3, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+4, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+5, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+6, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+7, idx_Rt2, -Rt[39], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+8, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+12*10*SIMDD+9, idx_Rt2, -Rt[48], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+0, idx_Rt2, Rt[26], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+1, idx_Rt2, Rt[27], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+2, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+3, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+4, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+5, idx_Rt2, Rt[33], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+6, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+7, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+8, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+13*10*SIMDD+9, idx_Rt2, Rt[49], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+0, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+1, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+2, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+3, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+4, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+5, idx_Rt2, -Rt[34], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+6, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+7, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+8, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+14*10*SIMDD+9, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+0, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+1, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+2, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+3, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+4, idx_Rt2, -Rt[34], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+5, idx_Rt2, -Rt[35], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+6, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+7, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+8, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+15*10*SIMDD+9, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+0, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+1, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+2, idx_Rt2, Rt[38], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+3, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+4, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+5, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+6, idx_Rt2, Rt[46], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+7, idx_Rt2, Rt[47], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+8, idx_Rt2, Rt[49], sizeof(double));
        MM_SCATTER(Rt2+16*10*SIMDD+9, idx_Rt2, Rt[52], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+0, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+1, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+2, idx_Rt2, -Rt[39], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+3, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+4, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+5, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+6, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+7, idx_Rt2, -Rt[48], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+8, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+17*10*SIMDD+9, idx_Rt2, -Rt[53], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+0, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+1, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+2, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+3, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+4, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+5, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+6, idx_Rt2, -Rt[49], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+7, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+8, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+18*10*SIMDD+9, idx_Rt2, -Rt[54], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+0, idx_Rt2, -Rt[46], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+1, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+2, idx_Rt2, -Rt[48], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+3, idx_Rt2, -Rt[49], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+4, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+5, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+6, idx_Rt2, -Rt[52], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+7, idx_Rt2, -Rt[53], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+8, idx_Rt2, -Rt[54], sizeof(double));
        MM_SCATTER(Rt2+19*10*SIMDD+9, idx_Rt2, -Rt[55], sizeof(double));
}
static void Rt2_3_3_simd(double *Rt2, __MD a, __MD fac, __MD *rpq, __MD *Rt, __MI32 idx_Rt2)
{
        get_R_tensor_simd(Rt, 6, a, fac, rpq, (__MD *)Rt2);
        MM_SCATTER(Rt2+0*20*SIMDD+0, idx_Rt2, Rt[0], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+1, idx_Rt2, Rt[1], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+2, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+3, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+4, idx_Rt2, Rt[7], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+5, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+6, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+7, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+8, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+9, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+10, idx_Rt2, Rt[28], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+11, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+12, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+13, idx_Rt2, Rt[34], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+14, idx_Rt2, Rt[35], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+15, idx_Rt2, Rt[39], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+16, idx_Rt2, Rt[49], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+17, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+18, idx_Rt2, Rt[54], sizeof(double));
        MM_SCATTER(Rt2+0*20*SIMDD+19, idx_Rt2, Rt[64], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+0, idx_Rt2, -Rt[1], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+1, idx_Rt2, -Rt[2], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+2, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+3, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+4, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+5, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+6, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+7, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+8, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+9, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+10, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+11, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+12, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+13, idx_Rt2, -Rt[35], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+14, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+15, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+16, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+17, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+18, idx_Rt2, -Rt[55], sizeof(double));
        MM_SCATTER(Rt2+1*20*SIMDD+19, idx_Rt2, -Rt[65], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+0, idx_Rt2, Rt[2], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+1, idx_Rt2, Rt[3], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+2, idx_Rt2, Rt[4], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+3, idx_Rt2, Rt[5], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+4, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+5, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+6, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+7, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+8, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+9, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+10, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+11, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+12, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+13, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+14, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+15, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+16, idx_Rt2, Rt[51], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+17, idx_Rt2, Rt[52], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+18, idx_Rt2, Rt[56], sizeof(double));
        MM_SCATTER(Rt2+2*20*SIMDD+19, idx_Rt2, Rt[66], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+0, idx_Rt2, -Rt[3], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+1, idx_Rt2, -Rt[4], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+2, idx_Rt2, -Rt[5], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+3, idx_Rt2, -Rt[6], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+4, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+5, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+6, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+7, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+8, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+9, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+10, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+11, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+12, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+13, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+14, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+15, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+16, idx_Rt2, -Rt[52], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+17, idx_Rt2, -Rt[53], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+18, idx_Rt2, -Rt[57], sizeof(double));
        MM_SCATTER(Rt2+3*20*SIMDD+19, idx_Rt2, -Rt[67], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+0, idx_Rt2, -Rt[7], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+1, idx_Rt2, -Rt[8], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+2, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+3, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+4, idx_Rt2, -Rt[13], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+5, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+6, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+7, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+8, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+9, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+10, idx_Rt2, -Rt[34], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+11, idx_Rt2, -Rt[35], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+12, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+13, idx_Rt2, -Rt[39], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+14, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+15, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+16, idx_Rt2, -Rt[54], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+17, idx_Rt2, -Rt[55], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+18, idx_Rt2, -Rt[58], sizeof(double));
        MM_SCATTER(Rt2+4*20*SIMDD+19, idx_Rt2, -Rt[68], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+0, idx_Rt2, Rt[8], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+1, idx_Rt2, Rt[9], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+2, idx_Rt2, Rt[10], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+3, idx_Rt2, Rt[11], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+4, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+5, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+6, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+7, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+8, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+9, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+10, idx_Rt2, Rt[35], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+11, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+12, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+13, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+14, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+15, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+16, idx_Rt2, Rt[55], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+17, idx_Rt2, Rt[56], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+18, idx_Rt2, Rt[59], sizeof(double));
        MM_SCATTER(Rt2+5*20*SIMDD+19, idx_Rt2, Rt[69], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+0, idx_Rt2, -Rt[9], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+1, idx_Rt2, -Rt[10], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+2, idx_Rt2, -Rt[11], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+3, idx_Rt2, -Rt[12], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+4, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+5, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+6, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+7, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+8, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+9, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+10, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+11, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+12, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+13, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+14, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+15, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+16, idx_Rt2, -Rt[56], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+17, idx_Rt2, -Rt[57], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+18, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+6*20*SIMDD+19, idx_Rt2, -Rt[70], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+0, idx_Rt2, Rt[13], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+1, idx_Rt2, Rt[14], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+2, idx_Rt2, Rt[15], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+3, idx_Rt2, Rt[16], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+4, idx_Rt2, Rt[18], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+5, idx_Rt2, Rt[19], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+6, idx_Rt2, Rt[20], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+7, idx_Rt2, Rt[22], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+8, idx_Rt2, Rt[23], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+9, idx_Rt2, Rt[25], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+10, idx_Rt2, Rt[39], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+11, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+12, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+13, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+14, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+15, idx_Rt2, Rt[46], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+16, idx_Rt2, Rt[58], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+17, idx_Rt2, Rt[59], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+18, idx_Rt2, Rt[61], sizeof(double));
        MM_SCATTER(Rt2+7*20*SIMDD+19, idx_Rt2, Rt[71], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+0, idx_Rt2, -Rt[14], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+1, idx_Rt2, -Rt[15], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+2, idx_Rt2, -Rt[16], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+3, idx_Rt2, -Rt[17], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+4, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+5, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+6, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+7, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+8, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+9, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+10, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+11, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+12, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+13, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+14, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+15, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+16, idx_Rt2, -Rt[59], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+17, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+18, idx_Rt2, -Rt[62], sizeof(double));
        MM_SCATTER(Rt2+8*20*SIMDD+19, idx_Rt2, -Rt[72], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+0, idx_Rt2, -Rt[18], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+1, idx_Rt2, -Rt[19], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+2, idx_Rt2, -Rt[20], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+3, idx_Rt2, -Rt[21], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+4, idx_Rt2, -Rt[22], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+5, idx_Rt2, -Rt[23], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+6, idx_Rt2, -Rt[24], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+7, idx_Rt2, -Rt[25], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+8, idx_Rt2, -Rt[26], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+9, idx_Rt2, -Rt[27], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+10, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+11, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+12, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+13, idx_Rt2, -Rt[46], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+14, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+15, idx_Rt2, -Rt[48], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+16, idx_Rt2, -Rt[61], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+17, idx_Rt2, -Rt[62], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+18, idx_Rt2, -Rt[63], sizeof(double));
        MM_SCATTER(Rt2+9*20*SIMDD+19, idx_Rt2, -Rt[73], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+0, idx_Rt2, -Rt[28], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+1, idx_Rt2, -Rt[29], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+2, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+3, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+4, idx_Rt2, -Rt[34], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+5, idx_Rt2, -Rt[35], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+6, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+7, idx_Rt2, -Rt[39], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+8, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+9, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+10, idx_Rt2, -Rt[49], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+11, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+12, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+13, idx_Rt2, -Rt[54], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+14, idx_Rt2, -Rt[55], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+15, idx_Rt2, -Rt[58], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+16, idx_Rt2, -Rt[64], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+17, idx_Rt2, -Rt[65], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+18, idx_Rt2, -Rt[68], sizeof(double));
        MM_SCATTER(Rt2+10*20*SIMDD+19, idx_Rt2, -Rt[74], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+0, idx_Rt2, Rt[29], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+1, idx_Rt2, Rt[30], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+2, idx_Rt2, Rt[31], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+3, idx_Rt2, Rt[32], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+4, idx_Rt2, Rt[35], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+5, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+6, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+7, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+8, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+9, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+10, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+11, idx_Rt2, Rt[51], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+12, idx_Rt2, Rt[52], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+13, idx_Rt2, Rt[55], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+14, idx_Rt2, Rt[56], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+15, idx_Rt2, Rt[59], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+16, idx_Rt2, Rt[65], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+17, idx_Rt2, Rt[66], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+18, idx_Rt2, Rt[69], sizeof(double));
        MM_SCATTER(Rt2+11*20*SIMDD+19, idx_Rt2, Rt[75], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+0, idx_Rt2, -Rt[30], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+1, idx_Rt2, -Rt[31], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+2, idx_Rt2, -Rt[32], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+3, idx_Rt2, -Rt[33], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+4, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+5, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+6, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+7, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+8, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+9, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+10, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+11, idx_Rt2, -Rt[52], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+12, idx_Rt2, -Rt[53], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+13, idx_Rt2, -Rt[56], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+14, idx_Rt2, -Rt[57], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+15, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+16, idx_Rt2, -Rt[66], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+17, idx_Rt2, -Rt[67], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+18, idx_Rt2, -Rt[70], sizeof(double));
        MM_SCATTER(Rt2+12*20*SIMDD+19, idx_Rt2, -Rt[76], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+0, idx_Rt2, Rt[34], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+1, idx_Rt2, Rt[35], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+2, idx_Rt2, Rt[36], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+3, idx_Rt2, Rt[37], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+4, idx_Rt2, Rt[39], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+5, idx_Rt2, Rt[40], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+6, idx_Rt2, Rt[41], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+7, idx_Rt2, Rt[43], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+8, idx_Rt2, Rt[44], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+9, idx_Rt2, Rt[46], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+10, idx_Rt2, Rt[54], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+11, idx_Rt2, Rt[55], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+12, idx_Rt2, Rt[56], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+13, idx_Rt2, Rt[58], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+14, idx_Rt2, Rt[59], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+15, idx_Rt2, Rt[61], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+16, idx_Rt2, Rt[68], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+17, idx_Rt2, Rt[69], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+18, idx_Rt2, Rt[71], sizeof(double));
        MM_SCATTER(Rt2+13*20*SIMDD+19, idx_Rt2, Rt[77], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+0, idx_Rt2, -Rt[35], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+1, idx_Rt2, -Rt[36], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+2, idx_Rt2, -Rt[37], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+3, idx_Rt2, -Rt[38], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+4, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+5, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+6, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+7, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+8, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+9, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+10, idx_Rt2, -Rt[55], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+11, idx_Rt2, -Rt[56], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+12, idx_Rt2, -Rt[57], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+13, idx_Rt2, -Rt[59], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+14, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+15, idx_Rt2, -Rt[62], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+16, idx_Rt2, -Rt[69], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+17, idx_Rt2, -Rt[70], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+18, idx_Rt2, -Rt[72], sizeof(double));
        MM_SCATTER(Rt2+14*20*SIMDD+19, idx_Rt2, -Rt[78], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+0, idx_Rt2, -Rt[39], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+1, idx_Rt2, -Rt[40], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+2, idx_Rt2, -Rt[41], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+3, idx_Rt2, -Rt[42], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+4, idx_Rt2, -Rt[43], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+5, idx_Rt2, -Rt[44], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+6, idx_Rt2, -Rt[45], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+7, idx_Rt2, -Rt[46], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+8, idx_Rt2, -Rt[47], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+9, idx_Rt2, -Rt[48], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+10, idx_Rt2, -Rt[58], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+11, idx_Rt2, -Rt[59], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+12, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+13, idx_Rt2, -Rt[61], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+14, idx_Rt2, -Rt[62], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+15, idx_Rt2, -Rt[63], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+16, idx_Rt2, -Rt[71], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+17, idx_Rt2, -Rt[72], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+18, idx_Rt2, -Rt[73], sizeof(double));
        MM_SCATTER(Rt2+15*20*SIMDD+19, idx_Rt2, -Rt[79], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+0, idx_Rt2, Rt[49], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+1, idx_Rt2, Rt[50], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+2, idx_Rt2, Rt[51], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+3, idx_Rt2, Rt[52], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+4, idx_Rt2, Rt[54], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+5, idx_Rt2, Rt[55], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+6, idx_Rt2, Rt[56], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+7, idx_Rt2, Rt[58], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+8, idx_Rt2, Rt[59], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+9, idx_Rt2, Rt[61], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+10, idx_Rt2, Rt[64], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+11, idx_Rt2, Rt[65], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+12, idx_Rt2, Rt[66], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+13, idx_Rt2, Rt[68], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+14, idx_Rt2, Rt[69], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+15, idx_Rt2, Rt[71], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+16, idx_Rt2, Rt[74], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+17, idx_Rt2, Rt[75], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+18, idx_Rt2, Rt[77], sizeof(double));
        MM_SCATTER(Rt2+16*20*SIMDD+19, idx_Rt2, Rt[80], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+0, idx_Rt2, -Rt[50], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+1, idx_Rt2, -Rt[51], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+2, idx_Rt2, -Rt[52], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+3, idx_Rt2, -Rt[53], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+4, idx_Rt2, -Rt[55], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+5, idx_Rt2, -Rt[56], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+6, idx_Rt2, -Rt[57], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+7, idx_Rt2, -Rt[59], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+8, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+9, idx_Rt2, -Rt[62], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+10, idx_Rt2, -Rt[65], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+11, idx_Rt2, -Rt[66], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+12, idx_Rt2, -Rt[67], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+13, idx_Rt2, -Rt[69], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+14, idx_Rt2, -Rt[70], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+15, idx_Rt2, -Rt[72], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+16, idx_Rt2, -Rt[75], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+17, idx_Rt2, -Rt[76], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+18, idx_Rt2, -Rt[78], sizeof(double));
        MM_SCATTER(Rt2+17*20*SIMDD+19, idx_Rt2, -Rt[81], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+0, idx_Rt2, -Rt[54], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+1, idx_Rt2, -Rt[55], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+2, idx_Rt2, -Rt[56], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+3, idx_Rt2, -Rt[57], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+4, idx_Rt2, -Rt[58], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+5, idx_Rt2, -Rt[59], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+6, idx_Rt2, -Rt[60], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+7, idx_Rt2, -Rt[61], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+8, idx_Rt2, -Rt[62], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+9, idx_Rt2, -Rt[63], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+10, idx_Rt2, -Rt[68], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+11, idx_Rt2, -Rt[69], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+12, idx_Rt2, -Rt[70], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+13, idx_Rt2, -Rt[71], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+14, idx_Rt2, -Rt[72], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+15, idx_Rt2, -Rt[73], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+16, idx_Rt2, -Rt[77], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+17, idx_Rt2, -Rt[78], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+18, idx_Rt2, -Rt[79], sizeof(double));
        MM_SCATTER(Rt2+18*20*SIMDD+19, idx_Rt2, -Rt[82], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+0, idx_Rt2, -Rt[64], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+1, idx_Rt2, -Rt[65], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+2, idx_Rt2, -Rt[66], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+3, idx_Rt2, -Rt[67], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+4, idx_Rt2, -Rt[68], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+5, idx_Rt2, -Rt[69], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+6, idx_Rt2, -Rt[70], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+7, idx_Rt2, -Rt[71], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+8, idx_Rt2, -Rt[72], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+9, idx_Rt2, -Rt[73], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+10, idx_Rt2, -Rt[74], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+11, idx_Rt2, -Rt[75], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+12, idx_Rt2, -Rt[76], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+13, idx_Rt2, -Rt[77], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+14, idx_Rt2, -Rt[78], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+15, idx_Rt2, -Rt[79], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+16, idx_Rt2, -Rt[80], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+17, idx_Rt2, -Rt[81], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+18, idx_Rt2, -Rt[82], sizeof(double));
        MM_SCATTER(Rt2+19*20*SIMDD+19, idx_Rt2, -Rt[83], sizeof(double));
}

void get_Rt2_simd(double *Rt2, int l1, int l2, __MD a, __MD fac, __MD *rpq, __MD *buf,
                  __MI32 idx_Rt2, int len2)
{
        switch (l1*LMAX*2+l2) {
        case (0*LMAX*2+0): return Rt2_0_0_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (0*LMAX*2+1): return Rt2_0_1_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (0*LMAX*2+2): return Rt2_0_2_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (0*LMAX*2+3): return Rt2_0_3_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (1*LMAX*2+0): return Rt2_1_0_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (1*LMAX*2+1): return Rt2_1_1_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (1*LMAX*2+2): return Rt2_1_2_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (1*LMAX*2+3): return Rt2_1_3_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (2*LMAX*2+0): return Rt2_2_0_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (2*LMAX*2+1): return Rt2_2_1_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (2*LMAX*2+2): return Rt2_2_2_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (2*LMAX*2+3): return Rt2_2_3_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (3*LMAX*2+0): return Rt2_3_0_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (3*LMAX*2+1): return Rt2_3_1_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (3*LMAX*2+2): return Rt2_3_2_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        case (3*LMAX*2+3): return Rt2_3_3_simd(Rt2, a, fac, rpq, buf, idx_Rt2);
        }

        __MD *_Rt2 = (__MD *)Rt2;
        int l = l1 + l2;
        int e, f, g, t, u, v, n1, n2;
        if (l1 == 0) {
                get_R_tensor_simd(buf, l, a, fac, rpq, _Rt2);
                for (int n = 0, e = 0; e <= l1; e++) {
                for (f = 0; f <= l1-e; f++) {
                for (g = 0; g <= l1-e-f; g++, n++) {
                        MM_SCATTER(Rt2+n, idx_Rt2, buf[n], sizeof(double));
                } } }
                return;
        }
        if (l2 == 0) {
                get_R_tensor_simd(buf, l, a, fac, rpq, _Rt2);
                for (int n = 0, e = 0; e <= l1; e++) {
                for (f = 0; f <= l1-e; f++) {
                for (g = 0; g <= l1-e-f; g++, n++) {
                        if ((e + f + g) % 2 == 1) {
                                MM_SCATTER(Rt2+n, idx_Rt2, -buf[n], sizeof(double));
                        } else {
                                MM_SCATTER(Rt2+n, idx_Rt2, buf[n], sizeof(double));
                        }
                } } }
                return;
        }

        get_R_tensor_simd(_Rt2, l, a, fac, rpq, buf);
        int stride_l = (l+1);
        int stride_ll = stride_l * (l+1);
        __MD *Rsub;
        for (int n = 0, t = 0; t <= l; t++) {
                Rsub = buf + t*stride_ll;
                for (u = 0; u <= l-t; u++) {
#pragma GCC ivdep
                for (v = 0; v <= l-t-u; v++, n++) {
                        Rsub[u*stride_l+v] = _Rt2[n];
                } }
        }

        for (n1 = 0, e = 0; e <= l1; e++) {
        for (f = 0; f <= l1-e; f++) {
        for (g = 0; g <= l1-e-f; g++, n1++) {
                if ((e + f + g) % 2 == 0) {
                        for (n2 = 0, t = 0; t <= l2; t++) {
                                Rsub = buf + (e+t)*stride_ll + f*stride_l + g;
                                for (u = 0; u <= l2-t; u++) {
#pragma GCC ivdep
                                for (v = 0; v <= l2-t-u; v++, n2++) {
                                        MM_SCATTER(Rt2+n1*len2+n2, idx_Rt2, Rsub[u*stride_l+v], sizeof(double));
                                } }
                        }
                } else {
                        for (n2 = 0, t = 0; t <= l2; t++) {
                                Rsub = buf + (e+t)*stride_ll + f*stride_l + g;
                                for (u = 0; u <= l2-t; u++) {
#pragma GCC ivdep
                                for (v = 0; v <= l2-t-u; v++, n2++) {
                                        MM_SCATTER(Rt2+n1*len2+n2, idx_Rt2, -Rsub[u*stride_l+v], sizeof(double));
                                } }
                        }
                }
        } } }
        return;
}
#endif
