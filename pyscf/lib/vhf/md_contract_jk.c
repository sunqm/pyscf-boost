#include <stdlib.h>
#include <math.h>
#include <assert.h>
#include "vhf.h"

// 2*pi**2.5
#define PI_FAC  34.98683665524972497

void _contract_jk_s4(JKMatrix *jk, double *eri,
                     int ish, int jsh, int ksh, int lsh, int *ao_loc)
{
        int i0 = ao_loc[ish  ];
        int i1 = ao_loc[ish+1];
        int j0 = ao_loc[jsh  ];
        int j1 = ao_loc[jsh+1];
        int k0 = ao_loc[ksh  ];
        int k1 = ao_loc[ksh+1];
        int l0 = ao_loc[lsh  ];
        int l1 = ao_loc[lsh+1];
        int nao = jk->nao;
        int n_dm = jk->n_dm;
        double *vj = jk->vj;
        double *vk = jk->vk;
        double *dm = jk->dm;
        int i, j, k, l, n, i_dm;

        for (i_dm = 0; i_dm < n_dm; i_dm++) {
                n = 0;
                // unlike libcint, here eri is stored in C-order!
                for (i = i0; i < i1; i++) {
                for (j = j0; j < j1; j++) {
                        double dm_ji = dm[j*nao+i];
                        double v_ij = 0.;
                        for (k = k0; k < k1; k++) {
                                double v_ik = 0.;
                                double v_jk = 0.;
                                for (l = l0; l < l1; l++) {
                                        double s = eri[n];
                                        v_ij += s * dm[l*nao+k];
                                        vj[k*nao+l] += s * dm_ji;

                                        vk[i*nao+l] += s * dm[j*nao+k];
                                        vk[j*nao+l] += s * dm[i*nao+k];
                                        v_ik += s * dm[j*nao+l];
                                        v_jk += s * dm[i*nao+l];
                                        n++;
                                }
                                vk[i*nao+k] += v_ik;
                                vk[j*nao+k] += v_jk;
                        }
                        vj[i*nao+j] += v_ij;
                } }
                dm += nao * nao;
                vj += nao * nao;
                vk += nao * nao;
        }
}

static void Rt2jvec_0_0(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
}
static void Rt2jvec_0_1(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[3];
        jvec_ij[3] += Rt[3] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
}
static void Rt2jvec_0_2(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[3];
        jvec_ij[3] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[4];
        jvec_ij[4] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[5];
        jvec_ij[5] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[6];
        jvec_ij[6] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[7];
        jvec_ij[7] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[8];
        jvec_ij[8] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[9];
        jvec_ij[9] += Rt[9] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
}
static void Rt2jvec_0_3(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[3];
        jvec_ij[3] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[4];
        jvec_ij[4] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[5];
        jvec_ij[5] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[6];
        jvec_ij[6] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[7];
        jvec_ij[7] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[8];
        jvec_ij[8] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[9];
        jvec_ij[9] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[10];
        jvec_ij[10] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[11];
        jvec_ij[11] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[12];
        jvec_ij[12] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[13];
        jvec_ij[13] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[14];
        jvec_ij[14] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[15];
        jvec_ij[15] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[16];
        jvec_ij[16] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[17];
        jvec_ij[17] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[18];
        jvec_ij[18] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[19];
        jvec_ij[19] += Rt[19] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
}
static void Rt2jvec_1_0(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val -= Rt[2] * rho_ij[0];
        jvec_ij[0] -= Rt[2] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
}
static void Rt2jvec_1_1(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[2];
        jvec_ij[2] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[3];
        jvec_ij[3] += Rt[6] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[2];
        jvec_ij[2] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[3];
        jvec_ij[3] -= Rt[7] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[1];
        jvec_ij[1] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[2];
        jvec_ij[2] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[3];
        jvec_ij[3] -= Rt[8] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[6] * rho_ij[0];
        jvec_ij[0] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[1];
        jvec_ij[1] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[2];
        jvec_ij[2] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[3];
        jvec_ij[3] -= Rt[9] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
}
static void Rt2jvec_1_2(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[3];
        jvec_ij[3] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[4];
        jvec_ij[4] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[5];
        jvec_ij[5] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[6];
        jvec_ij[6] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[7];
        jvec_ij[7] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[8];
        jvec_ij[8] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[9];
        jvec_ij[9] += Rt[16] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[3] * rho_ij[2];
        jvec_ij[2] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[3];
        jvec_ij[3] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[4];
        jvec_ij[4] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[5];
        jvec_ij[5] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[6];
        jvec_ij[6] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[7];
        jvec_ij[7] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[8];
        jvec_ij[8] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[9];
        jvec_ij[9] -= Rt[17] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val -= Rt[4] * rho_ij[0];
        jvec_ij[0] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[1];
        jvec_ij[1] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[2];
        jvec_ij[2] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[3];
        jvec_ij[3] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[4];
        jvec_ij[4] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[5];
        jvec_ij[5] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[6];
        jvec_ij[6] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[7];
        jvec_ij[7] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[8];
        jvec_ij[8] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[9];
        jvec_ij[9] -= Rt[18] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[10] * rho_ij[0];
        jvec_ij[0] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[1];
        jvec_ij[1] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[2];
        jvec_ij[2] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[3];
        jvec_ij[3] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[4];
        jvec_ij[4] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[5];
        jvec_ij[5] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[6];
        jvec_ij[6] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[7];
        jvec_ij[7] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[8];
        jvec_ij[8] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[9];
        jvec_ij[9] -= Rt[19] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
}
static void Rt2jvec_1_3(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[3];
        jvec_ij[3] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[4];
        jvec_ij[4] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[5];
        jvec_ij[5] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[6];
        jvec_ij[6] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[7];
        jvec_ij[7] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[8];
        jvec_ij[8] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[9];
        jvec_ij[9] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[10];
        jvec_ij[10] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[11];
        jvec_ij[11] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[12];
        jvec_ij[12] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[13];
        jvec_ij[13] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[14];
        jvec_ij[14] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[15];
        jvec_ij[15] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[25] * rho_ij[16];
        jvec_ij[16] += Rt[25] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[17];
        jvec_ij[17] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[18];
        jvec_ij[18] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[19];
        jvec_ij[19] += Rt[31] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[3] * rho_ij[2];
        jvec_ij[2] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[3];
        jvec_ij[3] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[4];
        jvec_ij[4] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[5];
        jvec_ij[5] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[6];
        jvec_ij[6] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[7];
        jvec_ij[7] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[8];
        jvec_ij[8] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[9];
        jvec_ij[9] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[10];
        jvec_ij[10] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[11];
        jvec_ij[11] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[12];
        jvec_ij[12] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[13];
        jvec_ij[13] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[14];
        jvec_ij[14] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[15];
        jvec_ij[15] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[16];
        jvec_ij[16] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[17];
        jvec_ij[17] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[18];
        jvec_ij[18] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[19];
        jvec_ij[19] -= Rt[32] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val -= Rt[5] * rho_ij[0];
        jvec_ij[0] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[1];
        jvec_ij[1] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[2];
        jvec_ij[2] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[3];
        jvec_ij[3] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[4];
        jvec_ij[4] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[5];
        jvec_ij[5] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[6];
        jvec_ij[6] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[7];
        jvec_ij[7] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[8];
        jvec_ij[8] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[9];
        jvec_ij[9] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[10];
        jvec_ij[10] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[11];
        jvec_ij[11] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[12];
        jvec_ij[12] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[13];
        jvec_ij[13] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[14];
        jvec_ij[14] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[15];
        jvec_ij[15] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[16];
        jvec_ij[16] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[17];
        jvec_ij[17] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[18];
        jvec_ij[18] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[19];
        jvec_ij[19] -= Rt[33] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[15] * rho_ij[0];
        jvec_ij[0] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[1];
        jvec_ij[1] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[2];
        jvec_ij[2] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[3];
        jvec_ij[3] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[4];
        jvec_ij[4] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[5];
        jvec_ij[5] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[6];
        jvec_ij[6] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[7];
        jvec_ij[7] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[8];
        jvec_ij[8] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[9];
        jvec_ij[9] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[25] * rho_ij[10];
        jvec_ij[10] -= Rt[25] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[11];
        jvec_ij[11] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[12];
        jvec_ij[12] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[13];
        jvec_ij[13] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[14];
        jvec_ij[14] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[15];
        jvec_ij[15] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[16];
        jvec_ij[16] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[17];
        jvec_ij[17] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[18];
        jvec_ij[18] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[19];
        jvec_ij[19] -= Rt[34] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
}
static void Rt2jvec_2_0(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val += Rt[4] * rho_ij[0];
        jvec_ij[0] += Rt[4] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[5] * rho_ij[0];
        jvec_ij[0] += Rt[5] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[6] * rho_ij[0];
        jvec_ij[0] -= Rt[6] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[7] * rho_ij[0];
        jvec_ij[0] += Rt[7] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val += Rt[8] * rho_ij[0];
        jvec_ij[0] += Rt[8] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val += Rt[9] * rho_ij[0];
        jvec_ij[0] += Rt[9] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
}
static void Rt2jvec_2_1(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[2];
        jvec_ij[2] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[3];
        jvec_ij[3] += Rt[10] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[2];
        jvec_ij[2] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[3];
        jvec_ij[3] -= Rt[11] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[1];
        jvec_ij[1] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[2];
        jvec_ij[2] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[3];
        jvec_ij[3] += Rt[12] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[4] * rho_ij[0];
        jvec_ij[0] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[1];
        jvec_ij[1] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[2];
        jvec_ij[2] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[3];
        jvec_ij[3] -= Rt[13] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val += Rt[5] * rho_ij[0];
        jvec_ij[0] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[1];
        jvec_ij[1] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[2];
        jvec_ij[2] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[3];
        jvec_ij[3] += Rt[14] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[7] * rho_ij[0];
        jvec_ij[0] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[1];
        jvec_ij[1] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[2];
        jvec_ij[2] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[3];
        jvec_ij[3] += Rt[15] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[10] * rho_ij[0];
        jvec_ij[0] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[1];
        jvec_ij[1] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[2];
        jvec_ij[2] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[3];
        jvec_ij[3] -= Rt[16] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[11] * rho_ij[0];
        jvec_ij[0] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[1];
        jvec_ij[1] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[2];
        jvec_ij[2] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[3];
        jvec_ij[3] += Rt[17] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val += Rt[13] * rho_ij[0];
        jvec_ij[0] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[1];
        jvec_ij[1] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[2];
        jvec_ij[2] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[3];
        jvec_ij[3] += Rt[18] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val += Rt[16] * rho_ij[0];
        jvec_ij[0] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[1];
        jvec_ij[1] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[2];
        jvec_ij[2] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[3];
        jvec_ij[3] += Rt[19] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
}
static void Rt2jvec_2_2(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[3];
        jvec_ij[3] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[4];
        jvec_ij[4] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[5];
        jvec_ij[5] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[6];
        jvec_ij[6] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[7];
        jvec_ij[7] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[8];
        jvec_ij[8] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[25] * rho_ij[9];
        jvec_ij[9] += Rt[25] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[3] * rho_ij[2];
        jvec_ij[2] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[3];
        jvec_ij[3] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[4];
        jvec_ij[4] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[5];
        jvec_ij[5] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[6];
        jvec_ij[6] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[7];
        jvec_ij[7] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[8];
        jvec_ij[8] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[9];
        jvec_ij[9] -= Rt[26] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[1];
        jvec_ij[1] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[2];
        jvec_ij[2] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[3];
        jvec_ij[3] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[4];
        jvec_ij[4] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[5];
        jvec_ij[5] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[6];
        jvec_ij[6] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[7];
        jvec_ij[7] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[21] * rho_ij[8];
        jvec_ij[8] += Rt[21] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[9];
        jvec_ij[9] += Rt[27] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[5] * rho_ij[0];
        jvec_ij[0] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[1];
        jvec_ij[1] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[2];
        jvec_ij[2] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[3];
        jvec_ij[3] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[4];
        jvec_ij[4] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[5];
        jvec_ij[5] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[6];
        jvec_ij[6] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[7];
        jvec_ij[7] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[8];
        jvec_ij[8] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[9];
        jvec_ij[9] -= Rt[28] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val += Rt[6] * rho_ij[0];
        jvec_ij[0] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[1];
        jvec_ij[1] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[2];
        jvec_ij[2] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[3];
        jvec_ij[3] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[4];
        jvec_ij[4] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[5];
        jvec_ij[5] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[6];
        jvec_ij[6] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[21] * rho_ij[7];
        jvec_ij[7] += Rt[21] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[8];
        jvec_ij[8] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[9];
        jvec_ij[9] += Rt[29] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[9] * rho_ij[0];
        jvec_ij[0] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[1];
        jvec_ij[1] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[2];
        jvec_ij[2] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[3];
        jvec_ij[3] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[4];
        jvec_ij[4] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[5];
        jvec_ij[5] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[6];
        jvec_ij[6] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[7];
        jvec_ij[7] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[24] * rho_ij[8];
        jvec_ij[8] += Rt[24] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[9];
        jvec_ij[9] += Rt[30] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[15] * rho_ij[0];
        jvec_ij[0] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[1];
        jvec_ij[1] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[2];
        jvec_ij[2] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[3];
        jvec_ij[3] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[4];
        jvec_ij[4] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[5];
        jvec_ij[5] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[25] * rho_ij[6];
        jvec_ij[6] -= Rt[25] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[7];
        jvec_ij[7] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[8];
        jvec_ij[8] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[9];
        jvec_ij[9] -= Rt[31] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[16] * rho_ij[0];
        jvec_ij[0] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[1];
        jvec_ij[1] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[2];
        jvec_ij[2] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[3];
        jvec_ij[3] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[21] * rho_ij[4];
        jvec_ij[4] += Rt[21] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[5];
        jvec_ij[5] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[6];
        jvec_ij[6] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[7];
        jvec_ij[7] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[8];
        jvec_ij[8] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[9];
        jvec_ij[9] += Rt[32] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val += Rt[19] * rho_ij[0];
        jvec_ij[0] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[1];
        jvec_ij[1] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[21] * rho_ij[2];
        jvec_ij[2] += Rt[21] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[3];
        jvec_ij[3] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[4];
        jvec_ij[4] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[24] * rho_ij[5];
        jvec_ij[5] += Rt[24] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[6];
        jvec_ij[6] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[7];
        jvec_ij[7] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[8];
        jvec_ij[8] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[33] * rho_ij[9];
        jvec_ij[9] += Rt[33] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val += Rt[25] * rho_ij[0];
        jvec_ij[0] += Rt[25] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[1];
        jvec_ij[1] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[2];
        jvec_ij[2] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[3];
        jvec_ij[3] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[4];
        jvec_ij[4] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[5];
        jvec_ij[5] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[6];
        jvec_ij[6] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[7];
        jvec_ij[7] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[33] * rho_ij[8];
        jvec_ij[8] += Rt[33] * rho_kl_val;
        jvec_kl_val += Rt[34] * rho_ij[9];
        jvec_ij[9] += Rt[34] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
}
static void Rt2jvec_2_3(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[3];
        jvec_ij[3] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[4];
        jvec_ij[4] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[5];
        jvec_ij[5] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[6];
        jvec_ij[6] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[7];
        jvec_ij[7] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[8];
        jvec_ij[8] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[9];
        jvec_ij[9] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[21] * rho_ij[10];
        jvec_ij[10] += Rt[21] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[11];
        jvec_ij[11] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[12];
        jvec_ij[12] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[13];
        jvec_ij[13] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[14];
        jvec_ij[14] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[15];
        jvec_ij[15] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[36] * rho_ij[16];
        jvec_ij[16] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[17];
        jvec_ij[17] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[18];
        jvec_ij[18] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[46] * rho_ij[19];
        jvec_ij[19] += Rt[46] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[3] * rho_ij[2];
        jvec_ij[2] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[3];
        jvec_ij[3] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[4];
        jvec_ij[4] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[5];
        jvec_ij[5] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[6];
        jvec_ij[6] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[7];
        jvec_ij[7] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[8];
        jvec_ij[8] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[9];
        jvec_ij[9] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[10];
        jvec_ij[10] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[11];
        jvec_ij[11] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[12];
        jvec_ij[12] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[13];
        jvec_ij[13] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[14];
        jvec_ij[14] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[15];
        jvec_ij[15] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[16];
        jvec_ij[16] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[17];
        jvec_ij[17] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[18];
        jvec_ij[18] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[19];
        jvec_ij[19] -= Rt[47] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[1];
        jvec_ij[1] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[2];
        jvec_ij[2] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[3];
        jvec_ij[3] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[4];
        jvec_ij[4] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[5];
        jvec_ij[5] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[6];
        jvec_ij[6] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[7];
        jvec_ij[7] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[8];
        jvec_ij[8] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[9];
        jvec_ij[9] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[10];
        jvec_ij[10] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[24] * rho_ij[11];
        jvec_ij[11] += Rt[24] * rho_kl_val;
        jvec_kl_val += Rt[25] * rho_ij[12];
        jvec_ij[12] += Rt[25] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[13];
        jvec_ij[13] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[14];
        jvec_ij[14] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[15];
        jvec_ij[15] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[38] * rho_ij[16];
        jvec_ij[16] += Rt[38] * rho_kl_val;
        jvec_kl_val += Rt[39] * rho_ij[17];
        jvec_ij[17] += Rt[39] * rho_kl_val;
        jvec_kl_val += Rt[42] * rho_ij[18];
        jvec_ij[18] += Rt[42] * rho_kl_val;
        jvec_kl_val += Rt[48] * rho_ij[19];
        jvec_ij[19] += Rt[48] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[6] * rho_ij[0];
        jvec_ij[0] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[1];
        jvec_ij[1] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[2];
        jvec_ij[2] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[3];
        jvec_ij[3] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[4];
        jvec_ij[4] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[5];
        jvec_ij[5] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[6];
        jvec_ij[6] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[7];
        jvec_ij[7] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[8];
        jvec_ij[8] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[9];
        jvec_ij[9] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[10];
        jvec_ij[10] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[11];
        jvec_ij[11] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[12];
        jvec_ij[12] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[13];
        jvec_ij[13] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[14];
        jvec_ij[14] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[15];
        jvec_ij[15] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[16];
        jvec_ij[16] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[17];
        jvec_ij[17] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[18];
        jvec_ij[18] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[49] * rho_ij[19];
        jvec_ij[19] -= Rt[49] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val += Rt[7] * rho_ij[0];
        jvec_ij[0] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[1];
        jvec_ij[1] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[2];
        jvec_ij[2] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[3];
        jvec_ij[3] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[4];
        jvec_ij[4] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[5];
        jvec_ij[5] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[6];
        jvec_ij[6] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[7];
        jvec_ij[7] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[8];
        jvec_ij[8] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[9];
        jvec_ij[9] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[10];
        jvec_ij[10] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[11];
        jvec_ij[11] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[12];
        jvec_ij[12] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[13];
        jvec_ij[13] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[14];
        jvec_ij[14] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[34] * rho_ij[15];
        jvec_ij[15] += Rt[34] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[16];
        jvec_ij[16] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[42] * rho_ij[17];
        jvec_ij[17] += Rt[42] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[18];
        jvec_ij[18] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[19];
        jvec_ij[19] += Rt[50] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[11] * rho_ij[0];
        jvec_ij[0] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[1];
        jvec_ij[1] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[2];
        jvec_ij[2] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[3];
        jvec_ij[3] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[4];
        jvec_ij[4] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[5];
        jvec_ij[5] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[6];
        jvec_ij[6] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[7];
        jvec_ij[7] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[8];
        jvec_ij[8] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[9];
        jvec_ij[9] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[10];
        jvec_ij[10] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[11];
        jvec_ij[11] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[12];
        jvec_ij[12] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[33] * rho_ij[13];
        jvec_ij[13] += Rt[33] * rho_kl_val;
        jvec_kl_val += Rt[34] * rho_ij[14];
        jvec_ij[14] += Rt[34] * rho_kl_val;
        jvec_kl_val += Rt[35] * rho_ij[15];
        jvec_ij[15] += Rt[35] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[16];
        jvec_ij[16] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[17];
        jvec_ij[17] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[45] * rho_ij[18];
        jvec_ij[18] += Rt[45] * rho_kl_val;
        jvec_kl_val += Rt[51] * rho_ij[19];
        jvec_ij[19] += Rt[51] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[21] * rho_ij[0];
        jvec_ij[0] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[1];
        jvec_ij[1] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[2];
        jvec_ij[2] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[3];
        jvec_ij[3] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[4];
        jvec_ij[4] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[5];
        jvec_ij[5] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[6];
        jvec_ij[6] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[7];
        jvec_ij[7] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[8];
        jvec_ij[8] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[9];
        jvec_ij[9] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[10];
        jvec_ij[10] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[11];
        jvec_ij[11] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[12];
        jvec_ij[12] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[13];
        jvec_ij[13] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[14];
        jvec_ij[14] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[15];
        jvec_ij[15] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[46] * rho_ij[16];
        jvec_ij[16] -= Rt[46] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[17];
        jvec_ij[17] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[49] * rho_ij[18];
        jvec_ij[18] -= Rt[49] * rho_kl_val;
        jvec_kl_val -= Rt[52] * rho_ij[19];
        jvec_ij[19] -= Rt[52] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[22] * rho_ij[0];
        jvec_ij[0] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[1];
        jvec_ij[1] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[24] * rho_ij[2];
        jvec_ij[2] += Rt[24] * rho_kl_val;
        jvec_kl_val += Rt[25] * rho_ij[3];
        jvec_ij[3] += Rt[25] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[4];
        jvec_ij[4] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[5];
        jvec_ij[5] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[6];
        jvec_ij[6] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[7];
        jvec_ij[7] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[8];
        jvec_ij[8] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[34] * rho_ij[9];
        jvec_ij[9] += Rt[34] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[10];
        jvec_ij[10] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[38] * rho_ij[11];
        jvec_ij[11] += Rt[38] * rho_kl_val;
        jvec_kl_val += Rt[39] * rho_ij[12];
        jvec_ij[12] += Rt[39] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[13];
        jvec_ij[13] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[42] * rho_ij[14];
        jvec_ij[14] += Rt[42] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[15];
        jvec_ij[15] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[47] * rho_ij[16];
        jvec_ij[16] += Rt[47] * rho_kl_val;
        jvec_kl_val += Rt[48] * rho_ij[17];
        jvec_ij[17] += Rt[48] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[18];
        jvec_ij[18] += Rt[50] * rho_kl_val;
        jvec_kl_val += Rt[53] * rho_ij[19];
        jvec_ij[19] += Rt[53] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val += Rt[26] * rho_ij[0];
        jvec_ij[0] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[1];
        jvec_ij[1] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[2];
        jvec_ij[2] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[3];
        jvec_ij[3] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[4];
        jvec_ij[4] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[5];
        jvec_ij[5] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[6];
        jvec_ij[6] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[33] * rho_ij[7];
        jvec_ij[7] += Rt[33] * rho_kl_val;
        jvec_kl_val += Rt[34] * rho_ij[8];
        jvec_ij[8] += Rt[34] * rho_kl_val;
        jvec_kl_val += Rt[35] * rho_ij[9];
        jvec_ij[9] += Rt[35] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[10];
        jvec_ij[10] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[11];
        jvec_ij[11] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[42] * rho_ij[12];
        jvec_ij[12] += Rt[42] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[13];
        jvec_ij[13] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[14];
        jvec_ij[14] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[45] * rho_ij[15];
        jvec_ij[15] += Rt[45] * rho_kl_val;
        jvec_kl_val += Rt[49] * rho_ij[16];
        jvec_ij[16] += Rt[49] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[17];
        jvec_ij[17] += Rt[50] * rho_kl_val;
        jvec_kl_val += Rt[51] * rho_ij[18];
        jvec_ij[18] += Rt[51] * rho_kl_val;
        jvec_kl_val += Rt[54] * rho_ij[19];
        jvec_ij[19] += Rt[54] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val += Rt[36] * rho_ij[0];
        jvec_ij[0] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[1];
        jvec_ij[1] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[38] * rho_ij[2];
        jvec_ij[2] += Rt[38] * rho_kl_val;
        jvec_kl_val += Rt[39] * rho_ij[3];
        jvec_ij[3] += Rt[39] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[4];
        jvec_ij[4] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[5];
        jvec_ij[5] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[42] * rho_ij[6];
        jvec_ij[6] += Rt[42] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[7];
        jvec_ij[7] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[8];
        jvec_ij[8] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[45] * rho_ij[9];
        jvec_ij[9] += Rt[45] * rho_kl_val;
        jvec_kl_val += Rt[46] * rho_ij[10];
        jvec_ij[10] += Rt[46] * rho_kl_val;
        jvec_kl_val += Rt[47] * rho_ij[11];
        jvec_ij[11] += Rt[47] * rho_kl_val;
        jvec_kl_val += Rt[48] * rho_ij[12];
        jvec_ij[12] += Rt[48] * rho_kl_val;
        jvec_kl_val += Rt[49] * rho_ij[13];
        jvec_ij[13] += Rt[49] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[14];
        jvec_ij[14] += Rt[50] * rho_kl_val;
        jvec_kl_val += Rt[51] * rho_ij[15];
        jvec_ij[15] += Rt[51] * rho_kl_val;
        jvec_kl_val += Rt[52] * rho_ij[16];
        jvec_ij[16] += Rt[52] * rho_kl_val;
        jvec_kl_val += Rt[53] * rho_ij[17];
        jvec_ij[17] += Rt[53] * rho_kl_val;
        jvec_kl_val += Rt[54] * rho_ij[18];
        jvec_ij[18] += Rt[54] * rho_kl_val;
        jvec_kl_val += Rt[55] * rho_ij[19];
        jvec_ij[19] += Rt[55] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
}
static void Rt2jvec_3_0(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val -= Rt[4] * rho_ij[0];
        jvec_ij[0] -= Rt[4] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[5] * rho_ij[0];
        jvec_ij[0] += Rt[5] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[6] * rho_ij[0];
        jvec_ij[0] -= Rt[6] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[7] * rho_ij[0];
        jvec_ij[0] += Rt[7] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val -= Rt[8] * rho_ij[0];
        jvec_ij[0] -= Rt[8] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val -= Rt[9] * rho_ij[0];
        jvec_ij[0] -= Rt[9] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[10];
        jvec_kl_val -= Rt[10] * rho_ij[0];
        jvec_ij[0] -= Rt[10] * rho_kl_val;
        jvec_kl[10] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[11];
        jvec_kl_val += Rt[11] * rho_ij[0];
        jvec_ij[0] += Rt[11] * rho_kl_val;
        jvec_kl[11] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[12];
        jvec_kl_val -= Rt[12] * rho_ij[0];
        jvec_ij[0] -= Rt[12] * rho_kl_val;
        jvec_kl[12] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[13];
        jvec_kl_val += Rt[13] * rho_ij[0];
        jvec_ij[0] += Rt[13] * rho_kl_val;
        jvec_kl[13] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[14];
        jvec_kl_val -= Rt[14] * rho_ij[0];
        jvec_ij[0] -= Rt[14] * rho_kl_val;
        jvec_kl[14] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[15];
        jvec_kl_val -= Rt[15] * rho_ij[0];
        jvec_ij[0] -= Rt[15] * rho_kl_val;
        jvec_kl[15] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[16];
        jvec_kl_val += Rt[16] * rho_ij[0];
        jvec_ij[0] += Rt[16] * rho_kl_val;
        jvec_kl[16] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[17];
        jvec_kl_val -= Rt[17] * rho_ij[0];
        jvec_ij[0] -= Rt[17] * rho_kl_val;
        jvec_kl[17] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[18];
        jvec_kl_val -= Rt[18] * rho_ij[0];
        jvec_ij[0] -= Rt[18] * rho_kl_val;
        jvec_kl[18] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[19];
        jvec_kl_val -= Rt[19] * rho_ij[0];
        jvec_ij[0] -= Rt[19] * rho_kl_val;
        jvec_kl[19] += jvec_kl_val;
}
static void Rt2jvec_3_1(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[2];
        jvec_ij[2] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[3];
        jvec_ij[3] += Rt[15] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[2];
        jvec_ij[2] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[3];
        jvec_ij[3] -= Rt[16] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[1];
        jvec_ij[1] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[2];
        jvec_ij[2] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[3];
        jvec_ij[3] += Rt[17] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[1];
        jvec_ij[1] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[2];
        jvec_ij[2] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[3];
        jvec_ij[3] -= Rt[18] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val -= Rt[5] * rho_ij[0];
        jvec_ij[0] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[1];
        jvec_ij[1] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[2];
        jvec_ij[2] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[3];
        jvec_ij[3] -= Rt[19] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[6] * rho_ij[0];
        jvec_ij[0] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[1];
        jvec_ij[1] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[2];
        jvec_ij[2] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[3];
        jvec_ij[3] += Rt[20] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[7] * rho_ij[0];
        jvec_ij[0] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[1];
        jvec_ij[1] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[2];
        jvec_ij[2] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[3];
        jvec_ij[3] -= Rt[21] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[9] * rho_ij[0];
        jvec_ij[0] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[1];
        jvec_ij[1] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[2];
        jvec_ij[2] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[3];
        jvec_ij[3] += Rt[22] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val -= Rt[10] * rho_ij[0];
        jvec_ij[0] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[1];
        jvec_ij[1] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[2];
        jvec_ij[2] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[3];
        jvec_ij[3] -= Rt[23] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val -= Rt[12] * rho_ij[0];
        jvec_ij[0] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[1];
        jvec_ij[1] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[2];
        jvec_ij[2] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[3];
        jvec_ij[3] -= Rt[24] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[10];
        jvec_kl_val -= Rt[15] * rho_ij[0];
        jvec_ij[0] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[1];
        jvec_ij[1] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[2];
        jvec_ij[2] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[25] * rho_ij[3];
        jvec_ij[3] -= Rt[25] * rho_kl_val;
        jvec_kl[10] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[11];
        jvec_kl_val += Rt[16] * rho_ij[0];
        jvec_ij[0] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[17] * rho_ij[1];
        jvec_ij[1] += Rt[17] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[2];
        jvec_ij[2] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[3];
        jvec_ij[3] += Rt[26] * rho_kl_val;
        jvec_kl[11] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[12];
        jvec_kl_val -= Rt[17] * rho_ij[0];
        jvec_ij[0] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[1];
        jvec_ij[1] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[2];
        jvec_ij[2] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[3];
        jvec_ij[3] -= Rt[27] * rho_kl_val;
        jvec_kl[12] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[13];
        jvec_kl_val += Rt[19] * rho_ij[0];
        jvec_ij[0] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[1];
        jvec_ij[1] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[2];
        jvec_ij[2] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[3];
        jvec_ij[3] += Rt[28] * rho_kl_val;
        jvec_kl[13] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[14];
        jvec_kl_val -= Rt[20] * rho_ij[0];
        jvec_ij[0] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[1];
        jvec_ij[1] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[2];
        jvec_ij[2] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[3];
        jvec_ij[3] -= Rt[29] * rho_kl_val;
        jvec_kl[14] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[15];
        jvec_kl_val -= Rt[22] * rho_ij[0];
        jvec_ij[0] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[1];
        jvec_ij[1] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[2];
        jvec_ij[2] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[3];
        jvec_ij[3] -= Rt[30] * rho_kl_val;
        jvec_kl[15] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[16];
        jvec_kl_val += Rt[25] * rho_ij[0];
        jvec_ij[0] += Rt[25] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[1];
        jvec_ij[1] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[2];
        jvec_ij[2] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[3];
        jvec_ij[3] += Rt[31] * rho_kl_val;
        jvec_kl[16] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[17];
        jvec_kl_val -= Rt[26] * rho_ij[0];
        jvec_ij[0] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[1];
        jvec_ij[1] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[2];
        jvec_ij[2] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[3];
        jvec_ij[3] -= Rt[32] * rho_kl_val;
        jvec_kl[17] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[18];
        jvec_kl_val -= Rt[28] * rho_ij[0];
        jvec_ij[0] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[1];
        jvec_ij[1] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[2];
        jvec_ij[2] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[3];
        jvec_ij[3] -= Rt[33] * rho_kl_val;
        jvec_kl[18] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[19];
        jvec_kl_val -= Rt[31] * rho_ij[0];
        jvec_ij[0] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[1];
        jvec_ij[1] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[2];
        jvec_ij[2] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[3];
        jvec_ij[3] -= Rt[34] * rho_kl_val;
        jvec_kl[19] += jvec_kl_val;
}
static void Rt2jvec_3_2(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[6] * rho_ij[3];
        jvec_ij[3] += Rt[6] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[4];
        jvec_ij[4] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[5];
        jvec_ij[5] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[21] * rho_ij[6];
        jvec_ij[6] += Rt[21] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[7];
        jvec_ij[7] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[26] * rho_ij[8];
        jvec_ij[8] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[36] * rho_ij[9];
        jvec_ij[9] += Rt[36] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[3] * rho_ij[2];
        jvec_ij[2] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[3];
        jvec_ij[3] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[4];
        jvec_ij[4] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[5];
        jvec_ij[5] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[6];
        jvec_ij[6] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[7];
        jvec_ij[7] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[8];
        jvec_ij[8] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[9];
        jvec_ij[9] -= Rt[37] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[1];
        jvec_ij[1] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[2];
        jvec_ij[2] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[3];
        jvec_ij[3] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[4];
        jvec_ij[4] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[5];
        jvec_ij[5] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[6];
        jvec_ij[6] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[24] * rho_ij[7];
        jvec_ij[7] += Rt[24] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[8];
        jvec_ij[8] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[38] * rho_ij[9];
        jvec_ij[9] += Rt[38] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[1];
        jvec_ij[1] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[2];
        jvec_ij[2] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[3];
        jvec_ij[3] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[4];
        jvec_ij[4] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[5];
        jvec_ij[5] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[6];
        jvec_ij[6] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[25] * rho_ij[7];
        jvec_ij[7] -= Rt[25] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[8];
        jvec_ij[8] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[39] * rho_ij[9];
        jvec_ij[9] -= Rt[39] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val -= Rt[6] * rho_ij[0];
        jvec_ij[0] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[7] * rho_ij[1];
        jvec_ij[1] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[2];
        jvec_ij[2] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[3];
        jvec_ij[3] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[4];
        jvec_ij[4] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[5];
        jvec_ij[5] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[6];
        jvec_ij[6] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[7];
        jvec_ij[7] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[8];
        jvec_ij[8] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[9];
        jvec_ij[9] -= Rt[40] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[7] * rho_ij[0];
        jvec_ij[0] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[1];
        jvec_ij[1] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[2];
        jvec_ij[2] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[3];
        jvec_ij[3] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[4];
        jvec_ij[4] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[5];
        jvec_ij[5] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[6];
        jvec_ij[6] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[7];
        jvec_ij[7] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[8];
        jvec_ij[8] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[9];
        jvec_ij[9] += Rt[41] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[8] * rho_ij[0];
        jvec_ij[0] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[1];
        jvec_ij[1] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[2];
        jvec_ij[2] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[3];
        jvec_ij[3] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[4];
        jvec_ij[4] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[5];
        jvec_ij[5] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[6];
        jvec_ij[6] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[7];
        jvec_ij[7] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[8];
        jvec_ij[8] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[9];
        jvec_ij[9] -= Rt[42] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[11] * rho_ij[0];
        jvec_ij[0] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[12] * rho_ij[1];
        jvec_ij[1] += Rt[12] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[2];
        jvec_ij[2] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[3];
        jvec_ij[3] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[4];
        jvec_ij[4] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[5];
        jvec_ij[5] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[6];
        jvec_ij[6] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[7];
        jvec_ij[7] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[33] * rho_ij[8];
        jvec_ij[8] += Rt[33] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[9];
        jvec_ij[9] += Rt[43] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val -= Rt[12] * rho_ij[0];
        jvec_ij[0] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[1];
        jvec_ij[1] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[2];
        jvec_ij[2] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[3];
        jvec_ij[3] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[4];
        jvec_ij[4] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[5];
        jvec_ij[5] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[6];
        jvec_ij[6] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[7];
        jvec_ij[7] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[8];
        jvec_ij[8] -= Rt[34] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[9];
        jvec_ij[9] -= Rt[44] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val -= Rt[15] * rho_ij[0];
        jvec_ij[0] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[1];
        jvec_ij[1] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[2];
        jvec_ij[2] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[3];
        jvec_ij[3] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[4];
        jvec_ij[4] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[5];
        jvec_ij[5] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[6];
        jvec_ij[6] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[7];
        jvec_ij[7] -= Rt[34] * rho_kl_val;
        jvec_kl_val -= Rt[35] * rho_ij[8];
        jvec_ij[8] -= Rt[35] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[9];
        jvec_ij[9] -= Rt[45] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[10];
        jvec_kl_val -= Rt[21] * rho_ij[0];
        jvec_ij[0] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[1];
        jvec_ij[1] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[2];
        jvec_ij[2] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[3];
        jvec_ij[3] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[4];
        jvec_ij[4] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[5];
        jvec_ij[5] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[6];
        jvec_ij[6] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[7];
        jvec_ij[7] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[8];
        jvec_ij[8] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[46] * rho_ij[9];
        jvec_ij[9] -= Rt[46] * rho_kl_val;
        jvec_kl[10] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[11];
        jvec_kl_val += Rt[22] * rho_ij[0];
        jvec_ij[0] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[1];
        jvec_ij[1] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[24] * rho_ij[2];
        jvec_ij[2] += Rt[24] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[3];
        jvec_ij[3] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[4];
        jvec_ij[4] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[5];
        jvec_ij[5] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[6];
        jvec_ij[6] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[38] * rho_ij[7];
        jvec_ij[7] += Rt[38] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[8];
        jvec_ij[8] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[47] * rho_ij[9];
        jvec_ij[9] += Rt[47] * rho_kl_val;
        jvec_kl[11] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[12];
        jvec_kl_val -= Rt[23] * rho_ij[0];
        jvec_ij[0] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[1];
        jvec_ij[1] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[25] * rho_ij[2];
        jvec_ij[2] -= Rt[25] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[3];
        jvec_ij[3] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[4];
        jvec_ij[4] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[5];
        jvec_ij[5] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[6];
        jvec_ij[6] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[39] * rho_ij[7];
        jvec_ij[7] -= Rt[39] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[8];
        jvec_ij[8] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[48] * rho_ij[9];
        jvec_ij[9] -= Rt[48] * rho_kl_val;
        jvec_kl[12] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[13];
        jvec_kl_val += Rt[26] * rho_ij[0];
        jvec_ij[0] += Rt[26] * rho_kl_val;
        jvec_kl_val += Rt[27] * rho_ij[1];
        jvec_ij[1] += Rt[27] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[2];
        jvec_ij[2] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[3];
        jvec_ij[3] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[4];
        jvec_ij[4] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[33] * rho_ij[5];
        jvec_ij[5] += Rt[33] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[6];
        jvec_ij[6] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[7];
        jvec_ij[7] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[8];
        jvec_ij[8] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[49] * rho_ij[9];
        jvec_ij[9] += Rt[49] * rho_kl_val;
        jvec_kl[13] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[14];
        jvec_kl_val -= Rt[27] * rho_ij[0];
        jvec_ij[0] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[28] * rho_ij[1];
        jvec_ij[1] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[2];
        jvec_ij[2] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[3];
        jvec_ij[3] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[4];
        jvec_ij[4] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[5];
        jvec_ij[5] -= Rt[34] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[6];
        jvec_ij[6] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[7];
        jvec_ij[7] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[8];
        jvec_ij[8] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[50] * rho_ij[9];
        jvec_ij[9] -= Rt[50] * rho_kl_val;
        jvec_kl[14] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[15];
        jvec_kl_val -= Rt[30] * rho_ij[0];
        jvec_ij[0] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[1];
        jvec_ij[1] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[2];
        jvec_ij[2] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[3];
        jvec_ij[3] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[4];
        jvec_ij[4] -= Rt[34] * rho_kl_val;
        jvec_kl_val -= Rt[35] * rho_ij[5];
        jvec_ij[5] -= Rt[35] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[6];
        jvec_ij[6] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[7];
        jvec_ij[7] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[8];
        jvec_ij[8] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[9];
        jvec_ij[9] -= Rt[51] * rho_kl_val;
        jvec_kl[15] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[16];
        jvec_kl_val += Rt[36] * rho_ij[0];
        jvec_ij[0] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[1];
        jvec_ij[1] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[38] * rho_ij[2];
        jvec_ij[2] += Rt[38] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[3];
        jvec_ij[3] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[4];
        jvec_ij[4] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[5];
        jvec_ij[5] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[46] * rho_ij[6];
        jvec_ij[6] += Rt[46] * rho_kl_val;
        jvec_kl_val += Rt[47] * rho_ij[7];
        jvec_ij[7] += Rt[47] * rho_kl_val;
        jvec_kl_val += Rt[49] * rho_ij[8];
        jvec_ij[8] += Rt[49] * rho_kl_val;
        jvec_kl_val += Rt[52] * rho_ij[9];
        jvec_ij[9] += Rt[52] * rho_kl_val;
        jvec_kl[16] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[17];
        jvec_kl_val -= Rt[37] * rho_ij[0];
        jvec_ij[0] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[1];
        jvec_ij[1] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[39] * rho_ij[2];
        jvec_ij[2] -= Rt[39] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[3];
        jvec_ij[3] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[4];
        jvec_ij[4] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[5];
        jvec_ij[5] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[6];
        jvec_ij[6] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[48] * rho_ij[7];
        jvec_ij[7] -= Rt[48] * rho_kl_val;
        jvec_kl_val -= Rt[50] * rho_ij[8];
        jvec_ij[8] -= Rt[50] * rho_kl_val;
        jvec_kl_val -= Rt[53] * rho_ij[9];
        jvec_ij[9] -= Rt[53] * rho_kl_val;
        jvec_kl[17] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[18];
        jvec_kl_val -= Rt[40] * rho_ij[0];
        jvec_ij[0] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[1];
        jvec_ij[1] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[2];
        jvec_ij[2] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[3];
        jvec_ij[3] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[4];
        jvec_ij[4] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[5];
        jvec_ij[5] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[49] * rho_ij[6];
        jvec_ij[6] -= Rt[49] * rho_kl_val;
        jvec_kl_val -= Rt[50] * rho_ij[7];
        jvec_ij[7] -= Rt[50] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[8];
        jvec_ij[8] -= Rt[51] * rho_kl_val;
        jvec_kl_val -= Rt[54] * rho_ij[9];
        jvec_ij[9] -= Rt[54] * rho_kl_val;
        jvec_kl[18] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[19];
        jvec_kl_val -= Rt[46] * rho_ij[0];
        jvec_ij[0] -= Rt[46] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[1];
        jvec_ij[1] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[48] * rho_ij[2];
        jvec_ij[2] -= Rt[48] * rho_kl_val;
        jvec_kl_val -= Rt[49] * rho_ij[3];
        jvec_ij[3] -= Rt[49] * rho_kl_val;
        jvec_kl_val -= Rt[50] * rho_ij[4];
        jvec_ij[4] -= Rt[50] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[5];
        jvec_ij[5] -= Rt[51] * rho_kl_val;
        jvec_kl_val -= Rt[52] * rho_ij[6];
        jvec_ij[6] -= Rt[52] * rho_kl_val;
        jvec_kl_val -= Rt[53] * rho_ij[7];
        jvec_ij[7] -= Rt[53] * rho_kl_val;
        jvec_kl_val -= Rt[54] * rho_ij[8];
        jvec_ij[8] -= Rt[54] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[9];
        jvec_ij[9] -= Rt[55] * rho_kl_val;
        jvec_kl[19] += jvec_kl_val;
}
static void Rt2jvec_3_3(double *Rt, double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        double jvec_kl_val, rho_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[0];
        jvec_kl_val += Rt[0] * rho_ij[0];
        jvec_ij[0] += Rt[0] * rho_kl_val;
        jvec_kl_val += Rt[1] * rho_ij[1];
        jvec_ij[1] += Rt[1] * rho_kl_val;
        jvec_kl_val += Rt[2] * rho_ij[2];
        jvec_ij[2] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[3];
        jvec_ij[3] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[7] * rho_ij[4];
        jvec_ij[4] += Rt[7] * rho_kl_val;
        jvec_kl_val += Rt[8] * rho_ij[5];
        jvec_ij[5] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[6];
        jvec_ij[6] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[13] * rho_ij[7];
        jvec_ij[7] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[8];
        jvec_ij[8] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[9];
        jvec_ij[9] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[28] * rho_ij[10];
        jvec_ij[10] += Rt[28] * rho_kl_val;
        jvec_kl_val += Rt[29] * rho_ij[11];
        jvec_ij[11] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[12];
        jvec_ij[12] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[34] * rho_ij[13];
        jvec_ij[13] += Rt[34] * rho_kl_val;
        jvec_kl_val += Rt[35] * rho_ij[14];
        jvec_ij[14] += Rt[35] * rho_kl_val;
        jvec_kl_val += Rt[39] * rho_ij[15];
        jvec_ij[15] += Rt[39] * rho_kl_val;
        jvec_kl_val += Rt[49] * rho_ij[16];
        jvec_ij[16] += Rt[49] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[17];
        jvec_ij[17] += Rt[50] * rho_kl_val;
        jvec_kl_val += Rt[54] * rho_ij[18];
        jvec_ij[18] += Rt[54] * rho_kl_val;
        jvec_kl_val += Rt[64] * rho_ij[19];
        jvec_ij[19] += Rt[64] * rho_kl_val;
        jvec_kl[0] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[1];
        jvec_kl_val -= Rt[1] * rho_ij[0];
        jvec_ij[0] -= Rt[1] * rho_kl_val;
        jvec_kl_val -= Rt[2] * rho_ij[1];
        jvec_ij[1] -= Rt[2] * rho_kl_val;
        jvec_kl_val -= Rt[3] * rho_ij[2];
        jvec_ij[2] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[3];
        jvec_ij[3] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[4];
        jvec_ij[4] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[5];
        jvec_ij[5] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[6];
        jvec_ij[6] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[7];
        jvec_ij[7] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[8];
        jvec_ij[8] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[9];
        jvec_ij[9] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[10];
        jvec_ij[10] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[11];
        jvec_ij[11] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[12];
        jvec_ij[12] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[35] * rho_ij[13];
        jvec_ij[13] -= Rt[35] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[14];
        jvec_ij[14] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[15];
        jvec_ij[15] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[50] * rho_ij[16];
        jvec_ij[16] -= Rt[50] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[17];
        jvec_ij[17] -= Rt[51] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[18];
        jvec_ij[18] -= Rt[55] * rho_kl_val;
        jvec_kl_val -= Rt[65] * rho_ij[19];
        jvec_ij[19] -= Rt[65] * rho_kl_val;
        jvec_kl[1] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[2];
        jvec_kl_val += Rt[2] * rho_ij[0];
        jvec_ij[0] += Rt[2] * rho_kl_val;
        jvec_kl_val += Rt[3] * rho_ij[1];
        jvec_ij[1] += Rt[3] * rho_kl_val;
        jvec_kl_val += Rt[4] * rho_ij[2];
        jvec_ij[2] += Rt[4] * rho_kl_val;
        jvec_kl_val += Rt[5] * rho_ij[3];
        jvec_ij[3] += Rt[5] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[4];
        jvec_ij[4] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[5];
        jvec_ij[5] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[6];
        jvec_ij[6] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[7];
        jvec_ij[7] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[8];
        jvec_ij[8] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[9];
        jvec_ij[9] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[10];
        jvec_ij[10] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[11];
        jvec_ij[11] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[12];
        jvec_ij[12] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[36] * rho_ij[13];
        jvec_ij[13] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[14];
        jvec_ij[14] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[15];
        jvec_ij[15] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[51] * rho_ij[16];
        jvec_ij[16] += Rt[51] * rho_kl_val;
        jvec_kl_val += Rt[52] * rho_ij[17];
        jvec_ij[17] += Rt[52] * rho_kl_val;
        jvec_kl_val += Rt[56] * rho_ij[18];
        jvec_ij[18] += Rt[56] * rho_kl_val;
        jvec_kl_val += Rt[66] * rho_ij[19];
        jvec_ij[19] += Rt[66] * rho_kl_val;
        jvec_kl[2] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[3];
        jvec_kl_val -= Rt[3] * rho_ij[0];
        jvec_ij[0] -= Rt[3] * rho_kl_val;
        jvec_kl_val -= Rt[4] * rho_ij[1];
        jvec_ij[1] -= Rt[4] * rho_kl_val;
        jvec_kl_val -= Rt[5] * rho_ij[2];
        jvec_ij[2] -= Rt[5] * rho_kl_val;
        jvec_kl_val -= Rt[6] * rho_ij[3];
        jvec_ij[3] -= Rt[6] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[4];
        jvec_ij[4] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[5];
        jvec_ij[5] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[6];
        jvec_ij[6] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[7];
        jvec_ij[7] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[8];
        jvec_ij[8] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[9];
        jvec_ij[9] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[10];
        jvec_ij[10] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[11];
        jvec_ij[11] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[12];
        jvec_ij[12] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[13];
        jvec_ij[13] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[14];
        jvec_ij[14] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[15];
        jvec_ij[15] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[52] * rho_ij[16];
        jvec_ij[16] -= Rt[52] * rho_kl_val;
        jvec_kl_val -= Rt[53] * rho_ij[17];
        jvec_ij[17] -= Rt[53] * rho_kl_val;
        jvec_kl_val -= Rt[57] * rho_ij[18];
        jvec_ij[18] -= Rt[57] * rho_kl_val;
        jvec_kl_val -= Rt[67] * rho_ij[19];
        jvec_ij[19] -= Rt[67] * rho_kl_val;
        jvec_kl[3] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[4];
        jvec_kl_val -= Rt[7] * rho_ij[0];
        jvec_ij[0] -= Rt[7] * rho_kl_val;
        jvec_kl_val -= Rt[8] * rho_ij[1];
        jvec_ij[1] -= Rt[8] * rho_kl_val;
        jvec_kl_val -= Rt[9] * rho_ij[2];
        jvec_ij[2] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[3];
        jvec_ij[3] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[13] * rho_ij[4];
        jvec_ij[4] -= Rt[13] * rho_kl_val;
        jvec_kl_val -= Rt[14] * rho_ij[5];
        jvec_ij[5] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[6];
        jvec_ij[6] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[18] * rho_ij[7];
        jvec_ij[7] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[8];
        jvec_ij[8] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[9];
        jvec_ij[9] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[10];
        jvec_ij[10] -= Rt[34] * rho_kl_val;
        jvec_kl_val -= Rt[35] * rho_ij[11];
        jvec_ij[11] -= Rt[35] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[12];
        jvec_ij[12] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[39] * rho_ij[13];
        jvec_ij[13] -= Rt[39] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[14];
        jvec_ij[14] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[15];
        jvec_ij[15] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[54] * rho_ij[16];
        jvec_ij[16] -= Rt[54] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[17];
        jvec_ij[17] -= Rt[55] * rho_kl_val;
        jvec_kl_val -= Rt[58] * rho_ij[18];
        jvec_ij[18] -= Rt[58] * rho_kl_val;
        jvec_kl_val -= Rt[68] * rho_ij[19];
        jvec_ij[19] -= Rt[68] * rho_kl_val;
        jvec_kl[4] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[5];
        jvec_kl_val += Rt[8] * rho_ij[0];
        jvec_ij[0] += Rt[8] * rho_kl_val;
        jvec_kl_val += Rt[9] * rho_ij[1];
        jvec_ij[1] += Rt[9] * rho_kl_val;
        jvec_kl_val += Rt[10] * rho_ij[2];
        jvec_ij[2] += Rt[10] * rho_kl_val;
        jvec_kl_val += Rt[11] * rho_ij[3];
        jvec_ij[3] += Rt[11] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[4];
        jvec_ij[4] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[5];
        jvec_ij[5] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[6];
        jvec_ij[6] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[7];
        jvec_ij[7] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[8];
        jvec_ij[8] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[9];
        jvec_ij[9] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[35] * rho_ij[10];
        jvec_ij[10] += Rt[35] * rho_kl_val;
        jvec_kl_val += Rt[36] * rho_ij[11];
        jvec_ij[11] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[12];
        jvec_ij[12] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[13];
        jvec_ij[13] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[14];
        jvec_ij[14] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[15];
        jvec_ij[15] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[55] * rho_ij[16];
        jvec_ij[16] += Rt[55] * rho_kl_val;
        jvec_kl_val += Rt[56] * rho_ij[17];
        jvec_ij[17] += Rt[56] * rho_kl_val;
        jvec_kl_val += Rt[59] * rho_ij[18];
        jvec_ij[18] += Rt[59] * rho_kl_val;
        jvec_kl_val += Rt[69] * rho_ij[19];
        jvec_ij[19] += Rt[69] * rho_kl_val;
        jvec_kl[5] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[6];
        jvec_kl_val -= Rt[9] * rho_ij[0];
        jvec_ij[0] -= Rt[9] * rho_kl_val;
        jvec_kl_val -= Rt[10] * rho_ij[1];
        jvec_ij[1] -= Rt[10] * rho_kl_val;
        jvec_kl_val -= Rt[11] * rho_ij[2];
        jvec_ij[2] -= Rt[11] * rho_kl_val;
        jvec_kl_val -= Rt[12] * rho_ij[3];
        jvec_ij[3] -= Rt[12] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[4];
        jvec_ij[4] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[5];
        jvec_ij[5] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[6];
        jvec_ij[6] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[7];
        jvec_ij[7] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[8];
        jvec_ij[8] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[9];
        jvec_ij[9] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[10];
        jvec_ij[10] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[11];
        jvec_ij[11] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[12];
        jvec_ij[12] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[13];
        jvec_ij[13] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[14];
        jvec_ij[14] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[15];
        jvec_ij[15] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[56] * rho_ij[16];
        jvec_ij[16] -= Rt[56] * rho_kl_val;
        jvec_kl_val -= Rt[57] * rho_ij[17];
        jvec_ij[17] -= Rt[57] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[18];
        jvec_ij[18] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[70] * rho_ij[19];
        jvec_ij[19] -= Rt[70] * rho_kl_val;
        jvec_kl[6] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[7];
        jvec_kl_val += Rt[13] * rho_ij[0];
        jvec_ij[0] += Rt[13] * rho_kl_val;
        jvec_kl_val += Rt[14] * rho_ij[1];
        jvec_ij[1] += Rt[14] * rho_kl_val;
        jvec_kl_val += Rt[15] * rho_ij[2];
        jvec_ij[2] += Rt[15] * rho_kl_val;
        jvec_kl_val += Rt[16] * rho_ij[3];
        jvec_ij[3] += Rt[16] * rho_kl_val;
        jvec_kl_val += Rt[18] * rho_ij[4];
        jvec_ij[4] += Rt[18] * rho_kl_val;
        jvec_kl_val += Rt[19] * rho_ij[5];
        jvec_ij[5] += Rt[19] * rho_kl_val;
        jvec_kl_val += Rt[20] * rho_ij[6];
        jvec_ij[6] += Rt[20] * rho_kl_val;
        jvec_kl_val += Rt[22] * rho_ij[7];
        jvec_ij[7] += Rt[22] * rho_kl_val;
        jvec_kl_val += Rt[23] * rho_ij[8];
        jvec_ij[8] += Rt[23] * rho_kl_val;
        jvec_kl_val += Rt[25] * rho_ij[9];
        jvec_ij[9] += Rt[25] * rho_kl_val;
        jvec_kl_val += Rt[39] * rho_ij[10];
        jvec_ij[10] += Rt[39] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[11];
        jvec_ij[11] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[12];
        jvec_ij[12] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[13];
        jvec_ij[13] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[14];
        jvec_ij[14] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[46] * rho_ij[15];
        jvec_ij[15] += Rt[46] * rho_kl_val;
        jvec_kl_val += Rt[58] * rho_ij[16];
        jvec_ij[16] += Rt[58] * rho_kl_val;
        jvec_kl_val += Rt[59] * rho_ij[17];
        jvec_ij[17] += Rt[59] * rho_kl_val;
        jvec_kl_val += Rt[61] * rho_ij[18];
        jvec_ij[18] += Rt[61] * rho_kl_val;
        jvec_kl_val += Rt[71] * rho_ij[19];
        jvec_ij[19] += Rt[71] * rho_kl_val;
        jvec_kl[7] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[8];
        jvec_kl_val -= Rt[14] * rho_ij[0];
        jvec_ij[0] -= Rt[14] * rho_kl_val;
        jvec_kl_val -= Rt[15] * rho_ij[1];
        jvec_ij[1] -= Rt[15] * rho_kl_val;
        jvec_kl_val -= Rt[16] * rho_ij[2];
        jvec_ij[2] -= Rt[16] * rho_kl_val;
        jvec_kl_val -= Rt[17] * rho_ij[3];
        jvec_ij[3] -= Rt[17] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[4];
        jvec_ij[4] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[5];
        jvec_ij[5] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[6];
        jvec_ij[6] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[7];
        jvec_ij[7] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[8];
        jvec_ij[8] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[9];
        jvec_ij[9] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[10];
        jvec_ij[10] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[11];
        jvec_ij[11] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[12];
        jvec_ij[12] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[13];
        jvec_ij[13] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[14];
        jvec_ij[14] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[15];
        jvec_ij[15] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[59] * rho_ij[16];
        jvec_ij[16] -= Rt[59] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[17];
        jvec_ij[17] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[62] * rho_ij[18];
        jvec_ij[18] -= Rt[62] * rho_kl_val;
        jvec_kl_val -= Rt[72] * rho_ij[19];
        jvec_ij[19] -= Rt[72] * rho_kl_val;
        jvec_kl[8] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[9];
        jvec_kl_val -= Rt[18] * rho_ij[0];
        jvec_ij[0] -= Rt[18] * rho_kl_val;
        jvec_kl_val -= Rt[19] * rho_ij[1];
        jvec_ij[1] -= Rt[19] * rho_kl_val;
        jvec_kl_val -= Rt[20] * rho_ij[2];
        jvec_ij[2] -= Rt[20] * rho_kl_val;
        jvec_kl_val -= Rt[21] * rho_ij[3];
        jvec_ij[3] -= Rt[21] * rho_kl_val;
        jvec_kl_val -= Rt[22] * rho_ij[4];
        jvec_ij[4] -= Rt[22] * rho_kl_val;
        jvec_kl_val -= Rt[23] * rho_ij[5];
        jvec_ij[5] -= Rt[23] * rho_kl_val;
        jvec_kl_val -= Rt[24] * rho_ij[6];
        jvec_ij[6] -= Rt[24] * rho_kl_val;
        jvec_kl_val -= Rt[25] * rho_ij[7];
        jvec_ij[7] -= Rt[25] * rho_kl_val;
        jvec_kl_val -= Rt[26] * rho_ij[8];
        jvec_ij[8] -= Rt[26] * rho_kl_val;
        jvec_kl_val -= Rt[27] * rho_ij[9];
        jvec_ij[9] -= Rt[27] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[10];
        jvec_ij[10] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[11];
        jvec_ij[11] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[12];
        jvec_ij[12] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[46] * rho_ij[13];
        jvec_ij[13] -= Rt[46] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[14];
        jvec_ij[14] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[48] * rho_ij[15];
        jvec_ij[15] -= Rt[48] * rho_kl_val;
        jvec_kl_val -= Rt[61] * rho_ij[16];
        jvec_ij[16] -= Rt[61] * rho_kl_val;
        jvec_kl_val -= Rt[62] * rho_ij[17];
        jvec_ij[17] -= Rt[62] * rho_kl_val;
        jvec_kl_val -= Rt[63] * rho_ij[18];
        jvec_ij[18] -= Rt[63] * rho_kl_val;
        jvec_kl_val -= Rt[73] * rho_ij[19];
        jvec_ij[19] -= Rt[73] * rho_kl_val;
        jvec_kl[9] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[10];
        jvec_kl_val -= Rt[28] * rho_ij[0];
        jvec_ij[0] -= Rt[28] * rho_kl_val;
        jvec_kl_val -= Rt[29] * rho_ij[1];
        jvec_ij[1] -= Rt[29] * rho_kl_val;
        jvec_kl_val -= Rt[30] * rho_ij[2];
        jvec_ij[2] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[3];
        jvec_ij[3] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[34] * rho_ij[4];
        jvec_ij[4] -= Rt[34] * rho_kl_val;
        jvec_kl_val -= Rt[35] * rho_ij[5];
        jvec_ij[5] -= Rt[35] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[6];
        jvec_ij[6] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[39] * rho_ij[7];
        jvec_ij[7] -= Rt[39] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[8];
        jvec_ij[8] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[9];
        jvec_ij[9] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[49] * rho_ij[10];
        jvec_ij[10] -= Rt[49] * rho_kl_val;
        jvec_kl_val -= Rt[50] * rho_ij[11];
        jvec_ij[11] -= Rt[50] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[12];
        jvec_ij[12] -= Rt[51] * rho_kl_val;
        jvec_kl_val -= Rt[54] * rho_ij[13];
        jvec_ij[13] -= Rt[54] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[14];
        jvec_ij[14] -= Rt[55] * rho_kl_val;
        jvec_kl_val -= Rt[58] * rho_ij[15];
        jvec_ij[15] -= Rt[58] * rho_kl_val;
        jvec_kl_val -= Rt[64] * rho_ij[16];
        jvec_ij[16] -= Rt[64] * rho_kl_val;
        jvec_kl_val -= Rt[65] * rho_ij[17];
        jvec_ij[17] -= Rt[65] * rho_kl_val;
        jvec_kl_val -= Rt[68] * rho_ij[18];
        jvec_ij[18] -= Rt[68] * rho_kl_val;
        jvec_kl_val -= Rt[74] * rho_ij[19];
        jvec_ij[19] -= Rt[74] * rho_kl_val;
        jvec_kl[10] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[11];
        jvec_kl_val += Rt[29] * rho_ij[0];
        jvec_ij[0] += Rt[29] * rho_kl_val;
        jvec_kl_val += Rt[30] * rho_ij[1];
        jvec_ij[1] += Rt[30] * rho_kl_val;
        jvec_kl_val += Rt[31] * rho_ij[2];
        jvec_ij[2] += Rt[31] * rho_kl_val;
        jvec_kl_val += Rt[32] * rho_ij[3];
        jvec_ij[3] += Rt[32] * rho_kl_val;
        jvec_kl_val += Rt[35] * rho_ij[4];
        jvec_ij[4] += Rt[35] * rho_kl_val;
        jvec_kl_val += Rt[36] * rho_ij[5];
        jvec_ij[5] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[6];
        jvec_ij[6] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[7];
        jvec_ij[7] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[8];
        jvec_ij[8] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[9];
        jvec_ij[9] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[10];
        jvec_ij[10] += Rt[50] * rho_kl_val;
        jvec_kl_val += Rt[51] * rho_ij[11];
        jvec_ij[11] += Rt[51] * rho_kl_val;
        jvec_kl_val += Rt[52] * rho_ij[12];
        jvec_ij[12] += Rt[52] * rho_kl_val;
        jvec_kl_val += Rt[55] * rho_ij[13];
        jvec_ij[13] += Rt[55] * rho_kl_val;
        jvec_kl_val += Rt[56] * rho_ij[14];
        jvec_ij[14] += Rt[56] * rho_kl_val;
        jvec_kl_val += Rt[59] * rho_ij[15];
        jvec_ij[15] += Rt[59] * rho_kl_val;
        jvec_kl_val += Rt[65] * rho_ij[16];
        jvec_ij[16] += Rt[65] * rho_kl_val;
        jvec_kl_val += Rt[66] * rho_ij[17];
        jvec_ij[17] += Rt[66] * rho_kl_val;
        jvec_kl_val += Rt[69] * rho_ij[18];
        jvec_ij[18] += Rt[69] * rho_kl_val;
        jvec_kl_val += Rt[75] * rho_ij[19];
        jvec_ij[19] += Rt[75] * rho_kl_val;
        jvec_kl[11] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[12];
        jvec_kl_val -= Rt[30] * rho_ij[0];
        jvec_ij[0] -= Rt[30] * rho_kl_val;
        jvec_kl_val -= Rt[31] * rho_ij[1];
        jvec_ij[1] -= Rt[31] * rho_kl_val;
        jvec_kl_val -= Rt[32] * rho_ij[2];
        jvec_ij[2] -= Rt[32] * rho_kl_val;
        jvec_kl_val -= Rt[33] * rho_ij[3];
        jvec_ij[3] -= Rt[33] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[4];
        jvec_ij[4] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[5];
        jvec_ij[5] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[6];
        jvec_ij[6] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[7];
        jvec_ij[7] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[8];
        jvec_ij[8] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[9];
        jvec_ij[9] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[10];
        jvec_ij[10] -= Rt[51] * rho_kl_val;
        jvec_kl_val -= Rt[52] * rho_ij[11];
        jvec_ij[11] -= Rt[52] * rho_kl_val;
        jvec_kl_val -= Rt[53] * rho_ij[12];
        jvec_ij[12] -= Rt[53] * rho_kl_val;
        jvec_kl_val -= Rt[56] * rho_ij[13];
        jvec_ij[13] -= Rt[56] * rho_kl_val;
        jvec_kl_val -= Rt[57] * rho_ij[14];
        jvec_ij[14] -= Rt[57] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[15];
        jvec_ij[15] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[66] * rho_ij[16];
        jvec_ij[16] -= Rt[66] * rho_kl_val;
        jvec_kl_val -= Rt[67] * rho_ij[17];
        jvec_ij[17] -= Rt[67] * rho_kl_val;
        jvec_kl_val -= Rt[70] * rho_ij[18];
        jvec_ij[18] -= Rt[70] * rho_kl_val;
        jvec_kl_val -= Rt[76] * rho_ij[19];
        jvec_ij[19] -= Rt[76] * rho_kl_val;
        jvec_kl[12] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[13];
        jvec_kl_val += Rt[34] * rho_ij[0];
        jvec_ij[0] += Rt[34] * rho_kl_val;
        jvec_kl_val += Rt[35] * rho_ij[1];
        jvec_ij[1] += Rt[35] * rho_kl_val;
        jvec_kl_val += Rt[36] * rho_ij[2];
        jvec_ij[2] += Rt[36] * rho_kl_val;
        jvec_kl_val += Rt[37] * rho_ij[3];
        jvec_ij[3] += Rt[37] * rho_kl_val;
        jvec_kl_val += Rt[39] * rho_ij[4];
        jvec_ij[4] += Rt[39] * rho_kl_val;
        jvec_kl_val += Rt[40] * rho_ij[5];
        jvec_ij[5] += Rt[40] * rho_kl_val;
        jvec_kl_val += Rt[41] * rho_ij[6];
        jvec_ij[6] += Rt[41] * rho_kl_val;
        jvec_kl_val += Rt[43] * rho_ij[7];
        jvec_ij[7] += Rt[43] * rho_kl_val;
        jvec_kl_val += Rt[44] * rho_ij[8];
        jvec_ij[8] += Rt[44] * rho_kl_val;
        jvec_kl_val += Rt[46] * rho_ij[9];
        jvec_ij[9] += Rt[46] * rho_kl_val;
        jvec_kl_val += Rt[54] * rho_ij[10];
        jvec_ij[10] += Rt[54] * rho_kl_val;
        jvec_kl_val += Rt[55] * rho_ij[11];
        jvec_ij[11] += Rt[55] * rho_kl_val;
        jvec_kl_val += Rt[56] * rho_ij[12];
        jvec_ij[12] += Rt[56] * rho_kl_val;
        jvec_kl_val += Rt[58] * rho_ij[13];
        jvec_ij[13] += Rt[58] * rho_kl_val;
        jvec_kl_val += Rt[59] * rho_ij[14];
        jvec_ij[14] += Rt[59] * rho_kl_val;
        jvec_kl_val += Rt[61] * rho_ij[15];
        jvec_ij[15] += Rt[61] * rho_kl_val;
        jvec_kl_val += Rt[68] * rho_ij[16];
        jvec_ij[16] += Rt[68] * rho_kl_val;
        jvec_kl_val += Rt[69] * rho_ij[17];
        jvec_ij[17] += Rt[69] * rho_kl_val;
        jvec_kl_val += Rt[71] * rho_ij[18];
        jvec_ij[18] += Rt[71] * rho_kl_val;
        jvec_kl_val += Rt[77] * rho_ij[19];
        jvec_ij[19] += Rt[77] * rho_kl_val;
        jvec_kl[13] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[14];
        jvec_kl_val -= Rt[35] * rho_ij[0];
        jvec_ij[0] -= Rt[35] * rho_kl_val;
        jvec_kl_val -= Rt[36] * rho_ij[1];
        jvec_ij[1] -= Rt[36] * rho_kl_val;
        jvec_kl_val -= Rt[37] * rho_ij[2];
        jvec_ij[2] -= Rt[37] * rho_kl_val;
        jvec_kl_val -= Rt[38] * rho_ij[3];
        jvec_ij[3] -= Rt[38] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[4];
        jvec_ij[4] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[5];
        jvec_ij[5] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[6];
        jvec_ij[6] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[7];
        jvec_ij[7] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[8];
        jvec_ij[8] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[9];
        jvec_ij[9] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[10];
        jvec_ij[10] -= Rt[55] * rho_kl_val;
        jvec_kl_val -= Rt[56] * rho_ij[11];
        jvec_ij[11] -= Rt[56] * rho_kl_val;
        jvec_kl_val -= Rt[57] * rho_ij[12];
        jvec_ij[12] -= Rt[57] * rho_kl_val;
        jvec_kl_val -= Rt[59] * rho_ij[13];
        jvec_ij[13] -= Rt[59] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[14];
        jvec_ij[14] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[62] * rho_ij[15];
        jvec_ij[15] -= Rt[62] * rho_kl_val;
        jvec_kl_val -= Rt[69] * rho_ij[16];
        jvec_ij[16] -= Rt[69] * rho_kl_val;
        jvec_kl_val -= Rt[70] * rho_ij[17];
        jvec_ij[17] -= Rt[70] * rho_kl_val;
        jvec_kl_val -= Rt[72] * rho_ij[18];
        jvec_ij[18] -= Rt[72] * rho_kl_val;
        jvec_kl_val -= Rt[78] * rho_ij[19];
        jvec_ij[19] -= Rt[78] * rho_kl_val;
        jvec_kl[14] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[15];
        jvec_kl_val -= Rt[39] * rho_ij[0];
        jvec_ij[0] -= Rt[39] * rho_kl_val;
        jvec_kl_val -= Rt[40] * rho_ij[1];
        jvec_ij[1] -= Rt[40] * rho_kl_val;
        jvec_kl_val -= Rt[41] * rho_ij[2];
        jvec_ij[2] -= Rt[41] * rho_kl_val;
        jvec_kl_val -= Rt[42] * rho_ij[3];
        jvec_ij[3] -= Rt[42] * rho_kl_val;
        jvec_kl_val -= Rt[43] * rho_ij[4];
        jvec_ij[4] -= Rt[43] * rho_kl_val;
        jvec_kl_val -= Rt[44] * rho_ij[5];
        jvec_ij[5] -= Rt[44] * rho_kl_val;
        jvec_kl_val -= Rt[45] * rho_ij[6];
        jvec_ij[6] -= Rt[45] * rho_kl_val;
        jvec_kl_val -= Rt[46] * rho_ij[7];
        jvec_ij[7] -= Rt[46] * rho_kl_val;
        jvec_kl_val -= Rt[47] * rho_ij[8];
        jvec_ij[8] -= Rt[47] * rho_kl_val;
        jvec_kl_val -= Rt[48] * rho_ij[9];
        jvec_ij[9] -= Rt[48] * rho_kl_val;
        jvec_kl_val -= Rt[58] * rho_ij[10];
        jvec_ij[10] -= Rt[58] * rho_kl_val;
        jvec_kl_val -= Rt[59] * rho_ij[11];
        jvec_ij[11] -= Rt[59] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[12];
        jvec_ij[12] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[61] * rho_ij[13];
        jvec_ij[13] -= Rt[61] * rho_kl_val;
        jvec_kl_val -= Rt[62] * rho_ij[14];
        jvec_ij[14] -= Rt[62] * rho_kl_val;
        jvec_kl_val -= Rt[63] * rho_ij[15];
        jvec_ij[15] -= Rt[63] * rho_kl_val;
        jvec_kl_val -= Rt[71] * rho_ij[16];
        jvec_ij[16] -= Rt[71] * rho_kl_val;
        jvec_kl_val -= Rt[72] * rho_ij[17];
        jvec_ij[17] -= Rt[72] * rho_kl_val;
        jvec_kl_val -= Rt[73] * rho_ij[18];
        jvec_ij[18] -= Rt[73] * rho_kl_val;
        jvec_kl_val -= Rt[79] * rho_ij[19];
        jvec_ij[19] -= Rt[79] * rho_kl_val;
        jvec_kl[15] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[16];
        jvec_kl_val += Rt[49] * rho_ij[0];
        jvec_ij[0] += Rt[49] * rho_kl_val;
        jvec_kl_val += Rt[50] * rho_ij[1];
        jvec_ij[1] += Rt[50] * rho_kl_val;
        jvec_kl_val += Rt[51] * rho_ij[2];
        jvec_ij[2] += Rt[51] * rho_kl_val;
        jvec_kl_val += Rt[52] * rho_ij[3];
        jvec_ij[3] += Rt[52] * rho_kl_val;
        jvec_kl_val += Rt[54] * rho_ij[4];
        jvec_ij[4] += Rt[54] * rho_kl_val;
        jvec_kl_val += Rt[55] * rho_ij[5];
        jvec_ij[5] += Rt[55] * rho_kl_val;
        jvec_kl_val += Rt[56] * rho_ij[6];
        jvec_ij[6] += Rt[56] * rho_kl_val;
        jvec_kl_val += Rt[58] * rho_ij[7];
        jvec_ij[7] += Rt[58] * rho_kl_val;
        jvec_kl_val += Rt[59] * rho_ij[8];
        jvec_ij[8] += Rt[59] * rho_kl_val;
        jvec_kl_val += Rt[61] * rho_ij[9];
        jvec_ij[9] += Rt[61] * rho_kl_val;
        jvec_kl_val += Rt[64] * rho_ij[10];
        jvec_ij[10] += Rt[64] * rho_kl_val;
        jvec_kl_val += Rt[65] * rho_ij[11];
        jvec_ij[11] += Rt[65] * rho_kl_val;
        jvec_kl_val += Rt[66] * rho_ij[12];
        jvec_ij[12] += Rt[66] * rho_kl_val;
        jvec_kl_val += Rt[68] * rho_ij[13];
        jvec_ij[13] += Rt[68] * rho_kl_val;
        jvec_kl_val += Rt[69] * rho_ij[14];
        jvec_ij[14] += Rt[69] * rho_kl_val;
        jvec_kl_val += Rt[71] * rho_ij[15];
        jvec_ij[15] += Rt[71] * rho_kl_val;
        jvec_kl_val += Rt[74] * rho_ij[16];
        jvec_ij[16] += Rt[74] * rho_kl_val;
        jvec_kl_val += Rt[75] * rho_ij[17];
        jvec_ij[17] += Rt[75] * rho_kl_val;
        jvec_kl_val += Rt[77] * rho_ij[18];
        jvec_ij[18] += Rt[77] * rho_kl_val;
        jvec_kl_val += Rt[80] * rho_ij[19];
        jvec_ij[19] += Rt[80] * rho_kl_val;
        jvec_kl[16] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[17];
        jvec_kl_val -= Rt[50] * rho_ij[0];
        jvec_ij[0] -= Rt[50] * rho_kl_val;
        jvec_kl_val -= Rt[51] * rho_ij[1];
        jvec_ij[1] -= Rt[51] * rho_kl_val;
        jvec_kl_val -= Rt[52] * rho_ij[2];
        jvec_ij[2] -= Rt[52] * rho_kl_val;
        jvec_kl_val -= Rt[53] * rho_ij[3];
        jvec_ij[3] -= Rt[53] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[4];
        jvec_ij[4] -= Rt[55] * rho_kl_val;
        jvec_kl_val -= Rt[56] * rho_ij[5];
        jvec_ij[5] -= Rt[56] * rho_kl_val;
        jvec_kl_val -= Rt[57] * rho_ij[6];
        jvec_ij[6] -= Rt[57] * rho_kl_val;
        jvec_kl_val -= Rt[59] * rho_ij[7];
        jvec_ij[7] -= Rt[59] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[8];
        jvec_ij[8] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[62] * rho_ij[9];
        jvec_ij[9] -= Rt[62] * rho_kl_val;
        jvec_kl_val -= Rt[65] * rho_ij[10];
        jvec_ij[10] -= Rt[65] * rho_kl_val;
        jvec_kl_val -= Rt[66] * rho_ij[11];
        jvec_ij[11] -= Rt[66] * rho_kl_val;
        jvec_kl_val -= Rt[67] * rho_ij[12];
        jvec_ij[12] -= Rt[67] * rho_kl_val;
        jvec_kl_val -= Rt[69] * rho_ij[13];
        jvec_ij[13] -= Rt[69] * rho_kl_val;
        jvec_kl_val -= Rt[70] * rho_ij[14];
        jvec_ij[14] -= Rt[70] * rho_kl_val;
        jvec_kl_val -= Rt[72] * rho_ij[15];
        jvec_ij[15] -= Rt[72] * rho_kl_val;
        jvec_kl_val -= Rt[75] * rho_ij[16];
        jvec_ij[16] -= Rt[75] * rho_kl_val;
        jvec_kl_val -= Rt[76] * rho_ij[17];
        jvec_ij[17] -= Rt[76] * rho_kl_val;
        jvec_kl_val -= Rt[78] * rho_ij[18];
        jvec_ij[18] -= Rt[78] * rho_kl_val;
        jvec_kl_val -= Rt[81] * rho_ij[19];
        jvec_ij[19] -= Rt[81] * rho_kl_val;
        jvec_kl[17] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[18];
        jvec_kl_val -= Rt[54] * rho_ij[0];
        jvec_ij[0] -= Rt[54] * rho_kl_val;
        jvec_kl_val -= Rt[55] * rho_ij[1];
        jvec_ij[1] -= Rt[55] * rho_kl_val;
        jvec_kl_val -= Rt[56] * rho_ij[2];
        jvec_ij[2] -= Rt[56] * rho_kl_val;
        jvec_kl_val -= Rt[57] * rho_ij[3];
        jvec_ij[3] -= Rt[57] * rho_kl_val;
        jvec_kl_val -= Rt[58] * rho_ij[4];
        jvec_ij[4] -= Rt[58] * rho_kl_val;
        jvec_kl_val -= Rt[59] * rho_ij[5];
        jvec_ij[5] -= Rt[59] * rho_kl_val;
        jvec_kl_val -= Rt[60] * rho_ij[6];
        jvec_ij[6] -= Rt[60] * rho_kl_val;
        jvec_kl_val -= Rt[61] * rho_ij[7];
        jvec_ij[7] -= Rt[61] * rho_kl_val;
        jvec_kl_val -= Rt[62] * rho_ij[8];
        jvec_ij[8] -= Rt[62] * rho_kl_val;
        jvec_kl_val -= Rt[63] * rho_ij[9];
        jvec_ij[9] -= Rt[63] * rho_kl_val;
        jvec_kl_val -= Rt[68] * rho_ij[10];
        jvec_ij[10] -= Rt[68] * rho_kl_val;
        jvec_kl_val -= Rt[69] * rho_ij[11];
        jvec_ij[11] -= Rt[69] * rho_kl_val;
        jvec_kl_val -= Rt[70] * rho_ij[12];
        jvec_ij[12] -= Rt[70] * rho_kl_val;
        jvec_kl_val -= Rt[71] * rho_ij[13];
        jvec_ij[13] -= Rt[71] * rho_kl_val;
        jvec_kl_val -= Rt[72] * rho_ij[14];
        jvec_ij[14] -= Rt[72] * rho_kl_val;
        jvec_kl_val -= Rt[73] * rho_ij[15];
        jvec_ij[15] -= Rt[73] * rho_kl_val;
        jvec_kl_val -= Rt[77] * rho_ij[16];
        jvec_ij[16] -= Rt[77] * rho_kl_val;
        jvec_kl_val -= Rt[78] * rho_ij[17];
        jvec_ij[17] -= Rt[78] * rho_kl_val;
        jvec_kl_val -= Rt[79] * rho_ij[18];
        jvec_ij[18] -= Rt[79] * rho_kl_val;
        jvec_kl_val -= Rt[82] * rho_ij[19];
        jvec_ij[19] -= Rt[82] * rho_kl_val;
        jvec_kl[18] += jvec_kl_val;
        jvec_kl_val = 0;
        rho_kl_val = rho_kl[19];
        jvec_kl_val -= Rt[64] * rho_ij[0];
        jvec_ij[0] -= Rt[64] * rho_kl_val;
        jvec_kl_val -= Rt[65] * rho_ij[1];
        jvec_ij[1] -= Rt[65] * rho_kl_val;
        jvec_kl_val -= Rt[66] * rho_ij[2];
        jvec_ij[2] -= Rt[66] * rho_kl_val;
        jvec_kl_val -= Rt[67] * rho_ij[3];
        jvec_ij[3] -= Rt[67] * rho_kl_val;
        jvec_kl_val -= Rt[68] * rho_ij[4];
        jvec_ij[4] -= Rt[68] * rho_kl_val;
        jvec_kl_val -= Rt[69] * rho_ij[5];
        jvec_ij[5] -= Rt[69] * rho_kl_val;
        jvec_kl_val -= Rt[70] * rho_ij[6];
        jvec_ij[6] -= Rt[70] * rho_kl_val;
        jvec_kl_val -= Rt[71] * rho_ij[7];
        jvec_ij[7] -= Rt[71] * rho_kl_val;
        jvec_kl_val -= Rt[72] * rho_ij[8];
        jvec_ij[8] -= Rt[72] * rho_kl_val;
        jvec_kl_val -= Rt[73] * rho_ij[9];
        jvec_ij[9] -= Rt[73] * rho_kl_val;
        jvec_kl_val -= Rt[74] * rho_ij[10];
        jvec_ij[10] -= Rt[74] * rho_kl_val;
        jvec_kl_val -= Rt[75] * rho_ij[11];
        jvec_ij[11] -= Rt[75] * rho_kl_val;
        jvec_kl_val -= Rt[76] * rho_ij[12];
        jvec_ij[12] -= Rt[76] * rho_kl_val;
        jvec_kl_val -= Rt[77] * rho_ij[13];
        jvec_ij[13] -= Rt[77] * rho_kl_val;
        jvec_kl_val -= Rt[78] * rho_ij[14];
        jvec_ij[14] -= Rt[78] * rho_kl_val;
        jvec_kl_val -= Rt[79] * rho_ij[15];
        jvec_ij[15] -= Rt[79] * rho_kl_val;
        jvec_kl_val -= Rt[80] * rho_ij[16];
        jvec_ij[16] -= Rt[80] * rho_kl_val;
        jvec_kl_val -= Rt[81] * rho_ij[17];
        jvec_ij[17] -= Rt[81] * rho_kl_val;
        jvec_kl_val -= Rt[82] * rho_ij[18];
        jvec_ij[18] -= Rt[82] * rho_kl_val;
        jvec_kl_val -= Rt[83] * rho_ij[19];
        jvec_ij[19] -= Rt[83] * rho_kl_val;
        jvec_kl[19] += jvec_kl_val;
}

static int _jvec_wo_Rt(double *Rt2, int l1, int l2, int len2,
                       double a, double fac, double *rpq, double *buf,
                       double *rho_ij, double *rho_kl, double *jvec_ij, double *jvec_kl)
{
        int l = l1 + l2;
        int info = get_R_tensor(Rt2, l, a, fac, rpq, buf);
        switch (l1*LMAX*2+l2) {
        case (0*LMAX*2+0): Rt2jvec_0_0(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (0*LMAX*2+1): Rt2jvec_0_1(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (0*LMAX*2+2): Rt2jvec_0_2(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (0*LMAX*2+3): Rt2jvec_0_3(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (1*LMAX*2+0): Rt2jvec_1_0(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (1*LMAX*2+1): Rt2jvec_1_1(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (1*LMAX*2+2): Rt2jvec_1_2(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (1*LMAX*2+3): Rt2jvec_1_3(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (2*LMAX*2+0): Rt2jvec_2_0(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (2*LMAX*2+1): Rt2jvec_2_1(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (2*LMAX*2+2): Rt2jvec_2_2(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (2*LMAX*2+3): Rt2jvec_2_3(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (3*LMAX*2+0): Rt2jvec_3_0(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (3*LMAX*2+1): Rt2jvec_3_1(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (3*LMAX*2+2): Rt2jvec_3_2(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        case (3*LMAX*2+3): Rt2jvec_3_3(Rt2, rho_ij, rho_kl, jvec_ij, jvec_kl); return info;
        }

        if (l1 == 0) {
                double rho_kl_val = rho_kl[0];
                double jvec_kl_val = 0.;
                for (int i = 0; i < len2; i++) {
                        jvec_kl_val += Rt2[i] * rho_ij[i];
                        jvec_ij[i]  += Rt2[i] * rho_kl_val;
                }
                jvec_kl[0] += jvec_kl_val;
                return info;
        }

        int e, f, g, t, u, v, n, i, k;
        double s;
        if (l2 == 0) {
                for (n = 0, e = 0; e <= l1; e++) {
                for (f = 0; f <= l1-e; f++) {
                for (g = 0; g <= l1-e-f; g++, n++) {
                        if ((e + f + g) % 2 == 0) {
                                jvec_kl[n] += Rt2[n] * rho_ij[0];
                                jvec_ij[0] += Rt2[n] * rho_kl[n];
                        } else {
                                jvec_kl[n] -= Rt2[n] * rho_ij[0];
                                jvec_ij[0] -= Rt2[n] * rho_kl[n];
                        }
                } } }
                return info;
        }

        int stride_l = (l+1);
        int stride_ll = stride_l * (l+1);
        double *Rsub;
        for (n = 0, t = 0; t <= l; t++) {
                Rsub = buf + t*stride_ll;
                for (u = 0; u <= l-t; u++) {
#pragma GCC ivdep
                for (v = 0; v <= l-t-u; v++, n++) {
                        Rsub[u*stride_l+v] = Rt2[n];
                } }
        }

        for (k = 0, e = 0; e <= l1; e++) {
        for (f = 0; f <= l1-e; f++) {
        for (g = 0; g <= l1-e-f; g++, k++) {
                double rho_kl_val = rho_kl[k];
                double jvec_kl_val = 0.;
                if ((e + f + g) % 2 == 0) {
                        for (i = 0, t = 0; t <= l2; t++) {
                                Rsub = buf + (e+t)*stride_ll + f*stride_l + g;
                                for (u = 0; u <= l2-t; u++) {
#pragma GCC ivdep
                                for (v = 0; v <= l2-t-u; v++, i++) {
                                        s = Rsub[u*stride_l+v];
                                        jvec_kl_val += s * rho_ij[i];
                                        jvec_ij[i]  += s * rho_kl_val;
                                } }
                        }
                } else {
                        for (i = 0, t = 0; t <= l2; t++) {
                                Rsub = buf + (e+t)*stride_ll + f*stride_l + g;
                                for (u = 0; u <= l2-t; u++) {
#pragma GCC ivdep
                                for (v = 0; v <= l2-t-u; v++, i++) {
                                        s = Rsub[u*stride_l+v];
                                        jvec_kl_val -= s * rho_ij[i];
                                        jvec_ij[i]  -= s * rho_kl_val;
                                } }
                        }
                }
                jvec_kl[k] += jvec_kl_val;
        } } }
        return info;
}

void MD_jk_kernel(MDIntEnvVars *envs, JKMatrix *jk,
                  int ish, int jsh, int ksh, int lsh, double *buf)
{
        int nbas = envs->nbas;
        int *bas = envs->bas;
        int *ao_loc = envs->ao_loc;
        int *jengine_loc = envs->jengine_loc;
        double *env = envs->env;
        double *Et_ij_cache = envs->Et_ij_cache;
        double *Et_kl_cache = envs->Et_kl_cache;
        int *Et_offsets = envs->Et_offsets;
        double *vj = jk->vj;
        double *vk = jk->vk;
        double *Et_dm = jk->Et_dm;
        char N = 'N';
        char T = 'T';
        double D0 = 0.;
        double D1 = 1.;
        int li = bas[ish*BAS_SLOTS+ANG_OF];
        int lj = bas[jsh*BAS_SLOTS+ANG_OF];
        int lk = bas[ksh*BAS_SLOTS+ANG_OF];
        int ll = bas[lsh*BAS_SLOTS+ANG_OF];
        int iprim = bas[ish*BAS_SLOTS+NPRIM_OF];
        int jprim = bas[jsh*BAS_SLOTS+NPRIM_OF];
        int kprim = bas[ksh*BAS_SLOTS+NPRIM_OF];
        int lprim = bas[lsh*BAS_SLOTS+NPRIM_OF];
        int lij = li + lj;
        int lkl = lk + ll;
        int l4 = lij + lkl;
        int di = ao_loc[ish+1] - ao_loc[ish];
        int dj = ao_loc[jsh+1] - ao_loc[jsh];
        int dk = ao_loc[ksh+1] - ao_loc[ksh];
        int dl = ao_loc[lsh+1] - ao_loc[lsh];
        int didj = di * dj;
        int dkdl = dk * dl;
        int Et_ij_len = (lij + 1) * (lij + 2) * (lij + 3) / 6;
        int Et_kl_len = (lkl + 1) * (lkl + 2) * (lkl + 3) / 6;
        int Et_kl_lenp = Et_kl_len * kprim * lprim;
        double *Rt2 = buf + Et_ij_len*Et_kl_len + (l4+1)*(l4+1)*(l4+1);
        double *eri = Rt2 + Et_ij_len * Et_kl_lenp;
        double *RdotE = eri + didj * dkdl;
        double Rpq[3];

        int bas_ij = ish * nbas + jsh;
        int bas_kl = ksh * nbas + lsh;
        // FIXME: the non-symmetric density matrices
        double fac_sym = 1.;
        if (ish == jsh) fac_sym *= .5;
        if (ksh == lsh) fac_sym *= .5;
        if (bas_ij == bas_kl) fac_sym *= .5;

        double *Et_ij = Et_ij_cache + Et_offsets[bas_ij];
        double *Et_kl = Et_kl_cache + Et_offsets[bas_kl];
        double *expi = env + bas[ish*BAS_SLOTS+PTR_EXP];
        double *expj = env + bas[jsh*BAS_SLOTS+PTR_EXP];
        double *expk = env + bas[ksh*BAS_SLOTS+PTR_EXP];
        double *expl = env + bas[lsh*BAS_SLOTS+PTR_EXP];
        double *ri = env + bas[ish*BAS_SLOTS+PTR_BAS_COORD];
        double *rj = env + bas[jsh*BAS_SLOTS+PTR_BAS_COORD];
        double *rk = env + bas[ksh*BAS_SLOTS+PTR_BAS_COORD];
        double *rl = env + bas[lsh*BAS_SLOTS+PTR_BAS_COORD];
        double xixj = ri[0] - rj[0];
        double yiyj = ri[1] - rj[1];
        double zizj = ri[2] - rj[2];
        double xkxl = rk[0] - rl[0];
        double ykyl = rk[1] - rl[1];
        double zkzl = rk[2] - rl[2];
        double *rho_ij = Et_dm + jengine_loc[bas_ij];
        double *rho_kl = Et_dm + jengine_loc[bas_kl];
        double *jvec_ij = vj + jengine_loc[bas_ij];
        double *jvec_kl = vj + jengine_loc[bas_kl];

        for (int ij = 0, ip = 0; ip < iprim; ip++) {
        for (int jp = 0; jp < jprim; jp++, ij++) {
                double ai = expi[ip];
                double aj = expj[jp];
                double aij = ai + aj;
                double aj_aij = aj / aij;
                double xij = ri[0] - xixj * aj_aij;
                double yij = ri[1] - yiyj * aj_aij;
                double zij = ri[2] - zizj * aj_aij;
                double *pRt2 = Rt2;
                double *rhop_ij = rho_ij + ij * Et_ij_len;
                double *jvecp_ij = jvec_ij + ij * Et_ij_len;
                for (int kl = 0, kp = 0; kp < kprim; kp++) {
                for (int lp = 0; lp < lprim; lp++, kl++) {
                        double ak = expk[kp];
                        double al = expl[lp];
                        double akl = ak + al;
                        double al_akl = al / akl;
                        double xkl = rk[0] - xkxl * al_akl;
                        double ykl = rk[1] - ykyl * al_akl;
                        double zkl = rk[2] - zkzl * al_akl;
                        double theta = aij * akl / (aij + akl);
                        double fac = PI_FAC/(aij*akl*sqrt(aij+akl)) * fac_sym;
                        Rpq[0] = xij - xkl;
                        Rpq[1] = yij - ykl;
                        Rpq[2] = zij - zkl;

                        if (vk == NULL) {
                                _jvec_wo_Rt(Rt2, lkl, lij, Et_ij_len, theta, fac, Rpq, buf,
                                            rhop_ij, rho_kl+kl*Et_kl_len,
                                            jvecp_ij, jvec_kl+kl*Et_kl_len);
                        } else {
                                get_Rt2(pRt2, lkl, lij, theta, fac, Rpq, buf);
                                pRt2 += Et_ij_len * Et_kl_len;
                        }
                } }

                if (vk == NULL) continue;
                // RdotE = Rt2.T.dot(Et_kl)
                dgemm_(&N, &T, &dkdl, &Et_ij_len, &Et_kl_lenp, &D1, Et_kl, &dkdl,
                       Rt2, &Et_ij_len, &D0, RdotE, &dkdl);
                // Et_kl.T.dot(RdotE)
                if (ij == 0) {
                        dgemm_(&N, &T, &dkdl, &didj, &Et_ij_len, &D1, RdotE, &dkdl,
                               Et_ij+ij*didj*Et_ij_len, &didj, &D0, eri, &dkdl);
                } else {
                        dgemm_(&N, &T, &dkdl, &didj, &Et_ij_len, &D1, RdotE, &dkdl,
                               Et_ij+ij*didj*Et_ij_len, &didj, &D1, eri, &dkdl);
                }
        } }
        if (vk != NULL) {
                _contract_jk_s4(jk, eri, ish, jsh, ksh, lsh, ao_loc);
        }
}
